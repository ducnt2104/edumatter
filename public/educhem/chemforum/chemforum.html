<script src="/socket.io/socket.io.js"></script>

<ul id="messages"></ul>
<form id="chatForm">
  <input id="m" autocomplete="off" /><button>Gửi</button>
</form>
<input type="file" id="fileInput" />

<script>
  const socket = io();

  // Gửi tin nhắn
  document.querySelector("form").addEventListener("submit", function (e) {
    e.preventDefault();
    socket.emit("chat message", document.getElementById("m").value);
    document.getElementById("m").value = "";
  });

  // Nhận tin nhắn từ server
  socket.on("chat message", function (msg) {
    const li = document.createElement("li");
    li.textContent = msg;
    document.getElementById("messages").appendChild(li);
  });

  // Xử lý gửi file (gọi API upload)
  document.getElementById("fileInput").addEventListener("change", async (e) => {
    const formData = new FormData();
    formData.append("file", e.target.files[0]);
    await fetch("/api/chemforum/upload", { method: "POST", body: formData });
    alert("Đã gửi file lên server!");
  });
</script>
