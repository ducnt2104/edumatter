<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H·ªçc T·ªët H√≥a H·ªçc 10 - C·∫•u T·∫°o Nguy√™n T·ª≠ To√†n T·∫≠p</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Inter:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <style>
      :root {
        --primary: #4361ee;
        --secondary: #3f37c9;
        --accent: #f72585;
        --bg: #f8f9fa;
        --text: #2b2d42;
        --card-bg: #ffffff;
        --success: #4cc9f0;
        --metal: #ffcdb2;
        --nonmetal: #b5e48c;
        --gas: #caf0f8;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", "Poppins", sans-serif;
        background-color: var(--bg);
        color: var(--text);
        margin: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      /* Header */
      header {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 2rem;
        text-align: center;
        border-radius: 0 0 30px 30px;
        box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
      }
      header h1 {
        margin: 0;
        font-size: 2rem;
      }
      header p {
        opacity: 0.9;
        margin-top: 5px;
      }

      /* Nav */
      .nav-container {
        display: flex;
        justify-content: center;
        margin-top: -25px;
        gap: 10px;
        flex-wrap: wrap;
        padding: 0 10px;
      }
      .nav-btn {
        background: white;
        border: none;
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: 600;
        color: var(--text);
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        transition: 0.3s;
      }
      .nav-btn.active {
        background: var(--accent);
        color: white;
        transform: translateY(-3px);
      }
      .nav-btn:hover:not(.active) {
        transform: translateY(-2px);
      }

      /* Main */
      main {
        max-width: 1000px;
        margin: 30px auto;
        padding: 0 20px;
        flex: 1;
        width: 100%;
      }
      .tab-content {
        display: none;
        animation: fadeIn 0.5s ease;
      }
      .tab-content.active {
        display: block;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Cards */
      .card {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        border-left: 5px solid var(--primary);
      }
      .card h2 {
        color: var(--secondary);
        margin-top: 0;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
      }
      .card h3 {
        color: var(--accent);
        margin-top: 20px;
      }

      /* Theory Styles */
      .theory-text p {
        line-height: 1.6;
        margin-bottom: 10px;
      }
      .highlight-box {
        background: #eef;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid var(--accent);
        margin: 10px 0;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        font-size: 0.9rem;
      }
      .data-table th,
      .data-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
      }
      .data-table th {
        background: #f1f3f5;
        color: var(--primary);
      }

      /* Interactive Widgets */
      .interactive-tool {
        background: #fff;
        border: 2px dashed var(--primary);
        padding: 20px;
        border-radius: 12px;
        margin: 15px 0;
        transition: 0.3s;
      }
      .interactive-tool:hover {
        border-color: var(--accent);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }
      .interactive-tool h4 {
        margin-top: 0;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .tool-controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 10px;
      }
      .tool-controls input {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 6px;
        flex: 1;
        min-width: 120px;
      }
      .tool-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 6px;
        cursor: pointer;
      }
      .tool-btn:hover {
        background: var(--secondary);
      }

      .tool-result {
        background: #e3f2fd;
        padding: 10px;
        border-radius: 6px;
        color: var(--text);
        font-weight: bold;
        display: none;
        margin-top: 10px;
      }

      /* Details/Summary */
      details {
        margin-bottom: 10px;
        border: 1px solid #eee;
        border-radius: 8px;
        overflow: hidden;
      }
      summary {
        background: #f8f9fa;
        padding: 15px;
        cursor: pointer;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
        list-style: none;
      }
      summary:hover {
        background: #f1f3f5;
      }
      summary::after {
        content: "+";
        font-size: 1.2rem;
        color: var(--primary);
      }
      details[open] summary::after {
        content: "-";
      }
      .details-body {
        padding: 15px;
        background: white;
      }

      /* Periodic Table Mini */
      .periodic-grid {
        display: grid;
        grid-template-columns: repeat(8, 1fr);
        gap: 4px;
      }
      .element {
        aspect-ratio: 1;
        border: 1px solid #eee;
        border-radius: 4px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        cursor: pointer;
        background: white;
      }
      .element:hover {
        transform: scale(1.1);
        z-index: 2;
        border-color: var(--accent);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }
      .type-metal {
        background: var(--metal);
      }
      .type-nonmetal {
        background: var(--nonmetal);
      }
      .type-gas {
        background: var(--gas);
      }

      /* 3D Container */
      #atom-container {
        width: 100%;
        height: 400px;
        background: #0d1b2a;
        border-radius: 12px;
        margin-top: 15px;
        position: relative;
      }

      /* Quiz */
      .quiz-item {
        margin-bottom: 20px;
        border-bottom: 1px solid #eee;
        padding-bottom: 15px;
      }
      .quiz-options label {
        display: block;
        padding: 8px;
        margin: 5px 0;
        border: 1px solid #eee;
        border-radius: 5px;
        cursor: pointer;
      }
      .quiz-options label:hover {
        background: #f8f9fa;
      }
      .quiz-options label.correct {
        background: #d4edda;
        border-color: #c3e6cb;
      }
      .quiz-options label.wrong {
        background: #f8d7da;
        border-color: #f5c6cb;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>C·∫•u T·∫°o Nguy√™n T·ª≠ To√†n T·∫≠p</h1>
      <p>Ch·ªß ƒë·ªÅ 1 - H√≥a H·ªçc 10 (Phi√™n b·∫£n ƒë·∫ßy ƒë·ªß & T∆∞∆°ng t√°c)</p>
    </header>

    <div class="nav-container">
      <button class="nav-btn active" onclick="switchTab('lythuyet')">
        üìñ L√Ω Thuy·∫øt & T∆∞∆°ng T√°c
      </button>
      <button class="nav-btn" onclick="switchTab('mo_phong_3d')">
        ‚ú® M√¥ Ph·ªèng 3D
      </button>
      <button class="nav-btn" onclick="switchTab('bangtuanhoan')">
        üß™ B·∫£ng Tra C·ª©u
      </button>
      <button class="nav-btn" onclick="switchTab('tracnghiem')">
        üìù Tr·∫Øc Nghi·ªám
      </button>
    </div>

    <main>
      <!-- TAB 1: L√ù THUY·∫æT CHI TI·∫æT -->
      <div id="lythuyet" class="tab-content active">
        <!-- I. TH√ÄNH PH·∫¶N NGUY√äN T·ª¨ -->
        <div class="card">
          <h2>I. TH√ÄNH PH·∫¶N C·ª¶A NGUY√äN T·ª¨</h2>

          <details open>
            <summary>1. Th√†nh ph·∫ßn c·∫•u t·∫°o nguy√™n t·ª≠</summary>
            <div class="details-body theory-text">
              <p>Nguy√™n t·ª≠ g·ªìm 2 ph·∫ßn ch√≠nh:</p>
              <ul>
                <li>
                  <strong>H·∫°t nh√¢n:</strong> Mang ƒëi·ªán d∆∞∆°ng, n·∫±m ·ªü t√¢m, g·ªìm
                  <strong>proton (p)</strong> v√† <strong>neutron (n)</strong>.
                </li>
                <li>
                  <strong>V·ªè electron (e):</strong> C√°c electron mang ƒëi·ªán √¢m
                  chuy·ªÉn ƒë·ªông xung quanh h·∫°t nh√¢n.
                </li>
              </ul>
              <div class="highlight-box" style="text-align: center">
                <strong>T·ªïng th·ªÉ trung h√≤a ƒëi·ªán: S·ªë p = S·ªë e</strong>
              </div>
            </div>
          </details>

          <details>
            <summary>2. Electron (e)</summary>
            <div class="details-body theory-text">
              <ul>
                <li>
                  <strong>ƒêi·ªán t√≠ch:</strong> √Çm. $q_e = -1.6 \times 10^{-19}
                  C$. Quy ∆∞·ªõc l√† <strong>-1</strong>.
                </li>
                <li>
                  <strong>Kh·ªëi l∆∞·ª£ng:</strong> C·ª±c nh·ªè. $m_e \approx 1/1836 m_p
                  \approx 9.11 \times 10^{-28}g$.
                </li>
                <li>
                  <em>(G·∫ßn nh∆∞ b·ªè qua khi t√≠nh kh·ªëi l∆∞·ª£ng nguy√™n t·ª≠).</em>
                </li>
                <li>
                  <strong>Chuy·ªÉn ƒë·ªông:</strong> R·∫•t nhanh trong v√πng kh√¥ng gian
                  g·ªçi l√† orbital.
                </li>
              </ul>
              <div class="highlight-box">
                üí° ƒêi·ªÉm c·ªët l√µi: Electron quy·∫øt ƒë·ªãnh t√≠nh ch·∫•t h√≥a h·ªçc c·ªßa
                nguy√™n t·ª≠.
              </div>
            </div>
          </details>

          <details>
            <summary>3. H·∫°t nh√¢n & 4. C·∫•u t·∫°o h·∫°t nh√¢n</summary>
            <div class="details-body theory-text">
              <p>
                Mang ƒëi·ªán d∆∞∆°ng $\rightarrow$ quy·∫øt ƒë·ªãnh danh t√≠nh nguy√™n t·ªë.
              </p>
              <ul>
                <li>
                  <strong>ƒêi·ªán t√≠ch h·∫°t nh√¢n:</strong> $Z+$. (Z l√† s·ªë proton).
                </li>
                <li>
                  <strong>Th√†nh ph·∫ßn:</strong> Proton (+1) v√† Neutron (kh√¥ng
                  mang ƒëi·ªán).
                </li>
                <li>
                  H·∫°t nh√¢n n·∫∑ng v√† chi·∫øm g·∫ßn to√†n b·ªô kh·ªëi l∆∞·ª£ng nguy√™n t·ª≠.
                </li>
              </ul>

              <!-- INTERACTIVE TOOL: T√çNH S·ªê KH·ªêI -->
              <div class="interactive-tool">
                <h4>üßÆ T∆∞∆°ng t√°c: T√≠nh S·ªë Kh·ªëi (A)</h4>
                <p>C√¥ng th·ª©c: $A = Z + N$</p>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="calc-z"
                    placeholder="Nh·∫≠p s·ªë Proton (Z)"
                  />
                  <input
                    type="number"
                    id="calc-n"
                    placeholder="Nh·∫≠p s·ªë Neutron (N)"
                  />
                  <button class="tool-btn" onclick="calcMassNumber()">
                    T√≠nh A
                  </button>
                </div>
                <div id="res-mass-num" class="tool-result"></div>
              </div>
            </div>
          </details>

          <details>
            <summary>5. K√≠ch th∆∞·ªõc v√† kh·ªëi l∆∞·ª£ng</summary>
            <div class="details-body">
              <ul>
                <li>ƒê∆∞·ªùng k√≠nh nguy√™n t·ª≠ $\approx 10^{-10}m$.</li>
                <li>ƒê∆∞·ªùng k√≠nh h·∫°t nh√¢n $\approx 10^{-15}m$.</li>
                <li>
                  $\Rightarrow$
                  <strong>Nguy√™n t·ª≠ r·ªóng g·∫ßn nh∆∞ ho√†n to√†n.</strong>
                </li>
              </ul>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>H·∫°t</th>
                    <th>ƒêi·ªán t√≠ch</th>
                    <th>Kh·ªëi l∆∞·ª£ng (amu)</th>
                    <th>Kh·ªëi l∆∞·ª£ng (g)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>p</td>
                    <td>+1</td>
                    <td>1</td>
                    <td>$1.673 \times 10^{-24}$</td>
                  </tr>
                  <tr>
                    <td>n</td>
                    <td>0</td>
                    <td>1</td>
                    <td>$1.675 \times 10^{-24}$</td>
                  </tr>
                  <tr>
                    <td>e</td>
                    <td>-1</td>
                    <td>$\approx 0$ (1/1840)</td>
                    <td>$9.11 \times 10^{-28}$</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </details>
        </div>

        <!-- II. NGUY√äN T·ªê H√ìA H·ªåC -->
        <div class="card">
          <h2>II. NGUY√äN T·ªê H√ìA H·ªåC</h2>

          <details>
            <summary>1, 2. Kh√°i ni·ªám Nguy√™n t·ªë</summary>
            <div class="details-body theory-text">
              <p>
                <strong>H·∫°t nh√¢n quy·∫øt ƒë·ªãnh:</strong> S·ªë hi·ªáu nguy√™n t·ª≠ (Z), T√™n
                v√† t√≠nh ch·∫•t h√≥a h·ªçc.
              </p>
              <div class="highlight-box">
                <strong>ƒê·ªãnh nghƒ©a:</strong> Nguy√™n t·ªë h√≥a h·ªçc l√† t·∫≠p h·ª£p c√°c
                nguy√™n t·ª≠ c√≥ <strong>c√πng s·ªë proton (Z)</strong>.<br />
                <em
                  >(D√π s·ªë neutron thay ƒë·ªïi $\rightarrow$ v·∫´n l√† 1 nguy√™n
                  t·ªë).</em
                >
              </div>
            </div>
          </details>

          <details>
            <summary>3. ƒê·ªìng v·ªã</summary>
            <div class="details-body theory-text">
              <p>
                <strong>ƒê·ªìng v·ªã:</strong> C√°c nguy√™n t·ª≠ c√πng Z, kh√°c N
                $\rightarrow$ Kh√°c s·ªë kh·ªëi A.
              </p>
              <ul>
                <li>T√≠nh ch·∫•t h√≥a h·ªçc gi·ªëng nhau (do e gi·ªëng nhau).</li>
                <li>T√≠nh ch·∫•t v·∫≠t l√Ω kh√°c nhau (do kh·ªëi l∆∞·ª£ng kh√°c nhau).</li>
              </ul>
            </div>
          </details>

          <details open>
            <summary>4. Nguy√™n t·ª≠ kh·ªëi & Trung b√¨nh</summary>
            <div class="details-body theory-text">
              <p>
                <strong>Nguy√™n t·ª≠ kh·ªëi trung b√¨nh ($\bar{A}$):</strong> D√πng cho
                nguy√™n t·ªë c√≥ nhi·ªÅu ƒë·ªìng v·ªã.
              </p>
              <p>
                $\bar{A} = \frac{aA_1 + bA_2 + \dots}{100}$ (a, b l√† % s·ªë nguy√™n
                t·ª≠)
              </p>

              <!-- INTERACTIVE TOOL: M√ÅY T√çNH NGUY√äN T·ª¨ KH·ªêI -->
              <div class="interactive-tool">
                <h4>üßÆ M√°y t√≠nh Nguy√™n t·ª≠ kh·ªëi TB</h4>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="iso1-m"
                    placeholder="S·ªë kh·ªëi ƒêV 1 (VD: 35)"
                  />
                  <input
                    type="number"
                    id="iso1-p"
                    placeholder="% ƒêV 1 (VD: 75)"
                  />
                </div>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="iso2-m"
                    placeholder="S·ªë kh·ªëi ƒêV 2 (VD: 37)"
                  />
                  <input
                    type="number"
                    id="iso2-p"
                    placeholder="% ƒêV 2 (T·ª± ƒë·ªông)"
                    readonly
                  />
                </div>
                <button class="tool-btn" onclick="calcAvgMass()">
                  T√≠nh to√°n
                </button>
                <div id="res-avg-mass" class="tool-result"></div>
              </div>
            </div>
          </details>
        </div>

        <!-- III. C·∫§U TR√öC V·ªé NGUY√äN T·ª¨ -->
        <div class="card">
          <h2>III. C·∫§U TR√öC V·ªé NGUY√äN T·ª¨</h2>

          <details>
            <summary>1. Chuy·ªÉn ƒë·ªông electron</summary>
            <div class="details-body theory-text">
              <p>
                Electron kh√¥ng ch·∫°y theo qu·ªπ ƒë·∫°o tr√≤n (ki·ªÉu Bohr) m√† t·ªìn t·∫°i
                trong <strong>Orbital (AO)</strong> - v√πng x√°c su·∫•t t√¨m th·∫•y e
                cao nh·∫•t.
              </p>
              <p>Tu√¢n theo: C∆° h·ªçc l∆∞·ª£ng t·ª≠, Pauli, Hund, Aufbau.</p>
            </div>
          </details>

          <details>
            <summary>2. L·ªõp v√† Ph√¢n l·ªõp</summary>
            <div class="details-body theory-text">
              <p>V·ªè e chia th√†nh c√°c l·ªõp n = 1(K), 2(L), 3(M)...</p>
              <p>M·ªói l·ªõp c√≥ c√°c ph√¢n l·ªõp s, p, d, f.</p>
              <table class="data-table">
                <tr>
                  <th>Ph√¢n l·ªõp</th>
                  <th>s</th>
                  <th>p</th>
                  <th>d</th>
                  <th>f</th>
                </tr>
                <tr>
                  <th>S·ªë e t·ªëi ƒëa</th>
                  <td>2</td>
                  <td>6</td>
                  <td>10</td>
                  <td>14</td>
                </tr>
                <tr>
                  <th>H√¨nh d·∫°ng</th>
                  <td>C·∫ßu</td>
                  <td>S·ªë 8</td>
                  <td>C√°nh hoa</td>
                  <td>Ph·ª©c t·∫°p</td>
                </tr>
              </table>

              <!-- INTERACTIVE TOOL: S·ªê E T·ªêI ƒêA -->
              <div class="interactive-tool">
                <h4>üî¢ T√≠nh s·ªë e t·ªëi ƒëa c·ªßa l·ªõp n</h4>
                <p>C√¥ng th·ª©c: $2n^2$ (v·ªõi $n \le 4$)</p>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="shell-n"
                    placeholder="Nh·∫≠p l·ªõp n (1-4)"
                    max="4"
                    min="1"
                  />
                  <button class="tool-btn" onclick="calcMaxE()">
                    T√≠nh s·ªë e t·ªëi ƒëa
                  </button>
                </div>
                <div id="res-max-e" class="tool-result"></div>
              </div>
            </div>
          </details>

          <details open>
            <summary>3. C·∫•u h√¨nh Electron</summary>
            <div class="details-body theory-text">
              <p><strong>Nguy√™n t·∫Øc:</strong></p>
              <ol>
                <li>
                  M·ª©c nƒÉng l∆∞·ª£ng: 1s 2s 2p 3s 3p 4s 3d 4p... (S√°ng S·ªõm Pha S·ªØa
                  Pha S·ªØa ƒêi Pha...)
                </li>
                <li>Pauli: M·ªói AO t·ªëi ƒëa 2e.</li>
                <li>Hund: ƒêi·ªÅn e ƒë∆°n l·∫ª tr∆∞·ªõc.</li>
              </ol>
              <div class="highlight-box">
                M·∫πo: 4s ƒëi·ªÅn tr∆∞·ªõc 3d, nh∆∞ng khi m·∫•t e th√¨ m·∫•t 4s tr∆∞·ªõc.
              </div>

              <!-- INTERACTIVE TOOL: VI·∫æT C·∫§U H√åNH -->
              <div class="interactive-tool">
                <h4>‚ö° T∆∞∆°ng t√°c: Vi·∫øt C·∫•u h√¨nh Electron</h4>
                <p>Nh·∫≠p Z (1-20) ƒë·ªÉ xem c·∫•u h√¨nh v√† t√≠nh ch·∫•t:</p>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="config-z"
                    placeholder="Nh·∫≠p Z (VD: 11)"
                  />
                  <button class="tool-btn" onclick="genConfig()">
                    Ph√¢n t√≠ch
                  </button>
                </div>
                <div
                  id="res-config"
                  class="tool-result"
                  style="display: none"
                ></div>
              </div>
            </div>
          </details>

          <details>
            <summary>4. ƒê·∫∑c ƒëi·ªÉm l·ªõp ngo√†i c√πng</summary>
            <div class="details-body theory-text">
              <ul>
                <li><strong>1-3 e:</strong> Kim lo·∫°i.</li>
                <li><strong>5-7 e:</strong> Phi kim.</li>
                <li><strong>8 e:</strong> Kh√≠ hi·∫øm (He c√≥ 2e).</li>
                <li><strong>4 e:</strong> Kim lo·∫°i ho·∫∑c Phi kim.</li>
              </ul>

              <!-- INTERACTIVE TOOL: D·ª∞ ƒêO√ÅN T√çNH CH·∫§T -->
              <div class="interactive-tool">
                <h4>üîç D·ª± ƒëo√°n t√≠nh ch·∫•t</h4>
                <div class="tool-controls">
                  <input
                    type="number"
                    id="val-e"
                    placeholder="S·ªë e l·ªõp ngo√†i c√πng"
                    max="8"
                  />
                  <button class="tool-btn" onclick="predictProp()">
                    D·ª± ƒëo√°n
                  </button>
                </div>
                <div id="res-prop" class="tool-result"></div>
              </div>
            </div>
          </details>
        </div>
      </div>

      <!-- TAB 2: M√î PH·ªéNG 3D -->
      <div id="mo_phong_3d" class="tab-content">
        <div class="card" style="border-left-color: var(--secondary)">
          <h2>M√¥ H√¨nh Nguy√™n T·ª≠ 3D</h2>
          <p>
            Tr·ª±c quan h√≥a s·ª± chuy·ªÉn ƒë·ªông c·ªßa electron theo m√¥ h√¨nh h√†nh tinh
            (Bohr c·∫£i ti·∫øn).
          </p>
          <div style="margin-bottom: 10px">
            <label><strong>Ch·ªçn nguy√™n t·ªë:</strong> </label>
            <select
              id="atom-selector"
              onchange="update3DModel(this.value)"
              style="padding: 5px; border-radius: 4px"
            >
              <option value="1">Hydrogen (Z=1)</option>
              <option value="2">Helium (Z=2)</option>
              <option value="3">Lithium (Z=3)</option>
              <option value="6" selected>Carbon (Z=6)</option>
              <option value="8">Oxygen (Z=8)</option>
              <option value="11">Sodium (Z=11)</option>
              <option value="13">Aluminium (Z=13)</option>
              <option value="17">Chlorine (Z=17)</option>
              <option value="20">Calcium (Z=20)</option>
            </select>
          </div>
          <div id="atom-container"></div>
          <p
            style="
              text-align: center;
              font-size: 0.8rem;
              color: #666;
              margin-top: 5px;
            "
          >
            *Thao t√°c: Xoay (Chu·ªôt tr√°i), Di chuy·ªÉn (Chu·ªôt ph·∫£i), Zoom (LƒÉn
            chu·ªôt).
          </p>
        </div>
      </div>

      <!-- TAB 3: B·∫¢NG TU·∫¶N HO√ÄN -->
      <div id="bangtuanhoan" class="tab-content">
        <div class="card">
          <h2>B·∫£ng Tra C·ª©u Nhanh (20 nguy√™n t·ªë ƒë·∫ßu)</h2>
          <p>
            Click v√†o nguy√™n t·ªë ƒë·ªÉ xem nhanh th√¥ng tin Z, c·∫•u h√¨nh v√† t√≠nh ch·∫•t.
          </p>
          <div
            id="element-quick-info"
            class="tool-result"
            style="display: none; margin-bottom: 15px"
          ></div>
          <div class="periodic-grid" id="periodic-grid"></div>
          <div
            style="
              margin-top: 10px;
              display: flex;
              gap: 15px;
              font-size: 0.8rem;
            "
          >
            <span style="color: #d35400">‚ñ† Kim lo·∫°i</span>
            <span style="color: #27ae60">‚ñ† Phi kim</span>
            <span style="color: #2980b9">‚ñ† Kh√≠ hi·∫øm</span>
          </div>
        </div>
      </div>

      <!-- TAB 4: TR·∫ÆC NGHI·ªÜM -->
      <div id="tracnghiem" class="tab-content">
        <div class="card">
          <h2>Ki·ªÉm Tra Ki·∫øn Th·ª©c</h2>
          <div id="quiz-list"></div>
          <button
            class="tool-btn"
            onclick="checkQuiz()"
            style="margin-top: 20px"
          >
            N·ªôp b√†i & Ch·∫•m ƒëi·ªÉm
          </button>
          <div id="quiz-score" class="tool-result"></div>
        </div>
      </div>
    </main>

    <script>
      // === PH·∫¶N 1: LOGIC ƒêI·ªÄU H∆Ø·ªöNG TAB ===
      function switchTab(tabId) {
        document
          .querySelectorAll(".tab-content")
          .forEach((t) => t.classList.remove("active"));
        document
          .querySelectorAll(".nav-btn")
          .forEach((b) => b.classList.remove("active"));

        document.getElementById(tabId).classList.add("active");

        // Active button t∆∞∆°ng ·ª©ng
        const tabs = ["lythuyet", "mo_phong_3d", "bangtuanhoan", "tracnghiem"];
        const idx = tabs.indexOf(tabId);
        if (idx >= 0)
          document.querySelectorAll(".nav-btn")[idx].classList.add("active");

        // Fix resize cho 3D canvas khi hi·ªán tab
        if (tabId === "mo_phong_3d") setTimeout(onWindowResize, 100);
      }

      // === PH·∫¶N 2: C√ÅC C√îNG C·ª§ T∆Ø∆†NG T√ÅC L√ù THUY·∫æT ===

      // 1. T√≠nh s·ªë kh·ªëi
      function calcMassNumber() {
        const z = parseInt(document.getElementById("calc-z").value);
        const n = parseInt(document.getElementById("calc-n").value);
        const res = document.getElementById("res-mass-num");
        res.style.display = "block";
        if (!z || !n) res.innerHTML = "Vui l√≤ng nh·∫≠p ƒë·ªß Z v√† N.";
        else
          res.innerHTML = `S·ªë kh·ªëi A = ${z} (p) + ${n} (n) = <strong>${
            z + n
          }</strong>`;
      }

      // 2. T√≠nh nguy√™n t·ª≠ kh·ªëi trung b√¨nh
      function calcAvgMass() {
        const m1 = parseFloat(document.getElementById("iso1-m").value);
        const p1 = parseFloat(document.getElementById("iso1-p").value);
        const m2 = parseFloat(document.getElementById("iso2-m").value);

        if (!m1 || !p1 || !m2) {
          alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin.");
          return;
        }
        const p2 = 100 - p1;
        document.getElementById("iso2-p").value = p2;
        const avg = (m1 * p1 + m2 * p2) / 100;
        const res = document.getElementById("res-avg-mass");
        res.style.display = "block";
        res.innerHTML = `Nguy√™n t·ª≠ kh·ªëi trung b√¨nh = <strong>${avg.toFixed(
          4
        )}</strong>`;
      }

      // 3. T√≠nh s·ªë e t·ªëi ƒëa l·ªõp n
      function calcMaxE() {
        const n = parseInt(document.getElementById("shell-n").value);
        const res = document.getElementById("res-max-e");
        res.style.display = "block";
        if (!n || n < 1 || n > 4) res.innerHTML = "Vui l√≤ng nh·∫≠p n t·ª´ 1 ƒë·∫øn 4.";
        else
          res.innerHTML = `S·ªë e t·ªëi ƒëa l·ªõp n=${n} l√† $2n^2$ = 2√ó${n}¬≤ = <strong>${
            2 * n * n
          }</strong> electron.`;
        // Rerender MathJax
        if (window.MathJax) MathJax.typesetPromise();
      }

      // 4. Vi·∫øt c·∫•u h√¨nh e
      function genConfig() {
        const Z = parseInt(document.getElementById("config-z").value);
        const res = document.getElementById("res-config");
        res.style.display = "block";

        if (!Z || Z < 1 || Z > 20) {
          res.innerHTML = "C√¥ng c·ª• h·ªó tr·ª£ Z t·ª´ 1 ƒë·∫øn 20.";
          return;
        }

        let rem = Z,
          config = "",
          layers = [0, 0, 0, 0];
        // Quy t·∫Øc Aufbau s∆° b·ªô cho Z<=20: 1s 2s 2p 3s 3p 4s
        const caps = [2, 2, 6, 2, 6, 2];
        const names = ["1s", "2s", "2p", "3s", "3p", "4s"];

        for (let i = 0; i < caps.length; i++) {
          if (rem <= 0) break;
          let fill = Math.min(rem, caps[i]);
          config += `${names[i]}<sup>${fill}</sup> `;
          rem -= fill;
          // T√≠nh e l·ªõp ngo√†i c√πng
          if (i == 0) layers[0] += fill; // n=1
          else if (i == 1 || i == 2) layers[1] += fill; // n=2
          else if (i == 3 || i == 4) layers[2] += fill; // n=3
          else if (i == 5) layers[3] += fill; // n=4
        }

        let ve = 0,
          n = 0;
        for (let j = 3; j >= 0; j--) {
          if (layers[j] > 0) {
            ve = layers[j];
            n = j + 1;
            break;
          }
        }

        let type = "";
        if (ve <= 3) type = "Kim lo·∫°i";
        else if (ve >= 5 && ve < 8) type = "Phi kim";
        else if (ve === 8 || Z === 2) type = "Kh√≠ hi·∫øm";
        else type = "Kim lo·∫°i/Phi kim";
        if (Z === 1) type = "Phi kim";

        res.innerHTML = `
             <p>C·∫•u h√¨nh: <strong>${config}</strong></p>
             <p>L·ªõp ngo√†i c√πng (n=${n}) c√≥ <strong>${ve} e</strong> $\\rightarrow$ L√† <strong>${type}</strong>.</p>
          `;
        if (window.MathJax) MathJax.typesetPromise();
      }

      // 5. D·ª± ƒëo√°n t√≠nh ch·∫•t
      function predictProp() {
        const e = parseInt(document.getElementById("val-e").value);
        const res = document.getElementById("res-prop");
        res.style.display = "block";
        if (!e || e < 1 || e > 8) {
          res.innerHTML = "S·ªë e l·ªõp ngo√†i c√πng t·ª´ 1-8.";
          return;
        }

        let msg = "";
        if (e <= 3) msg = "Kim lo·∫°i";
        else if (e >= 5 && e < 8) msg = "Phi kim";
        else if (e === 8) msg = "Kh√≠ hi·∫øm";
        else msg = "Phi kim ho·∫∑c Kim lo·∫°i (th∆∞·ªùng l√† phi kim)";

        res.innerHTML = `C√≥ ${e} electron l·ªõp ngo√†i c√πng $\\rightarrow$ <strong>${msg}</strong>`;
        if (window.MathJax) MathJax.typesetPromise();
      }

      // === PH·∫¶N 3: LOGIC B·∫¢NG TU·∫¶N HO√ÄN MINI ===
      const elements = [
        { z: 1, s: "H", t: "nonmetal" },
        { z: 2, s: "He", t: "gas" },
        { z: 3, s: "Li", t: "metal" },
        { z: 4, s: "Be", t: "metal" },
        { z: 5, s: "B", t: "nonmetal" },
        { z: 6, s: "C", t: "nonmetal" },
        { z: 7, s: "N", t: "nonmetal" },
        { z: 8, s: "O", t: "nonmetal" },
        { z: 9, s: "F", t: "nonmetal" },
        { z: 10, s: "Ne", t: "gas" },
        { z: 11, s: "Na", t: "metal" },
        { z: 12, s: "Mg", t: "metal" },
        { z: 13, s: "Al", t: "metal" },
        { z: 14, s: "Si", t: "nonmetal" },
        { z: 15, s: "P", t: "nonmetal" },
        { z: 16, s: "S", t: "nonmetal" },
        { z: 17, s: "Cl", t: "nonmetal" },
        { z: 18, s: "Ar", t: "gas" },
        { z: 19, s: "K", t: "metal" },
        { z: 20, s: "Ca", t: "metal" },
      ];

      function initTable() {
        const grid = document.getElementById("periodic-grid");
        // Row 1
        createElBox(grid, elements[0]);
        for (let i = 0; i < 6; i++)
          grid.appendChild(document.createElement("div"));
        createElBox(grid, elements[1]);
        // Rows
        for (let i = 2; i < elements.length; i++)
          createElBox(grid, elements[i]);
      }

      function createElBox(grid, el) {
        const div = document.createElement("div");
        div.className = `element type-${el.t}`;
        div.innerHTML = `<strong>${el.s}</strong><div>${el.z}</div>`;
        div.onclick = () => {
          const info = document.getElementById("element-quick-info");
          info.style.display = "block";
          let typeName =
            el.t === "metal"
              ? "Kim lo·∫°i"
              : el.t === "gas"
              ? "Kh√≠ hi·∫øm"
              : "Phi kim";
          info.innerHTML = `Nguy√™n t·ªë: <strong>${el.s}</strong> (Z=${el.z}) | Lo·∫°i: <strong>${typeName}</strong>`;
          // T·ª± ƒë·ªông ƒëi·ªÅn v√†o c√¥ng c·ª• c·∫•u h√¨nh
          document.getElementById("config-z").value = el.z;
          genConfig(); // Ch·∫°y th·ª≠ lu√¥n
          // Chuy·ªÉn sang tab 3D n·∫øu mu·ªën
          document.getElementById("atom-selector").value = el.z;
          update3DModel(el.z);
        };
        grid.appendChild(div);
      }
      initTable();

      // === PH·∫¶N 4: LOGIC TR·∫ÆC NGHI·ªÜM ===
      const quizData = [
        {
          q: "H·∫°t nh√¢n nguy√™n t·ª≠ mang ƒëi·ªán t√≠ch g√¨?",
          a: ["D∆∞∆°ng (+)", "√Çm (-)", "Kh√¥ng mang ƒëi·ªán", "T√πy nguy√™n t·ªë"],
          c: 0,
        },
        {
          q: "H·∫°t n√†o c√≥ kh·ªëi l∆∞·ª£ng kh√¥ng ƒë√°ng k·ªÉ trong nguy√™n t·ª≠?",
          a: ["Proton", "Neutron", "Electron", "C·∫£ 3 h·∫°t"],
          c: 2,
        },
        {
          q: "ƒê·ªìng v·ªã l√† nh·ªØng nguy√™n t·ª≠ c√≥ c√πng s·ªë ... nh∆∞ng kh√°c s·ªë ...?",
          a: [
            "neutron, proton",
            "proton, neutron",
            "electron, neutron",
            "proton, electron",
          ],
          c: 1,
        },
        {
          q: "Nguy√™n t·ª≠ c√≥ 11 proton. L·ªõp ngo√†i c√πng c√≥ bao nhi√™u electron?",
          a: ["1e", "2e", "3e", "8e"],
          c: 0,
        },
        {
          q: "Nguy√™n t·ª≠ X c√≥ c·∫•u h√¨nh 1s¬≤2s¬≤2p¬≥. X l√†?",
          a: ["Kim lo·∫°i", "Phi kim", "Kh√≠ hi·∫øm", "Kh√¥ng x√°c ƒë·ªãnh"],
          c: 1,
        }, // N (Z=7) -> 5e ngo√†i c√πng -> Phi kim
      ];

      function initQuiz() {
        const container = document.getElementById("quiz-list");
        quizData.forEach((item, idx) => {
          let html = `<div class="quiz-item" id="q${idx}"><p><strong>C√¢u ${
            idx + 1
          }:</strong> ${item.q}</p><div class="quiz-options">`;
          item.a.forEach((opt, optIdx) => {
            html += `<label><input type="radio" name="q${idx}" value="${optIdx}"> ${opt}</label>`;
          });
          html += `</div></div>`;
          container.innerHTML += html;
        });
      }
      initQuiz();

      function checkQuiz() {
        let score = 0;
        quizData.forEach((item, idx) => {
          const qDiv = document.getElementById(`q${idx}`);
          const selected = qDiv.querySelector(`input[name="q${idx}"]:checked`);
          const labels = qDiv.querySelectorAll("label");

          // Reset
          labels.forEach((l) => l.classList.remove("correct", "wrong"));

          if (selected) {
            const val = parseInt(selected.value);
            if (val === item.c) {
              score++;
              labels[val].classList.add("correct");
            } else {
              labels[val].classList.add("wrong");
              labels[item.c].classList.add("correct"); // Show correct
            }
          } else {
            labels[item.c].classList.add("correct"); // Show answer if skipped
          }
        });
        const res = document.getElementById("quiz-score");
        res.style.display = "block";
        res.innerHTML = `K·∫øt qu·∫£: <strong>${score}/${quizData.length}</strong> c√¢u ƒë√∫ng.`;
      }

      // === PH·∫¶N 5: M√î PH·ªéNG 3D ===
      let scene, camera, renderer, controls, atomGroup;

      function init3D() {
        const container = document.getElementById("atom-container");
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0d1b2a);

        camera = new THREE.PerspectiveCamera(
          75,
          container.clientWidth / container.clientHeight,
          0.1,
          1000
        );
        camera.position.z = 12;

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        // Lights
        const ambient = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambient);
        const point = new THREE.PointLight(0xffffff, 1.5);
        point.position.set(5, 5, 5);
        scene.add(point);

        atomGroup = new THREE.Group();
        scene.add(atomGroup);

        createAtomModel(6); // Default Carbon
        animate();
      }

      function createAtomModel(Z) {
        // Clear old
        while (atomGroup.children.length > 0)
          atomGroup.remove(atomGroup.children[0]);

        // Nucleus
        const nGeo = new THREE.SphereGeometry(1, 32, 32);
        const nMat = new THREE.MeshPhongMaterial({
          color: 0xff4d4d,
          emissive: 0x550000,
        });
        const nucleus = new THREE.Mesh(nGeo, nMat);
        atomGroup.add(nucleus);

        // Electrons & Shells
        let rem = Z;
        // Simplified shells: 2, 8, 8, 2
        const shells = [
          { max: 2, r: 3, color: 0x4cc9f0 },
          { max: 8, r: 5, color: 0x4cc9f0 },
          { max: 8, r: 7, color: 0x4cc9f0 },
          { max: 2, r: 9, color: 0x4cc9f0 },
        ];

        shells.forEach((shell, sIdx) => {
          if (rem <= 0) return;
          const nE = Math.min(rem, shell.max);
          rem -= nE;

          // Orbit path
          const pathGeo = new THREE.TorusGeometry(shell.r, 0.03, 16, 100);
          const pathMat = new THREE.MeshBasicMaterial({
            color: shell.color,
            transparent: true,
            opacity: 0.3,
          });
          const path = new THREE.Mesh(pathGeo, pathMat);
          // Rotate slightly for 3D effect
          path.rotation.x = Math.PI / 2;
          path.rotation.y = (sIdx % 2) * 0.2;
          atomGroup.add(path);

          // Electrons
          const eGeo = new THREE.SphereGeometry(0.2, 16, 16);
          const eMat = new THREE.MeshPhongMaterial({ color: 0xffff00 });

          for (let i = 0; i < nE; i++) {
            const angle = (i / nE) * Math.PI * 2;
            const e = new THREE.Mesh(eGeo, eMat);
            e.userData = {
              r: shell.r,
              angle: angle,
              speed: 0.02 + Math.random() * 0.01,
            };

            // Init pos
            e.position.x = shell.r * Math.cos(angle);
            e.position.z = shell.r * Math.sin(angle);
            // Tilting logic matching orbit
            let yTilt = (sIdx % 2) * 0.2;
            // (Simplified physics, visual only)

            atomGroup.add(e);
          }
        });
      }

      function update3DModel(Z) {
        createAtomModel(parseInt(Z));
      }

      function animate() {
        requestAnimationFrame(animate);
        controls.update();

        atomGroup.children.forEach((child) => {
          // Rotate electrons
          if (child.geometry.type === "SphereGeometry" && child.userData.r) {
            child.userData.angle += child.userData.speed;
            child.position.x =
              child.userData.r * Math.cos(child.userData.angle);
            child.position.z =
              child.userData.r * Math.sin(child.userData.angle);
          }
        });
        renderer.render(scene, camera);
      }

      function onWindowResize() {
        const c = document.getElementById("atom-container");
        if (camera && renderer) {
          camera.aspect = c.clientWidth / c.clientHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(c.clientWidth, c.clientHeight);
        }
      }
      window.addEventListener("resize", onWindowResize);
      window.onload = init3D;
    </script>
  </body>
</html>
