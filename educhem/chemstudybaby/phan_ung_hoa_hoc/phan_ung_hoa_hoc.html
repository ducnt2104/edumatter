<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>H√≥a H·ªçc 8 - Interactive Lab Pro</title>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Nunito", "sans-serif"],
              display: ["Fredoka", "sans-serif"],
            },
            colors: {
              brand: {
                bg: "#0f172a",
                card: "#1e293b",
                accent: "#38bdf8", // Sky blue
                primary: "#6366f1", // Indigo
                success: "#22c55e",
                warning: "#eab308",
                danger: "#ef4444",
              },
            },
            animation: {
              float: "float 6s ease-in-out infinite",
            },
            keyframes: {
              float: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-10px)" },
              },
            },
          },
        },
      };
    </script>

    <style>
      body {
        background-color: #0f172a;
        color: #f8fafc;
        overflow: hidden; /* App app-like feel */
        height: 100vh;
        width: 100vw;
      }
      .glass {
        background: rgba(30, 41, 59, 0.6);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }
      .glass-active {
        background: rgba(56, 189, 248, 0.15);
        border: 1px solid rgba(56, 189, 248, 0.4);
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-thumb {
        background: #475569;
        border-radius: 4px;
      }

      .neon-text {
        text-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useMemo } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { createIcons } = window.lucide;

      // --- DATA: THEORY SLIDES ---
      const THEORY_DATA = [
        {
          id: 1,
          title: "I. Bi·∫øn ƒë·ªïi V·∫≠t l√≠ & H√≥a h·ªçc",
          icon: "refresh-cw",
          content: (
            <div className="space-y-4">
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-blue-900/30 p-4 rounded-xl border border-blue-500/30 text-center">
                  <h3 className="font-bold text-blue-400 mb-2 text-lg">
                    Bi·∫øn ƒë·ªïi V·∫≠t l√≠
                  </h3>
                  <p className="text-sm text-slate-300">
                    Ch·ªâ thay ƒë·ªïi tr·∫°ng th√°i, h√¨nh d·∫°ng. <b>KH√îNG</b> t·∫°o ch·∫•t
                    m·ªõi.
                  </p>
                  <div className="mt-3 text-2xl">üßä ‚ûù üíß</div>
                  <div className="text-xs mt-1 opacity-70">N∆∞·ªõc ƒë√° tan</div>
                </div>
                <div className="bg-purple-900/30 p-4 rounded-xl border border-purple-500/30 text-center">
                  <h3 className="font-bold text-purple-400 mb-2 text-lg">
                    Bi·∫øn ƒë·ªïi H√≥a h·ªçc
                  </h3>
                  <p className="text-sm text-slate-300">
                    Ch·∫•t bi·∫øn ƒë·ªïi t·∫°o ra <b>CH·∫§T M·ªöI</b>.
                  </p>
                  <div className="mt-3 text-2xl">ü™µüî• ‚ûù ‚ö´üí®</div>
                  <div className="text-xs mt-1 opacity-70">ƒê·ªët ch√°y g·ªó</div>
                </div>
              </div>
              <div className="bg-slate-800 p-3 rounded-lg text-sm border-l-4 border-brand-warning">
                üí° <b>D·∫•u hi·ªáu nh·∫≠n bi·∫øt P∆ØHH:</b> Thay ƒë·ªïi m√†u s·∫Øc, t·ªèa nhi·ªát,
                s·ªßi b·ªçt kh√≠, t·∫°o k·∫øt t·ªßa.
              </div>
            </div>
          ),
        },
        {
          id: 2,
          title: "II. ƒê·ªãnh lu·∫≠t B·∫£o to√†n Kh·ªëi l∆∞·ª£ng",
          icon: "scale",
          content: (
            <div className="text-center space-y-6">
              <p className="italic text-slate-300">
                "Trong m·ªôt ph·∫£n ·ª©ng h√≥a h·ªçc, t·ªïng kh·ªëi l∆∞·ª£ng c·ªßa c√°c ch·∫•t s·∫£n
                ph·∫©m b·∫±ng t·ªïng kh·ªëi l∆∞·ª£ng c·ªßa c√°c ch·∫•t tham gia ph·∫£n ·ª©ng."
              </p>
              <div className="bg-slate-900 p-6 rounded-2xl border border-slate-700 font-mono text-xl">
                <span className="text-brand-accent">m</span>
                <sub>tham gia</sub> ={" "}
                <span className="text-brand-success">m</span>
                <sub>s·∫£n ph·∫©m</sub>
              </div>
              <div className="text-sm text-slate-400">
                V√≠ d·ª•: A + B ‚ûù C + D <br />
                mA + mB = mC + mD
              </div>
            </div>
          ),
        },
        {
          id: 3,
          title: "III. Mol & T·ªâ kh·ªëi",
          icon: "box",
          content: (
            <div className="space-y-4">
              <div className="flex items-center gap-4 bg-slate-800 p-4 rounded-xl">
                <div className="text-3xl">üì¶</div>
                <div>
                  <h4 className="font-bold text-brand-accent">Mol l√† g√¨?</h4>
                  <p className="text-sm">
                    L√† l∆∞·ª£ng ch·∫•t ch·ª©a <b>6.022 √ó 10¬≤¬≥</b> h·∫°t vi m√¥ (N).
                  </p>
                </div>
              </div>
              <div className="grid grid-cols-2 gap-2 text-center text-sm">
                <div className="bg-slate-700 p-2 rounded">
                  <div className="font-bold text-brand-primary">n = m / M</div>
                  <div className="text-xs opacity-70">T√≠nh theo kh·ªëi l∆∞·ª£ng</div>
                </div>
                <div className="bg-slate-700 p-2 rounded">
                  <div className="font-bold text-brand-primary">
                    n = V / 24.79
                  </div>
                  <div className="text-xs opacity-70">
                    T√≠nh theo th·ªÉ t√≠ch kh√≠ (ƒëkc)
                  </div>
                </div>
              </div>
            </div>
          ),
        },
        {
          id: 4,
          title: "IV. Ph·∫£n ·ª©ng H√≥a h·ªçc & NƒÉng l∆∞·ª£ng",
          icon: "zap",
          content: (
            <div className="space-y-4">
              <h3 className="font-bold text-lg text-brand-primary">
                Ph·∫£n ·ª©ng t·ªèa nhi·ªát v√† thu nhi·ªát
              </h3>
              <div className="grid grid-cols-2 gap-4 text-center">
                <div className="bg-orange-900/30 p-4 rounded-xl border border-orange-500/30">
                  <h4 className="font-bold text-orange-400 mb-2">
                    T·ªèa Nhi·ªát üî•
                  </h4>
                  <p className="text-sm text-slate-300">
                    Ph·∫£n ·ª©ng gi·∫£i ph√≥ng **nƒÉng l∆∞·ª£ng (nhi·ªát)** ra m√¥i tr∆∞·ªùng.
                  </p>
                  <div className="mt-3 text-2xl">
                    <span className="text-sm italic mr-1">V√≠ d·ª•:</span> C + O‚ÇÇ ‚Üí
                    CO‚ÇÇ + Nhi·ªát
                  </div>
                </div>
                <div className="bg-cyan-900/30 p-4 rounded-xl border border-cyan-500/30">
                  <h4 className="font-bold text-cyan-400 mb-2">Thu Nhi·ªát ‚ùÑÔ∏è</h4>
                  <p className="text-sm text-slate-300">
                    Ph·∫£n ·ª©ng **h·∫•p th·ª• nƒÉng l∆∞·ª£ng (nhi·ªát)** t·ª´ m√¥i tr∆∞·ªùng.
                  </p>
                  <div className="mt-3 text-2xl">
                    <span className="text-sm italic mr-1">V√≠ d·ª•:</span> N‚ÇÇ + O‚ÇÇ
                    + Nhi·ªát ‚Üí 2NO
                  </div>
                </div>
              </div>
              <div className="bg-slate-800 p-3 rounded-lg text-sm border-l-4 border-brand-accent">
                üí° **Di·ªÖn bi·∫øn:** C√°c **nguy√™n t·ª≠** ƒë∆∞·ª£c t√°i s·∫Øp x·∫øp ƒë·ªÉ t·∫°o
                th√†nh ph√¢n t·ª≠ m·ªõi.
              </div>
            </div>
          ),
        },
        {
          id: 5,
          title: "V. Ph∆∞∆°ng tr√¨nh H√≥a h·ªçc (PTHH)",
          icon: "book-open",
          content: (
            <div className="space-y-4">
              <h3 className="font-bold text-lg text-brand-primary">
                Kh√°i ni·ªám
              </h3>
              <p className="text-sm text-slate-300 italic">
                L√† c√°ch bi·ªÉu di·ªÖn t√≥m t·∫Øt **ph·∫£n ·ª©ng h√≥a h·ªçc** b·∫±ng c√¥ng th·ª©c
                h√≥a h·ªçc v√† t·ªâ l·ªá s·ªë mol c√°c ch·∫•t.
              </p>
              <div className="bg-slate-900 p-6 rounded-2xl border border-slate-700 font-mono text-center">
                <div className="text-xl text-brand-success">
                  2H‚ÇÇ + O‚ÇÇ ‚Üí 2H‚ÇÇO
                </div>
                <div className="text-sm text-slate-400 mt-2">
                  (T·ªâ l·ªá mol: 2 : 1 : 2)
                </div>
              </div>
              <div className="text-sm text-slate-400">
                **M·ª•c ƒë√≠ch:** D√πng ƒë·ªÉ t√≠nh to√°n l∆∞·ª£ng ch·∫•t tham gia v√† s·∫£n ph·∫©m.
              </div>
            </div>
          ),
        },
        {
          id: 6,
          title: "VI. T√≠nh theo PTHH & Hi·ªáu su·∫•t",
          icon: "calculator",
          content: (
            <div className="space-y-4">
              <h3 className="font-bold text-lg text-brand-primary">
                T√≠nh theo Ph∆∞∆°ng tr√¨nh H√≥a h·ªçc
              </h3>
              <div className="text-sm space-y-2">
                <p>
                  <span className="font-bold text-brand-success">B1:</span> Vi·∫øt
                  v√†{" "}
                  <span className="font-bold text-brand-accent">c√¢n b·∫±ng</span>{" "}
                  PTHH.
                </p>
                <p>
                  <span className="font-bold text-brand-success">B2:</span> T√≠nh{" "}
                  <span className="font-bold">s·ªë mol (n)</span> c·ªßa ch·∫•t ƒë√£
                  bi·∫øt.
                </p>
                <p>
                  <span className="font-bold text-brand-success">B3:</span> D√πng{" "}
                  <span className="font-bold">t·ªâ l·ªá mol</span> ƒë·ªÉ t√≠nh n c·ªßa
                  ch·∫•t c·∫ßn t√¨m.
                </p>
              </div>
              <hr className="border-slate-700" />
              <h3 className="font-bold text-lg text-brand-primary">
                Hi·ªáu su·∫•t Ph·∫£n ·ª©ng
              </h3>
              <div className="bg-slate-900 p-4 rounded-xl border border-slate-700 text-center font-mono text-lg">
                <span className="text-brand-accent">H (%)</span> ={" "}
                <span className="text-brand-success">m</span>
                <sub>th·ª±c t·∫ø</sub> /{" "}
                <span className="text-brand-warning">m</span>
                <sub>l√Ω thuy·∫øt</sub>{" "}
                <span className="text-brand-primary">√ó 100</span>
              </div>
            </div>
          ),
        },
        {
          id: 7,
          title: "VII. N·ªìng ƒë·ªô Dung d·ªãch & ƒê·ªô tan",
          icon: "droplet",
          content: (
            <div className="space-y-4">
              <h3 className="font-bold text-lg text-brand-primary">
                N·ªìng ƒë·ªô Mol (C<span className="text-xs">M</span>)
              </h3>
              <div className="bg-slate-900 p-3 rounded-xl border border-slate-700 text-center font-mono text-lg">
                C<span className="text-xs">M</span> ={" "}
                <span className="text-brand-success">n</span> /{" "}
                <span className="text-brand-accent">V</span> (mol/L)
              </div>
              <h3 className="font-bold text-lg text-brand-primary mt-4">
                N·ªìng ƒë·ªô Ph·∫ßn trƒÉm (C%)
              </h3>
              <div className="bg-slate-900 p-3 rounded-xl border border-slate-700 text-center font-mono text-lg">
                C% = (<span className="text-brand-success">m</span>
                <sub>ch·∫•t tan</sub> /{" "}
                <span className="text-brand-accent">m</span>
                <sub>dd</sub>) √ó 100%
              </div>
              <div className="text-sm text-slate-400 mt-2">
                **ƒê·ªô tan:** L∆∞·ª£ng t·ªëi ƒëa ch·∫•t tan trong **100g n∆∞·ªõc** ·ªü ƒëi·ªÅu
                ki·ªán nh·∫•t ƒë·ªãnh.
              </div>
            </div>
          ),
        },
        {
          id: 8,
          title: "VIII. T·ªëc ƒë·ªô Ph·∫£n ·ª©ng & X√∫c t√°c",
          icon: "activity",
          content: (
            <div className="space-y-4">
              <h3 className="font-bold text-lg text-brand-primary">
                T·ªëc ƒë·ªô Ph·∫£n ·ª©ng
              </h3>
              <p className="text-sm text-slate-300">
                ƒê∆∞·ª£c ƒëo b·∫±ng s·ª± thay ƒë·ªïi **n·ªìng ƒë·ªô** ch·∫•t ph·∫£n ·ª©ng ho·∫∑c s·∫£n ph·∫©m
                theo **th·ªùi gian**.
              </p>
              <h4 className="font-bold text-brand-accent">Y·∫øu t·ªë ·∫£nh h∆∞·ªüng:</h4>
              <ul className="list-disc list-inside space-y-1 text-sm text-slate-300 ml-4">
                <li>
                  <span className="font-bold">Nhi·ªát ƒë·ªô:</span> TƒÉng $\uparrow$
                  T·ªëc ƒë·ªô $\uparrow$
                </li>
                <li>
                  <span className="font-bold">N·ªìng ƒë·ªô:</span> TƒÉng $\uparrow$
                  T·ªëc ƒë·ªô $\uparrow$
                </li>
                <li>
                  <span className="font-bold">Di·ªán t√≠ch b·ªÅ m·∫∑t:</span> TƒÉng
                  $\uparrow$ T·ªëc ƒë·ªô $\uparrow$ (Ch·∫•t r·∫Øn)
                </li>
                <li>
                  <span className="font-bold text-brand-success">
                    Ch·∫•t x√∫c t√°c:
                  </span>{" "}
                  Gi√∫p tƒÉng t·ªëc ƒë·ªô m√† **kh√¥ng** b·ªã ti√™u hao.
                </li>
              </ul>
            </div>
          ),
        },
      ];

      // --- DATA: GAME QUESTIONS ---
      const SORT_GAME_DATA = [
        {
          id: 1,
          text: "N∆∞·ªõc ƒë√≥ng bƒÉng",
          type: "phys",
          explain: "Ch·ªâ ƒë·ªïi tr·∫°ng th√°i L·ªèng -> R·∫Øn",
        },
        {
          id: 2,
          text: "ƒêinh s·∫Øt b·ªã g·ªâ",
          type: "chem",
          explain: "T·∫°o th√†nh oxit s·∫Øt m√†u n√¢u ƒë·ªè",
        },
        {
          id: 3,
          text: "H√≤a tan mu·ªëi v√†o n∆∞·ªõc",
          type: "phys",
          explain: "Mu·ªëi v·∫´n l√† mu·ªëi, ch·ªâ b·ªã ph√¢n t√°n",
        },
        {
          id: 4,
          text: "ƒê·ªët ch√°y t·ªù gi·∫•y",
          type: "chem",
          explain: "T·∫°o tro v√† kh√≥i (ch·∫•t m·ªõi)",
        },
        {
          id: 5,
          text: "C·ªìn bay h∆°i",
          type: "phys",
          explain: "Chuy·ªÉn t·ª´ L·ªèng -> H∆°i",
        },
        {
          id: 6,
          text: "Lu·ªôc ch√≠n tr·ª©ng",
          type: "chem",
          explain: "Protein b·ªã bi·∫øn t√≠nh b·ªüi nhi·ªát",
        },
      ];

      // ==================================================================================
      // 1. COMPONENTS SIMULATION
      // ==================================================================================

      // --- SIM 1: CARD SORTING GAME (Bi·∫øn ƒë·ªïi ch·∫•t) ---
      const SortingGame = () => {
        const [cards, setCards] = useState(SORT_GAME_DATA);
        const [current, setCurrent] = useState(0);
        const [score, setScore] = useState(0);
        const [feedback, setFeedback] = useState(null); // 'correct' | 'wrong'
        const [finished, setFinished] = useState(false);

        const handleChoice = (choice) => {
          const card = cards[current];
          const isCorrect = card.type === choice;

          setFeedback(isCorrect ? "correct" : "wrong");

          if (isCorrect) {
            setScore((s) => s + 1);
            if (window.confetti)
              confetti({ particleCount: 30, spread: 50, origin: { y: 0.7 } });
          }

          setTimeout(() => {
            setFeedback(null);
            if (current < cards.length - 1) {
              setCurrent((c) => c + 1);
            } else {
              setFinished(true);
              if (score >= 4 && window.confetti)
                confetti({ particleCount: 150, spread: 70 });
            }
          }, 800);
        };

        const reset = () => {
          setCurrent(0);
          setScore(0);
          setFinished(false);
          setCards([...SORT_GAME_DATA].sort(() => Math.random() - 0.5));
        };

        if (finished)
          return (
            <div className="text-center p-8">
              <div className="text-6xl mb-4">üèÜ</div>
              <h2 className="text-2xl font-bold mb-2">Ho√†n th√†nh!</h2>
              <p className="text-slate-400 mb-6">
                B·∫°n ƒë·∫°t {score}/{cards.length} ƒëi·ªÉm
              </p>
              <button
                onClick={reset}
                className="bg-brand-primary px-6 py-2 rounded-lg font-bold"
              >
                Ch∆°i l·∫°i
              </button>
            </div>
          );

        return (
          <div className="flex flex-col items-center h-full justify-center p-4">
            <div className="mb-6 flex justify-between w-full max-w-sm text-sm font-bold text-slate-400">
              <span>
                C√¢u {current + 1}/{cards.length}
              </span>
              <span>ƒêi·ªÉm: {score}</span>
            </div>

            <div className="relative w-full max-w-sm h-64 perspective-1000">
              <motion.div
                key={cards[current].id}
                initial={{ scale: 0.8, opacity: 0, y: 50 }}
                animate={{ scale: 1, opacity: 1, y: 0 }}
                className={`w-full h-full glass rounded-3xl flex flex-col items-center justify-center p-6 border-2 transition-colors duration-300
                        ${
                          feedback === "correct"
                            ? "border-green-500 bg-green-500/10"
                            : ""
                        }
                        ${
                          feedback === "wrong"
                            ? "border-red-500 bg-red-500/10"
                            : "border-slate-600"
                        }
                    `}
              >
                <div className="text-3xl font-bold text-center mb-2 text-white">
                  {cards[current].text}
                </div>
                {feedback && (
                  <motion.div
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    className="text-sm mt-2 font-bold text-slate-300 text-center"
                  >
                    {feedback === "correct" ? "‚úÖ Ch√≠nh x√°c!" : "‚ùå Sai r·ªìi!"}{" "}
                    <br />
                    <span className="font-normal opacity-80">
                      {cards[current].explain}
                    </span>
                  </motion.div>
                )}
              </motion.div>
            </div>

            <div className="flex gap-4 mt-8 w-full max-w-sm">
              <button
                disabled={feedback !== null}
                onClick={() => handleChoice("phys")}
                className="flex-1 py-4 rounded-xl bg-blue-600/80 hover:bg-blue-500 text-white font-bold transition disabled:opacity-50"
              >
                V·∫≠t L√≠ üßä
              </button>
              <button
                disabled={feedback !== null}
                onClick={() => handleChoice("chem")}
                className="flex-1 py-4 rounded-xl bg-purple-600/80 hover:bg-purple-500 text-white font-bold transition disabled:opacity-50"
              >
                H√≥a H·ªçc üî•
              </button>
            </div>
          </div>
        );
      };

      // --- SIM 2: REACTION RATE (Canvas) ---
      const ReactionRateSim = () => {
        const canvasRef = useRef(null);
        const [temp, setTemp] = useState(1); // 1-5
        const [conc, setConc] = useState(20); // 10-100 particles

        useEffect(() => {
          const cvs = canvasRef.current;
          const ctx = cvs.getContext("2d");
          let particles = [];
          let animationFrameId;

          const initParticles = () => {
            particles = [];
            for (let i = 0; i < conc; i++) {
              particles.push({
                x: Math.random() * cvs.width,
                y: Math.random() * cvs.height,
                vx: (Math.random() - 0.5) * temp * 2,
                vy: (Math.random() - 0.5) * temp * 2,
                r: 4,
                color: Math.random() > 0.5 ? "#38bdf8" : "#ef4444", // Blue or Red
              });
            }
          };
          initParticles();

          const render = () => {
            ctx.clearRect(0, 0, cvs.width, cvs.height);

            // Draw Background
            ctx.fillStyle = "#0f172a";
            ctx.fillRect(0, 0, cvs.width, cvs.height);

            particles.forEach((p) => {
              p.x += p.vx;
              p.y += p.vy;

              // Bounce walls
              if (p.x < 0 || p.x > cvs.width) p.vx *= -1;
              if (p.y < 0 || p.y > cvs.height) p.vy *= -1;

              ctx.beginPath();
              ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
              ctx.fillStyle = p.color;
              ctx.fill();
            });

            // Collision Effect (Simple Visual)
            if (temp > 3) {
              ctx.font = "20px Arial";
              ctx.fillStyle = "rgba(255,255,255,0.2)";
              ctx.fillText("T·ªêC ƒê·ªò CAO üî•", 10, 30);
            }

            animationFrameId = requestAnimationFrame(render);
          };
          render();

          return () => cancelAnimationFrame(animationFrameId);
        }, [temp, conc]);

        return (
          <div className="flex flex-col h-full gap-4">
            <div className="bg-brand-card p-4 rounded-xl flex flex-col gap-4">
              <div className="flex items-center gap-4">
                <i data-lucide="thermometer" className="text-red-400"></i>
                <div className="flex-1">
                  <label className="text-xs text-slate-400">
                    Nhi·ªát ƒë·ªô (T·ªëc ƒë·ªô h·∫°t)
                  </label>
                  <input
                    type="range"
                    min="1"
                    max="8"
                    value={temp}
                    onChange={(e) => setTemp(parseInt(e.target.value))}
                    className="w-full accent-red-500"
                  />
                </div>
              </div>
              <div className="flex items-center gap-4">
                <i data-lucide="users" className="text-blue-400"></i>
                <div className="flex-1">
                  <label className="text-xs text-slate-400">
                    N·ªìng ƒë·ªô (S·ªë l∆∞·ª£ng h·∫°t)
                  </label>
                  <input
                    type="range"
                    min="10"
                    max="150"
                    value={conc}
                    onChange={(e) => setConc(parseInt(e.target.value))}
                    className="w-full accent-blue-500"
                  />
                </div>
              </div>
            </div>
            <div className="flex-1 glass rounded-2xl overflow-hidden relative border border-slate-700">
              <canvas
                ref={canvasRef}
                width={600}
                height={400}
                className="w-full h-full object-cover"
              />
              <div className="absolute top-2 right-2 text-xs bg-black/50 px-2 py-1 rounded text-slate-400">
                M√¥ ph·ªèng va ch·∫°m
              </div>
            </div>
          </div>
        );
      };

      // --- TOOL: MOL CALCULATOR ---
      const MolCalculator = () => {
        const [substance, setSubstance] = useState("Fe");
        const [M, setM] = useState(56);
        const [mol, setMol] = useState(1);

        const SUBSTANCES = [
          { sym: "H2", m: 2 },
          { sym: "O2", m: 32 },
          { sym: "H2O", m: 18 },
          { sym: "CO2", m: 44 },
          { sym: "Fe", m: 56 },
          { sym: "NaCl", m: 58.5 },
        ];

        const handleSubChange = (e) => {
          const s = SUBSTANCES.find((i) => i.sym === e.target.value);
          setSubstance(s.sym);
          setM(s.m);
        };

        return (
          <div className="max-w-md mx-auto w-full space-y-6">
            <div className="bg-brand-card p-6 rounded-2xl border border-slate-700 shadow-xl">
              <h2 className="text-xl font-display font-bold text-brand-accent mb-4 flex items-center gap-2">
                <i data-lucide="calculator"></i> M√°y t√≠nh Mol
              </h2>

              {/* INPUTS */}
              <div className="space-y-4">
                <div>
                  <label className="text-xs text-slate-400 uppercase font-bold">
                    Ch·ªçn ch·∫•t
                  </label>
                  <select
                    value={substance}
                    onChange={handleSubChange}
                    className="w-full bg-slate-800 text-white p-3 rounded-lg border border-slate-600 mt-1 outline-none focus:border-brand-primary"
                  >
                    {SUBSTANCES.map((s) => (
                      <option key={s.sym} value={s.sym}>
                        {s.sym} (M = {s.m})
                      </option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="text-xs text-slate-400 uppercase font-bold">
                    S·ªë Mol (n)
                  </label>
                  <input
                    type="number"
                    step="0.1"
                    value={mol}
                    onChange={(e) => setMol(parseFloat(e.target.value) || 0)}
                    className="w-full bg-slate-800 text-white p-3 rounded-lg border border-slate-600 mt-1 outline-none focus:border-brand-primary font-mono text-lg"
                  />
                </div>
              </div>

              {/* RESULTS */}
              <div className="mt-8 grid grid-cols-2 gap-4">
                <div className="bg-slate-700/50 p-4 rounded-xl border border-slate-600">
                  <div className="text-xs text-slate-400 mb-1">
                    Kh·ªëi l∆∞·ª£ng (m)
                  </div>
                  <div className="text-2xl font-mono font-bold text-brand-success">
                    {(mol * M).toFixed(2)} <span className="text-sm">g</span>
                  </div>
                </div>
                <div className="bg-slate-700/50 p-4 rounded-xl border border-slate-600">
                  <div className="text-xs text-slate-400 mb-1">
                    Th·ªÉ t√≠ch kh√≠ (ƒëkc)
                  </div>
                  <div className="text-2xl font-mono font-bold text-brand-warning">
                    {(mol * 24.79).toFixed(2)}{" "}
                    <span className="text-sm">L</span>
                  </div>
                  <div className="text-[10px] text-slate-500">
                    *Ch·ªâ ƒë√∫ng v·ªõi ch·∫•t kh√≠
                  </div>
                </div>
                <div className="bg-slate-700/50 p-4 rounded-xl border border-slate-600 col-span-2">
                  <div className="text-xs text-slate-400 mb-1">S·ªë h·∫°t (A)</div>
                  <div className="text-xl font-mono font-bold text-white">
                    {(mol * 6.022).toFixed(3)} x 10¬≤¬≥
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // ==================================================================================
      // 2. MAIN LAYOUT & NAVIGATION
      // ==================================================================================

      const App = () => {
        const [activeTab, setActiveTab] = useState("theory"); // 'theory', 'lab', 'calc'
        const [activeLab, setActiveLab] = useState("sort"); // 'sort', 'rate'

        useEffect(() => {
          createIcons();
        }, [activeTab, activeLab]);

        return (
          <div className="flex h-screen bg-brand-bg text-slate-100 font-sans overflow-hidden">
            {/* SIDEBAR (Desktop) / TOPBAR (Mobile) */}
            <aside className="w-20 md:w-64 bg-brand-card border-r border-slate-700 flex flex-col justify-between z-20">
              <div>
                <div className="h-16 flex items-center justify-center md:justify-start md:px-6 border-b border-slate-700">
                  <i
                    data-lucide="flask-conical"
                    className="text-brand-primary w-8 h-8"
                  ></i>
                  <span className="hidden md:block ml-3 font-display font-bold text-xl text-white">
                    E-Chem 8
                  </span>
                </div>

                <nav className="p-2 md:p-4 space-y-2">
                  <NavBtn
                    id="theory"
                    icon="book-open"
                    label="L√Ω Thuy·∫øt"
                    active={activeTab}
                    set={setActiveTab}
                  />
                  <NavBtn
                    id="lab"
                    icon="microscope"
                    label="Ph√≤ng Lab"
                    active={activeTab}
                    set={setActiveTab}
                  />
                  <NavBtn
                    id="calc"
                    icon="calculator"
                    label="M√°y T√≠nh Mol"
                    active={activeTab}
                    set={setActiveTab}
                  />
                </nav>
              </div>

              <div className="p-4 text-center hidden md:block text-xs text-slate-500">
                Interactive Lab v3.0
              </div>
            </aside>

            {/* MAIN CONTENT AREA */}
            <main className="flex-1 relative overflow-hidden flex flex-col">
              {/* Header for Mobile context mostly */}
              <header className="h-16 border-b border-slate-700 flex items-center px-6 bg-brand-bg/80 backdrop-blur justify-between">
                <h1 className="text-xl font-bold text-slate-200">
                  {activeTab === "theory" && "Ki·∫øn Th·ª©c Tr·ªçng T√¢m"}
                  {activeTab === "lab" && "M√¥ Ph·ªèng T∆∞∆°ng T√°c"}
                  {activeTab === "calc" && "C√¥ng C·ª• T√≠nh To√°n"}
                  <a href="../chemstudybaby.html">----quay v·ªÅ trang ch·ªß</a>
                </h1>

                {/* Lab Selector Tabs (Only show if in Lab) */}
                {activeTab === "lab" && (
                  <div className="flex bg-slate-800 rounded-lg p-1 gap-1">
                    <button
                      onClick={() => setActiveLab("sort")}
                      className={`px-3 py-1 text-sm rounded-md transition ${
                        activeLab === "sort"
                          ? "bg-brand-primary text-white"
                          : "text-slate-400 hover:text-white"
                      }`}
                    >
                      Ph√¢n Lo·∫°i
                    </button>
                    <button
                      onClick={() => setActiveLab("rate")}
                      className={`px-3 py-1 text-sm rounded-md transition ${
                        activeLab === "rate"
                          ? "bg-brand-primary text-white"
                          : "text-slate-400 hover:text-white"
                      }`}
                    >
                      T·ªëc ƒê·ªô P∆Ø
                    </button>
                  </div>
                )}
              </header>

              <div className="flex-1 overflow-y-auto p-4 md:p-8 relative">
                {/* BACKGROUND ELEMENTS */}
                <div className="absolute top-10 left-10 w-64 h-64 bg-brand-primary/10 rounded-full blur-3xl -z-10 animate-float"></div>
                <div className="absolute bottom-10 right-10 w-96 h-96 bg-brand-accent/5 rounded-full blur-3xl -z-10"></div>

                {/* CONTENT SWITHCER */}
                <AnimatePresence mode="wait">
                  <motion.div
                    key={activeTab + activeLab}
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -10 }}
                    className="h-full max-w-5xl mx-auto"
                  >
                    {activeTab === "theory" && <TheoryView />}
                    {activeTab === "calc" && <MolCalculator />}
                    {activeTab === "lab" && activeLab === "sort" && (
                      <SortingGame />
                    )}
                    {activeTab === "lab" && activeLab === "rate" && (
                      <ReactionRateSim />
                    )}
                  </motion.div>
                </AnimatePresence>
              </div>
            </main>
          </div>
        );
      };

      // --- SUB COMPONENTS ---

      const NavBtn = ({ id, icon, label, active, set }) => (
        <button
          onClick={() => set(id)}
          className={`w-full flex items-center justify-center md:justify-start p-3 rounded-xl transition-all duration-200 group
            ${
              active === id
                ? "bg-brand-primary text-white shadow-lg shadow-brand-primary/25"
                : "text-slate-400 hover:bg-slate-800 hover:text-white"
            }`}
        >
          <i
            data-lucide={icon}
            className={`w-6 h-6 md:mr-3 transition-transform ${
              active === id ? "scale-110" : "group-hover:scale-110"
            }`}
          ></i>
          <span className="hidden md:block font-medium">{label}</span>
        </button>
      );

      const TheoryView = () => {
        const [slide, setSlide] = useState(0);
        return (
          <div className="flex flex-col h-full justify-center items-center">
            <div className="glass w-full max-w-3xl p-8 rounded-3xl min-h-[400px] flex flex-col relative">
              <div className="flex items-center gap-3 mb-6 pb-4 border-b border-slate-600/50">
                <div className="p-3 bg-brand-primary/20 rounded-xl text-brand-primary">
                  <i data-lucide={THEORY_DATA[slide].icon}></i>
                </div>
                <h2 className="text-2xl font-display font-bold text-white">
                  {THEORY_DATA[slide].title}
                </h2>
              </div>

              <div className="flex-1">{THEORY_DATA[slide].content}</div>

              <div className="flex justify-between mt-8 pt-4 border-t border-slate-600/50">
                <button
                  disabled={slide === 0}
                  onClick={() => setSlide((s) => s - 1)}
                  className="px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 transition"
                >
                  ‚Üê Tr∆∞·ªõc
                </button>
                <span className="text-slate-500 font-mono self-center">
                  {slide + 1} / {THEORY_DATA.length}
                </span>
                <button
                  disabled={slide === THEORY_DATA.length - 1}
                  onClick={() => setSlide((s) => s + 1)}
                  className="px-4 py-2 rounded-lg bg-brand-primary hover:bg-brand-primary/80 disabled:opacity-50 transition font-bold"
                >
                  Sau ‚Üí
                </button>
              </div>
            </div>
          </div>
        );
      };

      // RENDER APP
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
