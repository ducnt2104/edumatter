<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>H√≥a H·ªçc 8 | Ph·∫£n ·ª®ng H√≥a H·ªçc (Full)</title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />
    <!-- React & Libraries -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@500;700&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["Nunito", "sans-serif"],
              display: ["Quicksand", "sans-serif"],
            },
            colors: {
              primary: { DEFAULT: "#3b82f6", dark: "#2563eb" },
              secondary: { DEFAULT: "#8b5cf6", dark: "#7c3aed" },
              accent: { DEFAULT: "#f59e0b", dark: "#d97706" },
              success: { DEFAULT: "#10b981", dark: "#059669" },
              danger: { DEFAULT: "#ef4444", dark: "#dc2626" },
              bg: { light: "#f8fafc", dark: "#0f172a" },
            },
          },
        },
      };
    </script>

    <style>
      body {
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      .dark ::-webkit-scrollbar-thumb {
        background: #475569;
      }
      .glass {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
      }
      .dark .glass {
        background: rgba(15, 23, 42, 0.7);
      }
      .modal-scroll::-webkit-scrollbar {
        width: 4px;
      }
      .modal-scroll::-webkit-scrollbar-track {
        background: transparent;
      }
      .modal-scroll::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
    </style>
  </head>
  <body
    class="bg-bg-light text-slate-800 dark:bg-bg-dark dark:text-slate-100 font-sans h-screen flex flex-col overflow-hidden selection:bg-blue-200 dark:selection:bg-blue-900"
  >
    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useMemo } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { createIcons } = window.lucide;

      // --- DATA: THEORY (Based strictly on provided text) ---
      const LESSONS = [
        {
          id: 1,
          title: "I. Bi·∫øn ƒë·ªïi ch·∫•t",
          icon: "refresh-cw",
          color: "blue",
          content: (
            <div className="space-y-4">
              <div className="grid md:grid-cols-2 gap-4">
                <div className="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800">
                  <h3 className="font-bold text-blue-600 dark:text-blue-400 mb-2 flex items-center gap-2">
                    <i data-lucide="snowflake" className="w-4 h-4"></i> Bi·∫øn ƒë·ªïi
                    V·∫≠t l√≠
                  </h3>
                  <p className="text-sm mb-2 text-slate-600 dark:text-slate-300">
                    Ch·ªâ thay ƒë·ªïi tr·∫°ng th√°i, h√¨nh d·∫°ng, k√≠ch th∆∞·ªõc.{" "}
                    <strong>Kh√¥ng t·∫°o ch·∫•t m·ªõi.</strong>
                  </p>
                  <ul className="text-xs list-disc ml-4 space-y-1 text-slate-500 dark:text-slate-400">
                    <li>N∆∞·ªõc ƒë√≥ng bƒÉng ‚Üî BƒÉng tan</li>
                    <li>X√© gi·∫•y, kim lo·∫°i d√°t m·ªèng</li>
                  </ul>
                </div>
                <div className="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl border border-purple-200 dark:border-purple-800">
                  <h3 className="font-bold text-purple-600 dark:text-purple-400 mb-2 flex items-center gap-2">
                    <i data-lucide="flame" className="w-4 h-4"></i> Bi·∫øn ƒë·ªïi H√≥a
                    h·ªçc
                  </h3>
                  <p className="text-sm mb-2 text-slate-600 dark:text-slate-300">
                    Ch·∫•t bi·∫øn ƒë·ªïi t·∫°o ra <strong>ch·∫•t m·ªõi</strong> v·ªõi t√≠nh ch·∫•t
                    kh√°c.
                  </p>
                  <ul className="text-xs list-disc ml-4 space-y-1 text-slate-500 dark:text-slate-400">
                    <li>Fe + O‚ÇÇ ‚Üí Fe‚ÇÇO‚ÇÉ (G·ªâ s·∫Øt)</li>
                    <li>H‚ÇÇ + Cl‚ÇÇ ‚Üí 2HCl</li>
                  </ul>
                </div>
              </div>
              <div className="overflow-hidden rounded-lg border border-slate-200 dark:border-slate-700">
                <table className="w-full text-sm text-left">
                  <thead className="bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200">
                    <tr>
                      <th className="p-2">Ti√™u ch√≠</th>
                      <th className="p-2">V·∫≠t l√≠</th>
                      <th className="p-2">H√≥a h·ªçc</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800">
                    <tr>
                      <td className="p-2 font-bold">T√≠nh ch·∫•t</td>
                      <td className="p-2 text-slate-500">Gi·ªØ nguy√™n</td>
                      <td className="p-2 text-primary font-bold">Thay ƒë·ªïi</td>
                    </tr>
                    <tr>
                      <td className="p-2 font-bold">Ch·∫•t m·ªõi</td>
                      <td className="p-2 text-slate-500">Kh√¥ng</td>
                      <td className="p-2 text-primary font-bold">C√≥</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div className="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg text-sm border-l-4 border-yellow-500 text-slate-700 dark:text-slate-300">
                <strong>Em c√≥ bi·∫øt?</strong> D√π l√† bi·∫øn ƒë·ªïi n√†o, s·ªë l∆∞·ª£ng nguy√™n
                t·ª≠ kh√¥ng ƒë·ªïi ‚Üí Kh·ªëi l∆∞·ª£ng ƒë∆∞·ª£c b·∫£o to√†n.
              </div>
            </div>
          ),
        },
        {
          id: 2,
          title: "II. Ph·∫£n ·ª©ng H√≥a h·ªçc",
          icon: "flask-conical",
          color: "purple",
          content: (
            <div className="space-y-4">
              <div className="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700">
                <h3 className="font-bold mb-2 text-primary">
                  Kh√°i ni·ªám & Di·ªÖn bi·∫øn
                </h3>
                <p className="text-sm text-slate-600 dark:text-slate-300 mb-2">
                  Qu√° tr√¨nh ch·∫•t n√†y bi·∫øn th√†nh ch·∫•t kh√°c. Li√™n k·∫øt gi·ªØa c√°c
                  nguy√™n t·ª≠ thay ƒë·ªïi, nh∆∞ng s·ªë l∆∞·ª£ng nguy√™n t·ª≠ gi·ªØ nguy√™n.
                </p>
                <div className="font-mono text-center bg-slate-100 dark:bg-slate-900 p-2 rounded text-sm text-slate-800 dark:text-green-400">
                  Zn + 2HCl ‚Üí ZnCl‚ÇÇ + H‚ÇÇ
                </div>
              </div>

              <div className="space-y-2">
                <h4 className="font-bold text-sm uppercase text-slate-500">
                  D·∫•u hi·ªáu nh·∫≠n bi·∫øt
                </h4>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="p-2 bg-slate-50 dark:bg-slate-700/50 rounded flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-red-500"></span>{" "}
                    ƒê·ªïi m√†u s·∫Øc
                  </div>
                  <div className="p-2 bg-slate-50 dark:bg-slate-700/50 rounded flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-yellow-500"></span>{" "}
                    T·∫°o k·∫øt t·ªßa
                  </div>
                  <div className="p-2 bg-slate-50 dark:bg-slate-700/50 rounded flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-blue-500"></span>{" "}
                    S·ªßi b·ªçt kh√≠
                  </div>
                  <div className="p-2 bg-slate-50 dark:bg-slate-700/50 rounded flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-orange-500"></span>{" "}
                    T·ªèa/Thu nhi·ªát
                  </div>
                </div>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div className="p-3 bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-100 dark:border-red-800">
                  <div className="font-bold text-red-500 text-sm mb-1">
                    üî• T·ªèa nhi·ªát
                  </div>
                  <div className="text-xs text-slate-600 dark:text-slate-300">
                    N√≥ng l√™n (VD: ƒê·ªët than, gas)
                  </div>
                </div>
                <div className="p-3 bg-cyan-50 dark:bg-cyan-900/20 rounded-xl border border-cyan-100 dark:border-cyan-800">
                  <div className="font-bold text-cyan-500 text-sm mb-1">
                    ‚ùÑÔ∏è Thu nhi·ªát
                  </div>
                  <div className="text-xs text-slate-600 dark:text-slate-300">
                    L·∫°nh ƒëi / C·∫ßn nhi·ªát (VD: Nung ƒë√° v√¥i)
                  </div>
                </div>
              </div>
            </div>
          ),
        },
        {
          id: 3,
          title: "III. ƒêL B·∫£o to√†n KL",
          icon: "scale",
          color: "green",
          content: (
            <div className="flex flex-col items-center text-center space-y-6">
              <motion.div
                animate={{ rotate: [0, 5, -5, 0] }}
                transition={{ duration: 2, repeat: Infinity, repeatDelay: 3 }}
                className="p-6 bg-green-50 dark:bg-green-900/20 rounded-full border-4 border-green-200 dark:border-green-800"
              >
                <i data-lucide="scale" className="w-12 h-12 text-green-600"></i>
              </motion.div>
              <div>
                <div className="text-2xl font-display font-bold text-green-600 mb-2">
                  ‚àëm<sub>tr∆∞·ªõc</sub> = ‚àëm<sub>sau</sub>
                </div>
                <p className="text-sm text-slate-600 dark:text-slate-300 max-w-md mx-auto">
                  "Trong ph·∫£n ·ª©ng h√≥a h·ªçc, t·ªïng kh·ªëi l∆∞·ª£ng c√°c ch·∫•t tham gia
                  b·∫±ng t·ªïng kh·ªëi l∆∞·ª£ng c√°c ch·∫•t s·∫£n ph·∫©m."
                </p>
              </div>
              <div className="w-full bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm text-left border border-slate-100 dark:border-slate-700">
                <h4 className="font-bold text-sm mb-2 text-primary">
                  Ph∆∞∆°ng tr√¨nh H√≥a h·ªçc (PTHH)
                </h4>
                <p className="text-xs mb-3 text-slate-500">
                  Bi·ªÉu di·ªÖn b·∫±ng c√¥ng th·ª©c v√† h·ªá s·ªë c√¢n b·∫±ng.
                </p>
                <div className="flex justify-center items-center gap-2 font-mono font-bold text-lg">
                  <span className="text-blue-500">2H‚ÇÇ</span>
                  <span className="text-slate-400">+</span>
                  <span className="text-red-500">O‚ÇÇ</span>
                  <span className="text-slate-400">‚Üí</span>
                  <span className="text-purple-500">2H‚ÇÇO</span>
                </div>
              </div>
            </div>
          ),
        },
        {
          id: 4,
          title: "IV. Mol & T·ªâ kh·ªëi",
          icon: "box",
          color: "orange",
          content: (
            <div className="space-y-4">
              <div className="grid grid-cols-2 gap-3">
                <div className="bg-orange-50 dark:bg-orange-900/20 p-3 rounded-xl border border-orange-200 dark:border-orange-800">
                  <div className="text-xs uppercase text-slate-500 mb-1">
                    S·ªë Avogadro (N)
                  </div>
                  <div className="font-bold text-orange-600 text-lg">
                    6,022 √ó 10¬≤¬≥
                  </div>
                  <div className="text-xs text-slate-600 dark:text-slate-400">
                    h·∫°t/mol
                  </div>
                </div>
                <div className="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-200 dark:border-blue-800">
                  <div className="text-xs uppercase text-slate-500 mb-1">
                    Th·ªÉ t√≠ch kh√≠ (ƒëkc)
                  </div>
                  <div className="font-bold text-blue-600 text-lg">24,79</div>
                  <div className="text-xs text-slate-600 dark:text-slate-400">
                    L√≠t (25¬∞C, 1 bar)
                  </div>
                </div>
              </div>

              <div className="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm space-y-3 border border-slate-100 dark:border-slate-700">
                <h4 className="font-bold text-sm text-slate-500 uppercase">
                  C√¥ng th·ª©c c·∫ßn nh·ªõ
                </h4>

                <div className="flex justify-between items-center p-2 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                  <span className="text-sm">T·ª´ Kh·ªëi l∆∞·ª£ng (m)</span>
                  <code className="font-mono font-bold text-primary">
                    n = m / M
                  </code>
                </div>

                <div className="flex justify-between items-center p-2 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                  <span className="text-sm">T·ª´ Th·ªÉ t√≠ch kh√≠ (V)</span>
                  <code className="font-mono font-bold text-secondary">
                    n = V / 24,79
                  </code>
                </div>

                <div className="flex justify-between items-center p-2 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                  <span className="text-sm">T·ªâ kh·ªëi h∆°i (d)</span>
                  <code className="font-mono font-bold text-accent">
                    d<sub>A/B</sub> = M<sub>A</sub> / M<sub>B</sub>
                  </code>
                </div>
              </div>
              <div className="text-xs text-center italic text-slate-400">
                (M: Kh·ªëi l∆∞·ª£ng mol, ƒë∆°n v·ªã g/mol)
              </div>
            </div>
          ),
        },
        {
          id: 5,
          title: "V. T√≠nh theo PTHH",
          icon: "calculator",
          color: "pink",
          content: (
            <div className="space-y-4">
              <div className="text-center">
                <h3 className="font-bold text-lg text-primary">
                  Quy tr√¨nh 3 b∆∞·ªõc
                </h3>
                <p className="text-xs text-slate-500">
                  ƒê·ªÉ gi·∫£i b√†i to√°n h√≥a h·ªçc c∆° b·∫£n
                </p>
              </div>

              <div className="space-y-2 relative">
                {/* Connecting Line */}
                <div className="absolute left-[19px] top-4 bottom-4 w-0.5 bg-slate-200 dark:bg-slate-700"></div>

                <div className="relative flex items-center gap-3 p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 z-10">
                  <div className="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold shrink-0 shadow-lg shadow-blue-500/30">
                    1
                  </div>
                  <div className="text-sm">
                    <strong>Vi·∫øt PTHH:</strong> Vi·∫øt v√† c√¢n b·∫±ng ph∆∞∆°ng tr√¨nh.
                  </div>
                </div>

                <div className="relative flex items-center gap-3 p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 z-10">
                  <div className="w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold shrink-0 shadow-lg shadow-purple-500/30">
                    2
                  </div>
                  <div className="text-sm">
                    <strong>T√≠nh s·ªë Mol:</strong> ƒê·ªïi d·ªØ ki·ªán (m, V) ra s·ªë mol
                    (n).
                  </div>
                </div>

                <div className="relative flex items-center gap-3 p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 z-10">
                  <div className="w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center font-bold shrink-0 shadow-lg shadow-green-500/30">
                    3
                  </div>
                  <div className="text-sm">
                    <strong>T√≠nh to√°n:</strong> D√πng t·ªâ l·ªá PTHH suy ra mol ch·∫•t
                    c·∫ßn t√¨m ‚Üí ƒê·ªïi ra m ho·∫∑c V.
                  </div>
                </div>
              </div>

              <div className="p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-xl border border-yellow-200 dark:border-yellow-800 text-center">
                <div className="font-bold text-yellow-700 dark:text-yellow-500 text-sm mb-1 uppercase tracking-wider">
                  Hi·ªáu su·∫•t (H%)
                </div>
                <div className="font-mono text-lg font-bold text-slate-800 dark:text-white">
                  H% = (m<sub>tt</sub> / m<sub>lt</sub>) √ó 100%
                </div>
                <div className="text-[10px] text-slate-500 mt-1">
                  tt: th·ª±c t·∫ø thu ƒë∆∞·ª£c | lt: l√Ω thuy·∫øt t√≠nh to√°n
                </div>
              </div>
            </div>
          ),
        },
        {
          id: 6,
          title: "VI. N·ªìng ƒë·ªô DD",
          icon: "droplet",
          color: "teal",
          content: (
            <div className="space-y-4">
              <div className="bg-teal-50 dark:bg-teal-900/20 p-4 rounded-xl border border-teal-200 dark:border-teal-800">
                <h3 className="font-bold text-teal-700 dark:text-teal-400 mb-2 flex items-center gap-2">
                  <i data-lucide="maximize" className="w-4 h-4"></i> ƒê·ªô tan (S)
                </h3>
                <p className="text-sm text-slate-700 dark:text-slate-300">
                  S·ªë gam ch·∫•t tan t·ªëi ƒëa trong <strong>100g n∆∞·ªõc</strong> ƒë·ªÉ t·∫°o
                  dung d·ªãch b√£o h√≤a ·ªü nhi·ªát ƒë·ªô x√°c ƒë·ªãnh.
                </p>
              </div>

              <div className="grid grid-cols-1 gap-3">
                <div className="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border-l-4 border-blue-500">
                  <h3 className="font-bold text-blue-600 mb-1">
                    N·ªìng ƒë·ªô Mol (C<sub>M</sub>)
                  </h3>
                  <div className="flex items-center justify-between">
                    <div className="font-mono text-2xl font-bold">
                      C<sub>M</sub> = n / V
                    </div>
                    <div className="text-right text-xs text-slate-500">
                      n: s·ªë mol (mol)
                      <br />
                      V: th·ªÉ t√≠ch dd (l√≠t)
                    </div>
                  </div>
                </div>

                <div className="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border-l-4 border-pink-500">
                  <h3 className="font-bold text-pink-600 mb-1">
                    N·ªìng ƒë·ªô % (C%)
                  </h3>
                  <div className="flex items-center justify-between">
                    <div className="font-mono text-xl font-bold flex items-center gap-2">
                      C% ={" "}
                      <div className="flex flex-col text-center text-sm leading-none">
                        <span>
                          m<sub>ct</sub>
                        </span>
                        <span className="border-t border-slate-400 w-full block pt-0.5">
                          m<sub>dd</sub>
                        </span>
                      </div>{" "}
                      √ó 100
                    </div>
                    <div className="text-right text-xs text-slate-500">
                      m<sub>dd</sub> = m<sub>ct</sub> + m<sub>dm</sub>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          ),
        },
        {
          id: 7,
          title: "VII. T·ªëc ƒë·ªô P∆Ø",
          icon: "zap",
          color: "red",
          content: (
            <div className="space-y-4">
              <p className="text-sm italic text-center text-slate-500">
                "T·ªëc ƒë·ªô ph·∫£n ·ª©ng l√† ƒë·ªô bi·∫øn thi√™n n·ªìng ƒë·ªô ch·∫•t trong m·ªôt ƒë∆°n v·ªã
                th·ªùi gian."
              </p>

              <div className="space-y-2">
                <h4 className="font-bold text-xs uppercase text-slate-400 mb-2">
                  C√°c y·∫øu t·ªë l√†m tƒÉng t·ªëc ƒë·ªô
                </h4>
                <div className="grid grid-cols-2 gap-3">
                  <div className="p-3 bg-red-50 dark:bg-red-900/20 rounded-xl text-center border border-red-100 dark:border-red-800 card-hover transition-all">
                    <i
                      data-lucide="thermometer"
                      className="w-6 h-6 mx-auto mb-2 text-red-500"
                    ></i>
                    <span className="block font-bold text-sm text-slate-700 dark:text-slate-200">
                      Nhi·ªát ƒë·ªô ‚Üë
                    </span>
                  </div>
                  <div className="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl text-center border border-blue-100 dark:border-blue-800 card-hover transition-all">
                    <i
                      data-lucide="beaker"
                      className="w-6 h-6 mx-auto mb-2 text-blue-500"
                    ></i>
                    <span className="block font-bold text-sm text-slate-700 dark:text-slate-200">
                      N·ªìng ƒë·ªô ‚Üë
                    </span>
                  </div>
                  <div className="p-3 bg-green-50 dark:bg-green-900/20 rounded-xl text-center border border-green-100 dark:border-green-800 card-hover transition-all">
                    <i
                      data-lucide="expand"
                      className="w-6 h-6 mx-auto mb-2 text-green-500"
                    ></i>
                    <span className="block font-bold text-sm text-slate-700 dark:text-slate-200">
                      Di·ªán t√≠ch b·ªÅ m·∫∑t ‚Üë
                    </span>
                  </div>
                  <div className="p-3 bg-purple-50 dark:bg-purple-900/20 rounded-xl text-center border border-purple-100 dark:border-purple-800 card-hover transition-all">
                    <i
                      data-lucide="wand-2"
                      className="w-6 h-6 mx-auto mb-2 text-purple-500"
                    ></i>
                    <span className="block font-bold text-sm text-slate-700 dark:text-slate-200">
                      Ch·∫•t x√∫c t√°c
                    </span>
                  </div>
                </div>
              </div>
              <div className="text-xs text-slate-500 bg-slate-100 dark:bg-slate-800 p-2 rounded">
                * Ch·∫•t x√∫c t√°c l√†m tƒÉng t·ªëc ƒë·ªô ph·∫£n ·ª©ng nh∆∞ng kh√¥ng b·ªã ti√™u hao
                sau ph·∫£n ·ª©ng.
              </div>
            </div>
          ),
        },
      ];

      // --- LAB COMPONENTS ---

      // 1. Classification Game
      const LabClassification = () => {
        const [items, setItems] = useState([
          { id: 1, text: "N∆∞·ªõc ƒë√≥ng bƒÉng ‚ùÑÔ∏è", type: "vl" },
          { id: 2, text: "Fe + O‚ÇÇ (G·ªâ s·∫Øt) üî©", type: "hh" },
          { id: 3, text: "X√© gi·∫•y v·ª•n üìÑ", type: "vl" },
          { id: 4, text: "ƒê·ªët ch√°y than üî•", type: "hh" },
          { id: 5, text: "D√°t m·ªèng nh√¥m üî®", type: "vl" },
          { id: 6, text: "Nung ƒë√° v√¥i (CaCO‚ÇÉ) ‚õ∞Ô∏è", type: "hh" },
        ]);
        const [score, setScore] = useState(0);

        const handleClassify = (item, choice) => {
          if (item.type === choice) {
            setScore((s) => s + 1);
            confetti({
              particleCount: 30,
              spread: 50,
              origin: { y: 0.7 },
              colors: choice === "vl" ? ["#3b82f6"] : ["#8b5cf6"],
            });
          }
          setItems((prev) => prev.filter((i) => i.id !== item.id));
        };

        const currentItem = items[0];

        return (
          <div className="flex flex-col items-center justify-center h-full p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
            <h3 className="font-bold text-lg mb-1 text-primary flex items-center gap-2">
              <i data-lucide="gamepad-2" className="w-5 h-5"></i> Ph√¢n lo·∫°i Bi·∫øn
              ƒë·ªïi
            </h3>
            <div className="text-xs text-slate-400 mb-4">
              Ch·ªçn V·∫≠t l√≠ ho·∫∑c H√≥a h·ªçc
            </div>

            <div className="mb-4 font-bold text-2xl text-accent">{score}/6</div>

            <div className="w-full max-w-sm h-48 flex flex-col justify-center relative">
              <AnimatePresence mode="wait">
                {currentItem ? (
                  <motion.div
                    key={currentItem.id}
                    initial={{ scale: 0.8, opacity: 0, y: 20 }}
                    animate={{ scale: 1, opacity: 1, y: 0 }}
                    exit={{ scale: 0.8, opacity: 0, y: -20 }}
                    className="absolute inset-0 m-auto h-32 w-full bg-slate-100 dark:bg-slate-700 rounded-2xl shadow-inner flex items-center justify-center p-4 text-center"
                  >
                    <span className="text-xl font-bold text-slate-700 dark:text-white">
                      {currentItem.text}
                    </span>
                  </motion.div>
                ) : (
                  <motion.div
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    className="text-center w-full"
                  >
                    <div className="text-5xl mb-2">üéâ</div>
                    <p className="font-bold">Ho√†n th√†nh!</p>
                    <button
                      onClick={() => window.location.reload()}
                      className="mt-4 px-4 py-2 bg-slate-200 dark:bg-slate-600 rounded-lg text-sm font-bold hover:bg-slate-300 transition"
                    >
                      Ch∆°i l·∫°i
                    </button>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            {currentItem && (
              <div className="grid grid-cols-2 gap-4 w-full max-w-sm mt-4">
                <button
                  onClick={() => handleClassify(currentItem, "vl")}
                  className="p-4 bg-blue-500 text-white rounded-xl font-bold hover:bg-blue-600 shadow-lg active:scale-95 transition flex flex-col items-center"
                >
                  <span className="text-xs opacity-70 mb-1">TR·∫†NG TH√ÅI</span>
                  V·∫¨T L√ç
                </button>
                <button
                  onClick={() => handleClassify(currentItem, "hh")}
                  className="p-4 bg-purple-500 text-white rounded-xl font-bold hover:bg-purple-600 shadow-lg active:scale-95 transition flex flex-col items-center"
                >
                  <span className="text-xs opacity-70 mb-1">CH·∫§T M·ªöI</span>
                  H√ìA H·ªåC
                </button>
              </div>
            )}
          </div>
        );
      };

      // 2. Gas Volume Lab
      const LabGas = () => {
        const [mol, setMol] = useState(1);
        return (
          <div className="flex flex-col items-center h-full p-6 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
            <h3 className="font-bold text-lg mb-2 text-blue-500 flex items-center gap-2">
              <i data-lucide="wind" className="w-5 h-5"></i> Th·ªÉ t√≠ch Kh√≠ (ƒëkc)
            </h3>
            <div className="text-xs text-slate-400 mb-6 text-center">
              ·ªû ƒëi·ªÅu ki·ªán chu·∫©n (25¬∞C, 1 bar), 1 mol kh√≠ b·∫•t k·ª≥ chi·∫øm 24,79 L√≠t
            </div>

            <div className="flex-1 flex items-end justify-center relative w-full mb-8">
              {/* Balloon */}
              <motion.div
                className="bg-gradient-to-tr from-blue-400 to-blue-300 opacity-90 border-2 border-blue-500 rounded-[50%_50%_50%_50%_/_40%_40%_60%_60%] flex items-center justify-center text-white font-bold text-sm shadow-[0_10px_30px_rgba(59,130,246,0.4)] relative z-10"
                animate={{
                  width: Math.max(60, Math.sqrt(mol) * 120),
                  height: Math.max(70, Math.sqrt(mol) * 130),
                  y: [0, -10, 0],
                }}
                transition={{
                  y: { duration: 3, repeat: Infinity, ease: "easeInOut" },
                }}
              >
                <span className="drop-shadow-md">
                  {(mol * 24.79).toFixed(1)} L
                </span>
              </motion.div>
              {/* String */}
              <div className="absolute bottom-[-20px] w-0.5 h-20 bg-slate-400 z-0"></div>
            </div>

            <div className="w-full max-w-md bg-slate-50 dark:bg-slate-900 p-5 rounded-xl border border-slate-100 dark:border-slate-800">
              <div className="flex justify-between mb-4 text-sm">
                <span className="font-bold text-slate-700 dark:text-slate-200">
                  S·ªë mol (n) = {mol}
                </span>
                <span className="font-mono text-blue-500 font-bold">
                  V = n √ó 24,79
                </span>
              </div>
              <input
                type="range"
                min="0.1"
                max="5"
                step="0.1"
                value={mol}
                onChange={(e) => setMol(parseFloat(e.target.value))}
                className="w-full accent-blue-500 h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer"
              />
              <div className="flex justify-between text-xs text-slate-400 mt-2">
                <span>0.1 mol</span>
                <span>5 mol</span>
              </div>
            </div>
          </div>
        );
      };

      // 3. Concentration Lab
      const LabConcentration = () => {
        const [solute, setSolute] = useState(10);
        const [solvent, setSolvent] = useState(100);

        const cPercent = (solute / (solute + solvent)) * 100;
        // Visual opacity logic
        const opacity = Math.min(Math.max(cPercent / 40, 0.05), 1);

        return (
          <div className="flex flex-col items-center h-full p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
            <h3 className="font-bold text-lg mb-2 text-teal-600 flex items-center gap-2">
              <i data-lucide="flask-round" className="w-5 h-5"></i> Pha ch·∫ø (C%)
            </h3>

            <div className="relative w-40 h-52 border-4 border-t-0 border-slate-300 dark:border-slate-600 rounded-b-3xl mb-6 bg-slate-50 dark:bg-slate-900 overflow-hidden shadow-inner">
              {/* Water Level */}
              <motion.div
                className="absolute bottom-0 left-0 right-0 bg-blue-100/50 dark:bg-blue-900/30 transition-all duration-500 border-t border-blue-200/50"
                style={{ height: `${(solvent / 300) * 100}%` }}
              />
              {/* Solution Color Overlay */}
              <motion.div
                className="absolute bottom-0 left-0 right-0 bg-teal-500 mix-blend-multiply transition-all duration-500"
                style={{
                  height: `${((solvent + solute) / 300) * 100}%`,
                  opacity: opacity,
                }}
              />
              {/* Labels */}
              <div className="absolute top-1/2 left-0 right-0 text-center pointer-events-none">
                <span className="bg-white/80 dark:bg-black/60 px-2 py-1 rounded text-xs font-bold backdrop-blur-sm">
                  {cPercent.toFixed(1)}%
                </span>
              </div>

              {/* Bubbles animation */}
              <div className="absolute bottom-0 w-full h-full overflow-hidden pointer-events-none">
                {Array.from({ length: Math.floor(solute / 5) }).map((_, i) => (
                  <motion.div
                    key={i}
                    className="absolute bg-white/40 rounded-full w-1 h-1"
                    initial={{
                      bottom: 0,
                      left: `${Math.random() * 100}%`,
                      opacity: 0,
                    }}
                    animate={{
                      bottom: `${Math.random() * 100}%`,
                      opacity: [0, 1, 0],
                    }}
                    transition={{
                      duration: 2 + Math.random() * 2,
                      repeat: Infinity,
                      delay: Math.random() * 2,
                    }}
                  />
                ))}
              </div>
            </div>

            <div className="grid grid-cols-2 gap-4 w-full">
              <div className="bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-800">
                <div className="text-[10px] uppercase text-slate-500 font-bold mb-2">
                  Ch·∫•t tan (Mu·ªëi)
                </div>
                <div className="text-xl font-bold mb-2 text-teal-600">
                  {solute} g
                </div>
                <input
                  type="range"
                  min="0"
                  max="100"
                  step="5"
                  value={solute}
                  onChange={(e) => setSolute(Number(e.target.value))}
                  className="w-full accent-teal-500 h-1.5 bg-slate-200 rounded cursor-pointer"
                />
              </div>
              <div className="bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-800">
                <div className="text-[10px] uppercase text-slate-500 font-bold mb-2">
                  Dung m√¥i (N∆∞·ªõc)
                </div>
                <div className="text-xl font-bold mb-2 text-blue-500">
                  {solvent} g
                </div>
                <input
                  type="range"
                  min="50"
                  max="200"
                  step="10"
                  value={solvent}
                  onChange={(e) => setSolvent(Number(e.target.value))}
                  className="w-full accent-blue-500 h-1.5 bg-slate-200 rounded cursor-pointer"
                />
              </div>
            </div>
          </div>
        );
      };

      // 4. Speed Lab (Particles)
      const LabSpeed = () => {
        const canvasRef = useRef(null);
        const [temp, setTemp] = useState(25); // Celsius
        const [conc, setConc] = useState(30); // Number of particles

        useEffect(() => {
          const canvas = canvasRef.current;
          const ctx = canvas.getContext("2d");
          let animationId;

          // Initialize particles
          let particles = Array.from({ length: conc }, () => ({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            vx: Math.random() - 0.5,
            vy: Math.random() - 0.5,
            r: 2 + Math.random() * 2,
            color: Math.random() > 0.5 ? "#ef4444" : "#3b82f6", // Reactants A and B
          }));

          const animate = () => {
            // Clear with trail effect
            ctx.fillStyle = document.documentElement.classList.contains("dark")
              ? "rgba(15, 23, 42, 0.3)"
              : "rgba(248, 250, 252, 0.3)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach((p) => {
              // Speed depends on temperature
              const speedMultiplier = (temp + 20) / 30;

              p.x += p.vx * speedMultiplier;
              p.y += p.vy * speedMultiplier;

              // Bounce
              if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
              if (p.y < 0 || p.y > canvas.height) p.vy *= -1;

              ctx.beginPath();
              ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
              ctx.fillStyle = p.color;
              ctx.fill();
            });

            animationId = requestAnimationFrame(animate);
          };

          animate();
          return () => cancelAnimationFrame(animationId);
        }, [temp, conc]);

        return (
          <div className="flex flex-col h-full p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
            <h3 className="font-bold mb-2 text-red-500 flex items-center gap-2">
              <i data-lucide="zap" className="w-5 h-5"></i> Y·∫øu t·ªë T·ªëc ƒë·ªô
            </h3>

            <div className="flex-1 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden mb-4 relative bg-slate-50 dark:bg-slate-900 shadow-inner">
              <canvas
                ref={canvasRef}
                width={320}
                height={200}
                className="w-full h-full object-cover"
              />
              <div className="absolute top-2 right-2 bg-black/60 backdrop-blur-md text-white text-[10px] px-2 py-1 rounded border border-white/10">
                T = {temp}¬∞C | N = {conc}
              </div>
            </div>

            <div className="space-y-4">
              <div className="bg-slate-50 dark:bg-slate-900 p-3 rounded-lg">
                <div className="flex justify-between text-xs mb-2 font-bold text-slate-600 dark:text-slate-300">
                  <span className="flex items-center gap-1">
                    <i data-lucide="thermometer" className="w-3 h-3"></i> Nhi·ªát
                    ƒë·ªô
                  </span>
                  <span>{temp}¬∞C</span>
                </div>
                <input
                  type="range"
                  min="0"
                  max="100"
                  value={temp}
                  onChange={(e) => setTemp(Number(e.target.value))}
                  className="w-full accent-red-500 h-1.5 bg-slate-200 rounded cursor-pointer"
                />
              </div>
              <div className="bg-slate-50 dark:bg-slate-900 p-3 rounded-lg">
                <div className="flex justify-between text-xs mb-2 font-bold text-slate-600 dark:text-slate-300">
                  <span className="flex items-center gap-1">
                    <i data-lucide="beaker" className="w-3 h-3"></i> N·ªìng ƒë·ªô
                  </span>
                  <span>{conc} h·∫°t</span>
                </div>
                <input
                  type="range"
                  min="10"
                  max="100"
                  value={conc}
                  onChange={(e) => setConc(Number(e.target.value))}
                  className="w-full accent-blue-500 h-1.5 bg-slate-200 rounded cursor-pointer"
                />
              </div>
            </div>
          </div>
        );
      };

      // --- QUIZ COMPONENT ---
      const QuizSection = () => {
        const QUESTIONS = [
          {
            q: "Cho 2 mol H‚ÇÇ ph·∫£n ·ª©ng ho√†n to√†n v·ªõi O‚ÇÇ. T√≠nh s·ªë mol H‚ÇÇO thu ƒë∆∞·ª£c theo PTHH: 2H‚ÇÇ + O‚ÇÇ ‚Üí 2H‚ÇÇO?",
            opts: ["1 mol", "2 mol", "4 mol", "0.5 mol"],
            a: 1, // 2 mol H2 creates 2 mol H2O
            explain: "T·ªâ l·ªá ph·∫£n ·ª©ng l√† 2:1:2. V·∫≠y 2 mol H‚ÇÇ t·∫°o ra 2 mol H‚ÇÇO.",
          },
          {
            q: "Hi·ªán t∆∞·ª£ng n√†o sau ƒë√¢y l√† bi·∫øn ƒë·ªïi h√≥a h·ªçc?",
            opts: [
              "H√≤a tan mu·ªëi v√†o n∆∞·ªõc",
              "N∆∞·ªõc h√≥a h∆°i",
              "S·∫Øt b·ªã g·ªâ trong kh√¥ng kh√≠",
              "D√¢y t√≥c b√≥ng ƒë√®n n√≥ng s√°ng",
            ],
            a: 2,
            explain:
              "S·∫Øt b·ªã g·ªâ t·∫°o ra ch·∫•t m·ªõi (Oxit s·∫Øt), c√°c hi·ªán t∆∞·ª£ng c√≤n l·∫°i ch·ªâ l√† v·∫≠t l√≠.",
          },
          {
            q: "ƒê·ªÉ ƒë·ªët ch√°y ho√†n to√†n 1 mol Cacbon (C) sinh ra CO‚ÇÇ, c·∫ßn bao nhi√™u l√≠t kh√≠ O‚ÇÇ (ƒëkc)?",
            opts: ["24,79 L", "49,58 L", "12,39 L", "22,4 L"],
            a: 0,
            explain:
              "C + O‚ÇÇ ‚Üí CO‚ÇÇ. T·ªâ l·ªá 1:1. 1 mol C c·∫ßn 1 mol O‚ÇÇ. V = 1 √ó 24,79 = 24,79 L√≠t.",
          },
          {
            q: "H√≤a tan 20g ƒë∆∞·ªùng v√†o 180g n∆∞·ªõc. T√≠nh n·ªìng ƒë·ªô ph·∫ßn trƒÉm (C%) c·ªßa dung d·ªãch?",
            opts: ["11,1%", "10%", "20%", "9%"],
            a: 1,
            explain: "m_dd = 20 + 180 = 200g. C% = (20/200)*100 = 10%.",
          },
          {
            q: "Y·∫øu t·ªë n√†o sau ƒë√¢y KH√îNG l√†m tƒÉng t·ªëc ƒë·ªô ph·∫£n ·ª©ng?",
            opts: [
              "TƒÉng nhi·ªát ƒë·ªô",
              "TƒÉng di·ªán t√≠ch b·ªÅ m·∫∑t",
              "D√πng ch·∫•t x√∫c t√°c",
              "Gi·∫£m n·ªìng ƒë·ªô ch·∫•t ph·∫£n ·ª©ng",
            ],
            a: 3,
            explain:
              "Gi·∫£m n·ªìng ƒë·ªô l√†m GI·∫¢M s·ªë va ch·∫°m gi·ªØa c√°c h·∫°t ‚Üí Gi·∫£m t·ªëc ƒë·ªô ph·∫£n ·ª©ng.",
          },
        ];

        const [current, setCurrent] = useState(0);
        const [finished, setFinished] = useState(false);
        const [score, setScore] = useState(0);
        const [showExplain, setShowExplain] = useState(false);
        const [selected, setSelected] = useState(null);

        const handleAnswer = (idx) => {
          setSelected(idx);
          setShowExplain(true);

          if (idx === QUESTIONS[current].a) {
            setScore((s) => s + 1);
            confetti({
              particleCount: 50,
              spread: 60,
              origin: { y: 0.8 },
              colors: ["#10b981"],
            });
          }
        };

        const nextQuestion = () => {
          setSelected(null);
          setShowExplain(false);
          if (current < QUESTIONS.length - 1) {
            setCurrent((c) => c + 1);
          } else {
            setFinished(true);
          }
        };

        if (finished)
          return (
            <div className="h-full flex flex-col items-center justify-center text-center p-6 space-y-6 animate-in fade-in zoom-in duration-300">
              <div className="w-24 h-24 bg-yellow-100 rounded-full flex items-center justify-center border-4 border-yellow-300">
                <span className="text-6xl">üèÜ</span>
              </div>
              <div>
                <h2 className="text-2xl font-bold mb-1 text-slate-800 dark:text-white">
                  Ho√†n th√†nh xu·∫•t s·∫Øc!
                </h2>
                <p className="text-slate-500">ƒêi·ªÉm s·ªë c·ªßa b·∫°n</p>
              </div>
              <div className="text-5xl font-display font-bold text-primary">
                {score} / {QUESTIONS.length}
              </div>

              <button
                onClick={() => {
                  setFinished(false);
                  setCurrent(0);
                  setScore(0);
                }}
                className="px-8 py-3 bg-primary text-white rounded-xl font-bold shadow-lg hover:bg-blue-600 active:scale-95 transition flex items-center gap-2"
              >
                <i data-lucide="rotate-ccw" className="w-5 h-5"></i> L√†m l·∫°i
              </button>
            </div>
          );

        return (
          <div className="h-full flex flex-col p-4 max-w-2xl mx-auto justify-center">
            <div className="mb-6 flex justify-between items-center text-sm font-bold text-slate-400">
              <span className="bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded-full">
                C√¢u {current + 1} / {QUESTIONS.length}
              </span>
              <span className="text-primary">ƒêi·ªÉm: {score}</span>
            </div>

            <div className="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-100 dark:border-slate-700 mb-6 min-h-[120px] flex items-center">
              <h3 className="text-lg font-bold text-slate-800 dark:text-white leading-relaxed">
                {QUESTIONS[current].q}
              </h3>
            </div>

            <div className="grid grid-cols-1 gap-3 mb-6">
              {QUESTIONS[current].opts.map((opt, idx) => {
                let baseClass =
                  "p-4 rounded-xl border-2 text-left transition font-medium relative overflow-hidden ";
                if (selected === null) {
                  baseClass +=
                    "border-slate-200 dark:border-slate-700 hover:border-primary hover:bg-blue-50 dark:hover:bg-slate-700 cursor-pointer";
                } else {
                  if (idx === QUESTIONS[current].a)
                    baseClass +=
                      "border-green-500 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400";
                  else if (idx === selected)
                    baseClass +=
                      "border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400";
                  else
                    baseClass +=
                      "border-slate-200 dark:border-slate-700 opacity-50";
                }

                return (
                  <button
                    key={idx}
                    onClick={() => !selected && handleAnswer(idx)}
                    className={baseClass}
                    disabled={selected !== null}
                  >
                    {opt}
                    {selected !== null && idx === QUESTIONS[current].a && (
                      <i
                        data-lucide="check-circle"
                        className="absolute right-4 top-4 text-green-500 w-5 h-5"
                      ></i>
                    )}
                  </button>
                );
              })}
            </div>

            {showExplain && (
              <motion.div
                initial={{ opacity: 0, y: 10 }}
                animate={{ opacity: 1, y: 0 }}
                className="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800 mb-4"
              >
                <p className="text-sm text-blue-800 dark:text-blue-300">
                  <strong>üí° Gi·∫£i th√≠ch:</strong> {QUESTIONS[current].explain}
                </p>
              </motion.div>
            )}

            {selected !== null && (
              <button
                onClick={nextQuestion}
                className="w-full py-3 bg-primary text-white rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center justify-center gap-2 animate-in slide-in-from-bottom-2"
              >
                {current === QUESTIONS.length - 1
                  ? "Xem k·∫øt qu·∫£"
                  : "C√¢u ti·∫øp theo"}{" "}
                <i data-lucide="arrow-right" className="w-5 h-5"></i>
              </button>
            )}
          </div>
        );
      };

      // --- MAIN APP ---
      const App = () => {
        const [tab, setTab] = useState("theory"); // theory, lab, quiz
        const [darkMode, setDarkMode] = useState(false);
        const [selectedLesson, setSelectedLesson] = useState(null); // New state for modal

        useEffect(() => {
          if (darkMode) document.documentElement.classList.add("dark");
          else document.documentElement.classList.remove("dark");
          createIcons();
        }, [darkMode, tab, selectedLesson]);

        const renderContent = () => {
          if (tab === "theory") {
            return (
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 overflow-y-auto h-full pb-24 custom-scrollbar">
                {LESSONS.map((lesson, index) => (
                  <motion.div
                    key={lesson.id}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: index * 0.05 }}
                    onClick={() => setSelectedLesson(lesson)} // Make clickable
                    className="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden flex flex-col hover:shadow-lg transition-all cursor-pointer group hover:border-blue-300 dark:hover:border-blue-700"
                  >
                    <div
                      className={`p-4 border-b border-slate-100 dark:border-slate-700 flex items-center gap-3 bg-gradient-to-r from-slate-50 to-white dark:from-slate-700 dark:to-slate-800 group-hover:from-blue-50 dark:group-hover:from-blue-900/30 transition-colors`}
                    >
                      <div
                        className={`p-2 rounded-lg shadow-sm bg-white dark:bg-slate-600 text-${lesson.color}-500`}
                      >
                        <i data-lucide={lesson.icon} className="w-5 h-5"></i>
                      </div>
                      <h3 className="font-bold text-slate-700 dark:text-slate-200 truncate">
                        {lesson.title}
                      </h3>
                      <div className="ml-auto opacity-0 group-hover:opacity-100 transition-opacity">
                        <i
                          data-lucide="maximize-2"
                          className="w-4 h-4 text-blue-400"
                        ></i>
                      </div>
                    </div>
                    <div className="p-4 text-slate-600 dark:text-slate-300 flex-1 text-sm leading-relaxed relative">
                      {/* Truncate content visually with mask */}
                      <div className="max-h-[150px] overflow-hidden relative">
                        {lesson.content}
                        <div className="absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-white dark:from-slate-800 to-transparent"></div>
                      </div>
                      <div className="mt-2 text-center text-xs font-bold text-blue-500 uppercase tracking-wide">
                        B·∫•m ƒë·ªÉ xem chi ti·∫øt
                      </div>
                    </div>
                  </motion.div>
                ))}
              </div>
            );
          }
          if (tab === "lab") {
            return (
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 overflow-y-auto h-full pb-24 custom-scrollbar">
                <LabClassification />
                <LabGas />
                <LabConcentration />
                <LabSpeed />
              </div>
            );
          }
          if (tab === "quiz") return <QuizSection />;
        };

        return (
          <div className="h-full flex flex-col bg-bg-light dark:bg-bg-dark transition-colors">
            {/* LESSON MODAL */}
            <AnimatePresence>
              {selectedLesson && (
                <motion.div
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  exit={{ opacity: 0 }}
                  className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm"
                  onClick={() => setSelectedLesson(null)}
                >
                  <motion.div
                    initial={{ scale: 0.9, y: 20 }}
                    animate={{ scale: 1, y: 0 }}
                    exit={{ scale: 0.9, y: 20 }}
                    className="bg-white dark:bg-slate-800 w-full max-w-2xl max-h-[85vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden"
                    onClick={(e) => e.stopPropagation()}
                  >
                    <div className="p-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between bg-slate-50 dark:bg-slate-700/50">
                      <div className="flex items-center gap-3">
                        <div
                          className={`p-2 rounded-lg bg-white dark:bg-slate-600 text-${selectedLesson.color}-500 shadow-sm`}
                        >
                          <i
                            data-lucide={selectedLesson.icon}
                            className="w-5 h-5"
                          ></i>
                        </div>
                        <h2 className="font-bold text-lg text-slate-800 dark:text-white">
                          {selectedLesson.title}
                        </h2>
                      </div>
                      <button
                        onClick={() => setSelectedLesson(null)}
                        className="p-2 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-full transition"
                      >
                        <i
                          data-lucide="x"
                          className="w-5 h-5 text-slate-500"
                        ></i>
                      </button>
                    </div>
                    <div className="p-6 overflow-y-auto modal-scroll text-slate-700 dark:text-slate-300 leading-relaxed text-base">
                      {selectedLesson.content}
                    </div>
                    <div className="p-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/30 flex justify-end">
                      <button
                        onClick={() => setSelectedLesson(null)}
                        className="px-4 py-2 bg-blue-500 text-white rounded-lg font-bold hover:bg-blue-600 transition"
                      >
                        ƒê√£ hi·ªÉu
                      </button>
                    </div>
                  </motion.div>
                </motion.div>
              )}
            </AnimatePresence>

            {/* TOP NAVIGATION BAR */}
            <header className="bg-white/80 dark:bg-slate-800/90 backdrop-blur-md shadow-sm border-b border-slate-200 dark:border-slate-700 z-50 sticky top-0">
              <div className="flex items-center justify-between px-4 h-16 max-w-7xl mx-auto w-full">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/30 transform rotate-3">
                    C8
                  </div>
                  <div>
                    <h1 className="font-display font-bold text-lg text-slate-800 dark:text-white leading-none">
                      H√≥a H·ªçc 8
                    </h1>
                    <span className="text-[10px] text-slate-500 uppercase font-bold tracking-wider">
                      Ch∆∞∆°ng 1: Ph·∫£n ·ª®ng H√≥a H·ªçc
                    </span>
                  </div>
                </div>

                {/* Main Tabs */}
                <nav className="flex gap-1 bg-slate-100 dark:bg-slate-700/50 p-1 rounded-xl">
                  {[
                    { id: "theory", icon: "book-open", label: "L√Ω thuy·∫øt" },
                    { id: "lab", icon: "flask-conical", label: "M√¥ ph·ªèng" },
                    { id: "quiz", icon: "check-circle", label: "B√†i t·∫≠p" },
                  ].map((item) => (
                    <button
                      key={item.id}
                      onClick={() => setTab(item.id)}
                      className={`relative px-3 md:px-5 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 ${
                        tab === item.id
                          ? "text-slate-800 dark:text-white shadow-sm bg-white dark:bg-slate-600"
                          : "text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"
                      }`}
                    >
                      <i
                        data-lucide={item.icon}
                        className={`w-4 h-4 ${
                          tab === item.id ? "text-primary" : ""
                        }`}
                      ></i>
                      <span className="hidden sm:inline">{item.label}</span>
                      {tab === item.id && (
                        <motion.div
                          layoutId="activeTab"
                          className="absolute inset-0 bg-transparent rounded-lg border-2 border-primary/10 dark:border-white/10 pointer-events-none"
                        />
                      )}
                    </button>
                  ))}
                </nav>

                <div className="flex items-center gap-2">
                  <button
                    onClick={() => setDarkMode(!darkMode)}
                    className="p-2.5 text-slate-500 hover:text-orange-500 dark:text-slate-400 dark:hover:text-yellow-400 transition rounded-xl hover:bg-slate-50 dark:hover:bg-slate-700/50"
                  >
                    <i
                      data-lucide={darkMode ? "sun" : "moon"}
                      className="w-5 h-5"
                    ></i>
                  </button>
                  <a
                    href="../chemstudybaby.html"
                    className="p-2.5 text-slate-500 hover:text-red-500 dark:text-slate-400 dark:hover:text-red-400 transition rounded-xl hover:bg-red-50 dark:hover:bg-red-900/20"
                    title="Quay v·ªÅ"
                  >
                    <i data-lucide="log-out" className="w-5 h-5"></i>
                  </a>
                </div>
              </div>
            </header>

            {/* MAIN CONTENT */}
            <main className="flex-1 overflow-hidden relative max-w-7xl mx-auto w-full">
              <AnimatePresence mode="wait">
                <motion.div
                  key={tab}
                  initial={{ opacity: 0, x: 20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: -20 }}
                  transition={{ duration: 0.2 }}
                  className="h-full"
                >
                  {renderContent()}
                </motion.div>
              </AnimatePresence>
            </main>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
