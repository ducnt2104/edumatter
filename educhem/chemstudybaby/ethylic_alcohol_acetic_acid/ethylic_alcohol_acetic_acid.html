<!DOCTYPE html>
<html lang="vi" class="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chuyên Đề 3: Ethanol & Axit Axetic - Hóa Học 9</title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              chemBlue: "#3b82f6",
              chemRed: "#ef4444",
              chemGreen: "#10b981",
              chemAmber: "#f59e0b",
              darkBg: "#0f172a",
              lightBg: "#f8fafc",
            },
          },
        },
      };
    </script>

    <!-- Three.js cho mô hình 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;900&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Be Vietnam Pro", sans-serif;
        transition: background-color 0.3s, color 0.3s;
      }
      .glass-panel {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
      .dark .glass-panel {
        background: rgba(30, 41, 59, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
      }

      /* Navbar Glass */
      .nav-glass {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
      }
      .dark .nav-glass {
        background: rgba(15, 23, 42, 0.9);
        border-bottom: 1px solid rgba(51, 65, 85, 0.5);
      }

      /* Animations */
      @keyframes bubble {
        0% {
          bottom: 0;
          opacity: 0;
          transform: scale(0.5) translateX(0);
        }
        50% {
          opacity: 1;
        }
        100% {
          bottom: 100%;
          opacity: 0;
          transform: scale(1.2) translateX(10px);
        }
      }
      .bubble {
        position: absolute;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        animation: bubble 2s infinite ease-in;
      }

      @keyframes flicker {
        0% {
          transform: scale(1);
          opacity: 0.9;
        }
        50% {
          transform: scale(1.1) skewX(2deg);
          opacity: 1;
        }
        100% {
          transform: scale(0.9) skewX(-2deg);
          opacity: 0.9;
        }
      }
      .flame {
        animation: flicker 0.1s infinite alternate;
        box-shadow: 0 0 20px #3b82f6;
      }

      /* Bacteria Animation */
      @keyframes float {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-5px) rotate(5deg);
        }
      }
      .germ {
        animation: float 3s ease-in-out infinite;
      }
      .germ.dead {
        transition: all 1s;
        opacity: 0;
        transform: scale(0.1);
      }
      .germ.shielded {
        transition: all 0.5s;
        border: 2px solid white;
        background: #555;
        filter: grayscale(100%);
      }

      .tab-content {
        display: none;
        animation: fadeIn 0.4s;
      }
      .tab-content.active {
        display: block;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Scrollbar ẩn cho menu ngang */
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
  </head>
  <body
    class="bg-lightBg text-slate-800 dark:bg-darkBg dark:text-slate-100 min-h-screen flex flex-col"
  >
    <!-- TOP NAVBAR -->
    <nav class="nav-glass sticky top-0 z-50 w-full shadow-md">
      <div class="max-w-7xl mx-auto px-4">
        <div class="flex items-center justify-between h-16">
          <!-- Logo & Back -->
          <div class="flex items-center gap-4 flex-shrink-0">
            <a
              href="../chemstudybaby.html"
              class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition text-slate-500"
              title="Quay lại"
            >
              <i class="fas fa-arrow-left"></i>
            </a>
            <h1
              class="text-xl md:text-2xl font-black bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 hidden md:block"
            >
              Chemstudy baby - HÓA HỌC 9: chủ đề 3: ETHYLIC ALCOHOL & ACETIC
              ACID
            </h1>
          </div>

          <!-- Horizontal Menu -->
          <div
            class="flex-1 overflow-x-auto hide-scrollbar flex items-center justify-center gap-1 md:gap-2 px-4"
          >
            <button
              onclick="switchTab('ethanol')"
              class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition flex items-center gap-2"
              data-target="ethanol"
            >
              <i class="fas fa-wine-bottle"></i> Ethanol
            </button>
            <button
              onclick="switchTab('acetic')"
              class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition flex items-center gap-2"
              data-target="acetic"
            >
              <i class="fas fa-vial"></i> Axit Axetic
            </button>
            <button
              onclick="switchTab('compare')"
              class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition flex items-center gap-2"
              data-target="compare"
            >
              <i class="fas fa-balance-scale"></i> So Sánh
            </button>
            <button
              onclick="switchTab('lab')"
              class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition flex items-center gap-2"
              data-target="lab"
            >
              <i class="fas fa-flask"></i> Thí Nghiệm (8)
            </button>
            <button
              onclick="switchTab('quiz')"
              class="nav-btn whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition flex items-center gap-2"
              data-target="quiz"
            >
              <i class="fas fa-pen-fancy"></i> Luyện Tập
            </button>
          </div>

          <!-- Theme Toggle -->
          <div class="flex-shrink-0 pl-2">
            <button
              id="themeToggle"
              class="p-2 rounded-full bg-slate-100 dark:bg-slate-800 hover:scale-110 transition shadow-sm"
            >
              <i class="fas fa-moon dark:text-yellow-400 text-slate-500"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- MAIN CONTENT CONTAINER -->
    <main class="flex-1 w-full max-w-6xl mx-auto p-4 md:p-6 pb-20">
      <!-- === TAB 1: ETHANOL === -->
      <div id="ethanol" class="tab-content active space-y-6">
        <header
          class="flex flex-col md:flex-row justify-between items-end border-b border-slate-200 dark:border-slate-700 pb-4"
        >
          <div>
            <span
              class="text-blue-500 font-bold tracking-widest text-xs uppercase mb-1 block"
              >Rượu Etylic</span
            >
            <h2 class="text-4xl font-black text-slate-800 dark:text-white">
              C₂H₅OH
            </h2>
            <p class="text-slate-500 dark:text-slate-400">Phân tử khối: 46</p>
          </div>
          <div class="flex gap-2 mt-2 md:mt-0">
            <span
              class="px-3 py-1 rounded bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 text-xs font-bold"
              >Nhóm –OH</span
            >
            <span
              class="px-3 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-bold"
              >C₂H₆O</span
            >
          </div>
        </header>

        <div class="grid md:grid-cols-2 gap-6">
          <!-- 3D Model -->
          <div
            class="glass-panel p-1 rounded-2xl relative overflow-hidden group"
          >
            <div class="absolute top-4 left-4 z-10">
              <h3 class="font-bold flex items-center gap-2">
                <i class="fas fa-cube text-blue-500"></i> Mô hình phân tử
              </h3>
            </div>
            <div
              class="h-64 bg-gradient-to-br from-slate-100 to-white dark:from-slate-800 dark:to-slate-900 rounded-xl"
              id="canvas-ethanol"
            ></div>
            <p class="text-center text-xs text-slate-400 mt-2 pb-2">
              CTCT: CH₃ – CH₂ – OH
            </p>
          </div>

          <!-- Info Cards -->
          <div class="space-y-4">
            <div class="glass-panel p-5 rounded-xl">
              <h3 class="font-bold text-blue-500 mb-2">
                <i class="fas fa-tint"></i> Tính chất vật lí
              </h3>
              <ul class="text-sm space-y-2 text-slate-600 dark:text-slate-300">
                <li>• Chất lỏng, không màu, nhẹ hơn nước.</li>
                <li>• Tan vô hạn trong nước, hòa tan được iot, benzen.</li>
                <li>• Dễ bay hơi, nhiệt độ sôi 78.3°C.</li>
              </ul>
            </div>

            <div class="glass-panel p-5 rounded-xl border-l-4 border-blue-500">
              <h3 class="font-bold text-slate-800 dark:text-white mb-2">
                Độ Rượu là gì?
              </h3>
              <p class="text-sm text-slate-600 dark:text-slate-300 mb-2">
                Là số ml rượu nguyên chất có trong 100ml hỗn hợp rượu với nước.
              </p>
              <div
                class="bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg flex items-center justify-between"
              >
                <span class="text-xs font-mono"
                  >VD: Rượu 40° = 40ml Ethanol + 60ml Nước</span
                >
                <i
                  class="fas fa-calculator text-blue-400 cursor-pointer hover:scale-110 transition"
                  onclick="switchTab('quiz')"
                  title="Làm bài tập"
                ></i>
              </div>
            </div>
          </div>
        </div>

        <div class="glass-panel p-6 rounded-2xl">
          <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
            <i class="fas fa-flask text-blue-500"></i> 3. Tính chất hóa học
          </h3>
          <div class="grid md:grid-cols-3 gap-4">
            <div
              class="p-4 rounded-xl bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30"
            >
              <strong class="text-red-600 dark:text-red-400 block mb-2"
                >a. Phản ứng cháy</strong
              >
              <p class="text-sm opacity-80 mb-2">
                Cháy với ngọn lửa xanh nhạt, tỏa nhiều nhiệt.
              </p>
              <code
                class="block bg-white dark:bg-black/20 p-2 rounded text-xs font-mono"
                >C₂H₅OH + 3O₂ → 2CO₂ + 3H₂O</code
              >
            </div>
            <div
              class="p-4 rounded-xl bg-green-50 dark:bg-green-900/10 border border-green-100 dark:border-green-900/30"
            >
              <strong class="text-green-600 dark:text-green-400 block mb-2"
                >b. Tác dụng với Na</strong
              >
              <p class="text-sm opacity-80 mb-2">
                Thay thế nguyên tử H trong nhóm -OH.
              </p>
              <code
                class="block bg-white dark:bg-black/20 p-2 rounded text-xs font-mono"
                >2C₂H₅OH + 2Na → 2C₂H₅ONa + H₂↑</code
              >
            </div>
            <div
              class="p-4 rounded-xl bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/30"
            >
              <strong class="text-purple-600 dark:text-purple-400 block mb-2"
                >c. Oxi hóa (Mở rộng)</strong
              >
              <p class="text-sm opacity-80 mb-2">
                Tạo Andehit (mùi hôi) hoặc Axit (giấm).
              </p>
              <code
                class="block bg-white dark:bg-black/20 p-2 rounded text-xs font-mono"
                >C₂H₅OH + CuO → CH₃CHO + ...</code
              >
            </div>
          </div>
        </div>

        <div
          class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-6 rounded-2xl shadow-lg"
        >
          <h3 class="font-bold text-lg mb-4">4. Ứng dụng thực tiễn</h3>
          <div
            class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center text-sm"
          >
            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
              <i class="fas fa-pump-soap text-2xl mb-2 block opacity-80"></i>Sát
              trùng y tế
            </div>
            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
              <i class="fas fa-gas-pump text-2xl mb-2 block opacity-80"></i
              >Nhiên liệu sinh học
            </div>
            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
              <i class="fas fa-wine-glass text-2xl mb-2 block opacity-80"></i>Đồ
              uống, Thực phẩm
            </div>
            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
              <i class="fas fa-industry text-2xl mb-2 block opacity-80"></i>SX
              Cao su, Giấm
            </div>
          </div>
        </div>
      </div>

      <!-- === TAB 2: ACETIC ACID === -->
      <div id="acetic" class="tab-content space-y-6">
        <header
          class="flex flex-col md:flex-row justify-between items-end border-b border-slate-200 dark:border-slate-700 pb-4"
        >
          <div>
            <span
              class="text-amber-500 font-bold tracking-widest text-xs uppercase mb-1 block"
              >Axit Axetic (Giấm ăn)</span
            >
            <h2 class="text-4xl font-black text-slate-800 dark:text-white">
              CH₃COOH
            </h2>
            <p class="text-slate-500 dark:text-slate-400">Phân tử khối: 60</p>
          </div>
          <div class="flex gap-2 mt-2 md:mt-0">
            <span
              class="px-3 py-1 rounded bg-amber-100 dark:bg-amber-900 text-amber-600 dark:text-amber-300 text-xs font-bold"
              >Nhóm –COOH</span
            >
            <span
              class="px-3 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-bold"
              >C₂H₄O₂</span
            >
          </div>
        </header>

        <div class="grid md:grid-cols-2 gap-6">
          <!-- 3D Model -->
          <div
            class="glass-panel p-1 rounded-2xl relative overflow-hidden group"
          >
            <div class="absolute top-4 left-4 z-10">
              <h3 class="font-bold flex items-center gap-2">
                <i class="fas fa-cube text-amber-500"></i> Mô hình phân tử
              </h3>
            </div>
            <div
              class="h-64 bg-gradient-to-br from-slate-100 to-white dark:from-slate-800 dark:to-slate-900 rounded-xl"
              id="canvas-acetic"
            ></div>
            <p class="text-center text-xs text-slate-400 mt-2 pb-2">
              CTCT: CH₃ – C(=O) – OH
            </p>
          </div>

          <!-- Info -->
          <div class="space-y-4">
            <div class="glass-panel p-5 rounded-xl">
              <h3 class="font-bold text-amber-500 mb-2">
                <i class="fas fa-info-circle"></i> Tính chất vật lí
              </h3>
              <ul class="text-sm space-y-2 text-slate-600 dark:text-slate-300">
                <li>• Chất lỏng, không màu, vị chua gắt.</li>
                <li>• Tan vô hạn trong nước.</li>
                <li>• Đông đặc ở 16.6°C → gọi là "Giấm băng".</li>
              </ul>
            </div>
            <div
              class="glass-panel p-5 rounded-xl border-l-4 border-amber-500 bg-amber-50 dark:bg-amber-900/10"
            >
              <h3 class="font-bold text-slate-800 dark:text-white mb-1">
                Em có biết?
              </h3>
              <p class="text-xs text-slate-600 dark:text-slate-300">
                Giấm ăn thông thường chỉ chứa 2-5% axit axetic. Vị chua là do
                ion H+ từ nhóm -COOH phân li ra.
              </p>
            </div>
          </div>
        </div>

        <div class="glass-panel p-6 rounded-2xl">
          <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
            <i class="fas fa-vial text-amber-500"></i> 3. Tính chất hóa học
          </h3>
          <p class="text-sm mb-4 text-slate-600 dark:text-slate-400">
            Là một axit hữu cơ yếu (Yếu hơn HCl, H₂SO₄ nhưng mạnh hơn axit
            cacbonic H₂CO₃).
          </p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div
              class="p-3 bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700"
            >
              <div class="flex items-center gap-2 font-bold text-sm mb-1">
                <span
                  class="w-6 h-6 rounded-full bg-red-100 text-red-500 flex items-center justify-center"
                  >1</span
                >
                Quỳ tím
              </div>
              <p class="text-xs ml-8">Hóa đỏ (hồng nhạt).</p>
            </div>
            <div
              class="p-3 bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700"
            >
              <div class="flex items-center gap-2 font-bold text-sm mb-1">
                <span
                  class="w-6 h-6 rounded-full bg-blue-100 text-blue-500 flex items-center justify-center"
                  >2</span
                >
                Tác dụng Bazơ
              </div>
              <p class="text-xs ml-8 font-mono">
                CH₃COOH + NaOH → CH₃COONa + H₂O
              </p>
            </div>
            <div
              class="p-3 bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700"
            >
              <div class="flex items-center gap-2 font-bold text-sm mb-1">
                <span
                  class="w-6 h-6 rounded-full bg-green-100 text-green-500 flex items-center justify-center"
                  >3</span
                >
                Tác dụng Kim Loại
              </div>
              <p class="text-xs ml-8 font-mono">
                2CH₃COOH + Zn → (CH₃COO)₂Zn + H₂↑
              </p>
            </div>
            <div
              class="p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg shadow-sm border border-amber-200 dark:border-amber-700/50"
            >
              <div
                class="flex items-center gap-2 font-bold text-sm mb-1 text-amber-700 dark:text-amber-400"
              >
                <span
                  class="w-6 h-6 rounded-full bg-amber-200 text-amber-800 flex items-center justify-center"
                  >4</span
                >
                Tác dụng Muối Carbonate
              </div>
              <p class="text-xs ml-8 font-mono">
                2CH₃COOH + CaCO₃ → (CH₃COO)₂Ca + CO₂↑ + H₂O
              </p>
              <p class="text-[10px] ml-8 text-amber-600 italic">
                Hiện tượng: Sủi bọt khí mạnh.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- === TAB 3: COMPARISON === -->
      <div id="compare" class="tab-content space-y-6">
        <h2
          class="text-3xl font-black text-purple-500 mb-6 border-b border-purple-200 dark:border-purple-800 pb-2"
        >
          Tổng Kết & So Sánh
        </h2>

        <div
          class="overflow-hidden rounded-xl shadow-lg border border-slate-200 dark:border-slate-700"
        >
          <table
            class="w-full text-left border-collapse bg-white dark:bg-slate-800 text-sm"
          >
            <thead>
              <tr
                class="bg-slate-100 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700"
              >
                <th class="p-4 font-bold">Tiêu chí</th>
                <th class="p-4 font-bold text-blue-500">Ethanol (Rượu)</th>
                <th class="p-4 font-bold text-amber-500">Axit Axetic (Giấm)</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-slate-100 dark:divide-slate-700">
              <tr>
                <td class="p-4 font-bold">CTPT</td>
                <td class="p-4">C₂H₆O</td>
                <td class="p-4">C₂H₄O₂</td>
              </tr>
              <tr>
                <td class="p-4 font-bold">Nhóm chức</td>
                <td class="p-4 font-mono font-bold text-blue-500">–OH</td>
                <td class="p-4 font-mono font-bold text-amber-500">–COOH</td>
              </tr>
              <tr>
                <td class="p-4 font-bold">Quỳ tím</td>
                <td class="p-4 text-slate-400">Không đổi</td>
                <td class="p-4 text-red-500 font-bold">Hóa đỏ</td>
              </tr>
              <tr>
                <td class="p-4 font-bold">Na</td>
                <td class="p-4 text-green-500">
                  <i class="fas fa-check"></i> Có (H₂)
                </td>
                <td class="p-4 text-green-500">
                  <i class="fas fa-check"></i> Có (H₂)
                </td>
              </tr>
              <tr>
                <td class="p-4 font-bold">NaOH</td>
                <td class="p-4 text-slate-400">
                  <i class="fas fa-times"></i> Không
                </td>
                <td class="p-4 text-green-500">
                  <i class="fas fa-check"></i> Có
                </td>
              </tr>
              <tr>
                <td class="p-4 font-bold">CaCO₃ / Na₂CO₃</td>
                <td class="p-4 text-slate-400">
                  <i class="fas fa-times"></i> Không
                </td>
                <td class="p-4 text-green-500 font-bold">
                  <i class="fas fa-check"></i> Sủi bọt CO₂
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div
          class="glass-panel p-6 rounded-2xl bg-gradient-to-br from-purple-50 to-white dark:from-purple-900/20 dark:to-slate-900 border border-purple-200 dark:border-purple-800"
        >
          <h3
            class="text-xl font-bold text-purple-600 dark:text-purple-400 mb-2"
          >
            <i class="fas fa-sync-alt"></i> Mối liên hệ: Lên Men Giấm
          </h3>
          <p class="text-sm mb-4">
            Rượu để lâu trong không khí sẽ bị chua thành giấm.
          </p>
          <div
            class="flex items-center justify-center gap-2 md:gap-4 flex-wrap text-sm font-mono bg-white/50 dark:bg-black/20 p-4 rounded-xl"
          >
            <span class="text-blue-600 font-bold">C₂H₅OH</span>
            <span class="text-slate-400">+ O₂</span>
            <div class="flex flex-col items-center">
              <span class="text-[10px] text-slate-500">men giấm</span>
              <i class="fas fa-arrow-right text-slate-400"></i>
            </div>
            <span class="text-amber-600 font-bold">CH₃COOH</span>
            <span class="text-slate-400">+ H₂O</span>
          </div>
        </div>
      </div>

      <!-- === TAB 4: EXPERIMENTS === -->
      <div id="lab" class="tab-content space-y-6">
        <header class="flex justify-between items-center">
          <h2 class="text-3xl font-black text-green-500">
            Phòng Thí Nghiệm Ảo
          </h2>
          <span
            class="bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 text-xs font-bold px-3 py-1 rounded-full"
            >8 Mô phỏng</span
          >
        </header>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
          <!-- Row 1 -->
          <button
            onclick="runExp(1)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-fire text-red-500 text-xl group-hover:scale-110 transition"
            ></i>
            Đốt cháy Ethanol
          </button>
          <button
            onclick="runExp(2)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-vial text-purple-500 text-xl group-hover:scale-110 transition"
            ></i>
            Giấy quỳ tím
          </button>
          <button
            onclick="runExp(3)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-soap text-slate-400 text-xl group-hover:scale-110 transition"
            ></i>
            Ethanol + Na
          </button>
          <button
            onclick="runExp(4)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-volcano text-amber-500 text-xl group-hover:scale-110 transition"
            ></i>
            Axit + Na₂CO₃
          </button>

          <!-- Row 2 -->
          <button
            onclick="runExp(5)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-tint text-blue-500 text-xl group-hover:scale-110 transition"
            ></i>
            Axit + CuO
          </button>
          <button
            onclick="runExp(6)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-eraser text-slate-500 text-xl group-hover:scale-110 transition"
            ></i>
            Tẩy cặn ấm
          </button>
          <button
            onclick="runExp(7)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-wind text-gray-400 text-xl group-hover:scale-110 transition"
            ></i>
            Oxi hóa Rượu
          </button>
          <button
            onclick="runExp(8)"
            class="lab-btn p-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border hover:border-blue-500 transition text-xs font-bold flex flex-col items-center gap-1 group"
          >
            <i
              class="fas fa-shield-virus text-green-500 text-xl group-hover:scale-110 transition"
            ></i>
            Diệt khuẩn (70°)
          </button>
        </div>

        <!-- DISPLAY AREA -->
        <div
          class="relative w-full h-[350px] bg-slate-900 rounded-2xl shadow-inner overflow-hidden border-4 border-slate-300 dark:border-slate-700 flex flex-col items-center justify-end p-4"
        >
          <div
            id="lab-info"
            class="absolute top-4 left-4 right-4 text-center text-white pointer-events-none z-20"
          >
            <h3 class="text-xl font-bold text-shadow" id="exp-title">
              Chào mừng đến phòng thí nghiệm
            </h3>
            <p class="text-sm opacity-90" id="exp-desc">
              Vui lòng chọn thí nghiệm phía trên.
            </p>
          </div>

          <div
            id="equation-box"
            class="absolute top-20 bg-black/70 backdrop-blur text-green-400 font-mono p-2 rounded hidden z-20 border border-green-500/30 text-sm md:text-base"
          ></div>

          <!-- SCENES -->
          <!-- 1. Combustion -->
          <div
            id="scene-combustion"
            class="scene hidden absolute bottom-10 flex flex-col items-center"
          >
            <div
              class="flame w-10 h-16 bg-gradient-to-t from-blue-600 via-blue-400 to-transparent rounded-t-full opacity-0 transition-opacity duration-500"
              id="fire-el"
            ></div>
            <div
              class="w-24 h-12 bg-white/20 border-b border-white/40 backdrop-blur rounded-b-xl relative"
            >
              <span
                class="absolute text-[10px] text-white/50 w-full text-center bottom-1"
                >C₂H₅OH</span
              >
            </div>
            <button
              onclick="igniteFire()"
              class="mt-4 btn-action px-4 py-1 bg-red-600 text-white rounded hover:bg-red-500 text-xs font-bold"
            >
              Bật lửa
            </button>
          </div>

          <!-- 2. Litmus -->
          <div
            id="scene-litmus"
            class="scene hidden absolute bottom-10 flex flex-col items-center"
          >
            <div
              id="litmus-paper"
              class="w-8 h-32 bg-purple-400 shadow cursor-pointer transition-colors duration-1000 mb-[-20px] z-10 transform hover:translate-y-4"
              onclick="dipLitmus()"
            ></div>
            <div
              class="w-32 h-20 bg-white/10 border border-white/30 backdrop-blur rounded-b-xl relative overflow-hidden flex items-end justify-center"
            >
              <div class="w-full h-16 bg-amber-100/30"></div>
              <span class="absolute bottom-2 text-white/50 text-xs"
                >CH₃COOH</span
              >
            </div>
            <p class="text-white text-xs mt-2 opacity-70">Nhấn vào giấy quỳ</p>
          </div>

          <!-- 3 & 4. Reaction -->
          <div
            id="scene-reaction"
            class="scene hidden absolute bottom-10 w-full flex justify-center"
          >
            <div
              class="relative w-32 h-40 bg-white/10 border-2 border-white/30 rounded-b-xl backdrop-blur overflow-hidden flex items-end justify-center"
            >
              <div
                id="liquid-react"
                class="w-full h-24 bg-blue-400/20 transition-colors duration-1000"
              ></div>
              <div
                id="solid-reactant"
                class="absolute bottom-2 w-8 h-8 bg-slate-300 rounded shadow hidden"
              ></div>
              <div
                id="bubbles-container"
                class="absolute inset-0 pointer-events-none"
              ></div>
            </div>
            <button
              id="btn-add-reactant"
              class="absolute right-10 bottom-0 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-500 font-bold shadow-lg transform active:scale-95 transition"
              onclick="triggerReaction()"
            >
              Thêm chất
            </button>
          </div>

          <!-- 5. Color Change -->
          <div
            id="scene-color"
            class="scene hidden absolute bottom-10 flex flex-col items-center"
          >
            <div
              class="w-32 h-40 bg-white/10 border border-white/30 backdrop-blur rounded-b-xl relative overflow-hidden flex items-end justify-center"
            >
              <div
                id="color-liquid"
                class="w-full h-28 bg-transparent transition-colors duration-2000"
              ></div>
              <div
                id="cuo-powder"
                class="absolute bottom-0 w-12 h-4 bg-black rounded-full opacity-80 transition-opacity"
              ></div>
            </div>
            <button
              onclick="heatUp()"
              class="mt-4 px-4 py-1 bg-orange-600 text-white rounded hover:bg-orange-500 text-xs font-bold"
            >
              <i class="fas fa-fire"></i> Đun nóng
            </button>
          </div>

          <!-- 6. Kettle -->
          <div
            id="scene-kettle"
            class="scene hidden absolute bottom-10 flex flex-col items-center"
          >
            <div
              class="relative w-40 h-32 bg-slate-700 rounded-t-full border-4 border-slate-500 flex items-center justify-center overflow-hidden"
            >
              <div class="absolute bottom-0 w-full h-10 bg-white/10 z-20"></div>
              <div
                id="scale-layer"
                class="absolute inset-0 border-[8px] border-yellow-100/50 rounded-t-full z-10 transition-all duration-3000"
              ></div>
              <div
                id="kettle-bubbles"
                class="absolute inset-0 z-10 pointer-events-none"
              ></div>
            </div>
            <button
              onclick="pourVinegar()"
              class="mt-2 px-4 py-1 bg-amber-600 text-white rounded hover:bg-amber-500 text-xs font-bold"
            >
              Đổ Giấm
            </button>
          </div>

          <!-- 7. Oxidation (NEW) -->
          <div
            id="scene-oxidation"
            class="scene hidden absolute bottom-10 flex flex-col items-center"
          >
            <div class="flex items-center gap-1">
              <div
                class="w-20 h-4 bg-white/20 rounded-full relative overflow-hidden flex items-center justify-center"
              >
                <div class="absolute inset-0 bg-white/10 animate-pulse"></div>
                <!-- Vapor -->
                <span class="text-[8px] text-white z-10">Hơi Rượu</span>
              </div>
              <i class="fas fa-arrow-right text-white"></i>
              <div
                class="w-12 h-12 rounded-full border-2 border-slate-500 flex items-center justify-center relative bg-black transition-colors duration-2000"
                id="cuo-ball"
              >
                <span
                  class="text-[8px] text-white font-bold z-10"
                  id="cuo-label"
                  >CuO (Đen)</span
                >
              </div>
            </div>
            <div
              class="mt-2 h-4 w-32 bg-gradient-to-r from-transparent via-orange-500/50 to-transparent blur-md"
            ></div>
            <!-- Heat -->
            <button
              onclick="runOxidation()"
              class="mt-4 px-4 py-1 bg-orange-600 text-white rounded hover:bg-orange-500 text-xs font-bold"
            >
              Dẫn hơi qua & Đun
            </button>
          </div>

          <!-- 8. Bacteria (NEW) -->
          <div
            id="scene-bacteria"
            class="scene hidden absolute inset-0 flex flex-col items-center justify-center bg-green-900/20"
          >
            <div
              class="w-64 h-64 rounded-full border-4 border-white/20 bg-black/40 relative overflow-hidden"
              id="petri-dish"
            >
              <!-- Germs will be injected here -->
            </div>
            <div class="flex gap-4 mt-4 absolute bottom-4">
              <button
                onclick="applyAlcohol(90)"
                class="px-4 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded font-bold text-xs"
              >
                Cồn 90°
              </button>
              <button
                onclick="applyAlcohol(70)"
                class="px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded font-bold text-xs"
              >
                Cồn 70°
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- === TAB 5: QUIZ & PRACTICE (NEW) === -->
      <div id="quiz" class="tab-content space-y-6">
        <h2 class="text-3xl font-black text-pink-500 mb-6">
          Luyện Tập & Vận Dụng
        </h2>

        <!-- Exercise 1: Calculator -->
        <div class="glass-panel p-6 rounded-2xl border-l-4 border-blue-500">
          <h3 class="font-bold text-lg mb-4 text-blue-600 dark:text-blue-400">
            1. Bài toán pha chế rượu
          </h3>
          <p class="mb-4 text-sm">
            Câu hỏi:
            <strong
              >Rượu 40° có bao nhiêu ml etanol trong 500 ml dung dịch?</strong
            >
          </p>

          <div
            class="bg-slate-50 dark:bg-slate-900/50 p-4 rounded-xl max-w-md mx-auto"
          >
            <div class="space-y-3">
              <div>
                <label class="text-xs font-bold text-slate-500 uppercase"
                  >Thể tích dd (ml)</label
                >
                <input
                  type="number"
                  id="quiz-vol"
                  value="500"
                  class="w-full p-2 rounded border bg-white dark:bg-slate-800 text-sm"
                />
              </div>
              <div>
                <label class="text-xs font-bold text-slate-500 uppercase"
                  >Độ rượu (°)</label
                >
                <input
                  type="number"
                  id="quiz-deg"
                  value="40"
                  class="w-full p-2 rounded border bg-white dark:bg-slate-800 text-sm"
                />
              </div>
              <button
                onclick="solveQuiz1()"
                class="w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded font-bold transition shadow"
              >
                Xem Kết Quả
              </button>
            </div>
            <div
              id="quiz1-result"
              class="mt-4 p-3 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded hidden text-center font-bold"
            ></div>
          </div>
        </div>

        <!-- Exercise 2: Reactions -->
        <div class="glass-panel p-6 rounded-2xl border-l-4 border-amber-500">
          <h3 class="font-bold text-lg mb-4 text-amber-600 dark:text-amber-400">
            2. Viết phương trình hóa học
          </h3>
          <div class="space-y-4">
            <div class="p-3 bg-white dark:bg-slate-800 rounded shadow-sm">
              <p class="font-bold text-sm mb-2">
                a. Axit Axetic + Natri Cacbonat
              </p>
              <div class="relative group cursor-pointer">
                <div
                  class="blur-sm select-none bg-slate-200 dark:bg-slate-700 p-2 rounded text-center group-hover:blur-0 transition duration-300 font-mono text-sm"
                >
                  2CH₃COOH + Na₂CO₃ → 2CH₃COONa + H₂O + CO₂↑
                </div>
                <span
                  class="absolute inset-0 flex items-center justify-center text-xs text-slate-500 group-hover:hidden"
                  >Di chuột để xem đáp án</span
                >
              </div>
            </div>
            <div class="p-3 bg-white dark:bg-slate-800 rounded shadow-sm">
              <p class="font-bold text-sm mb-2">b. Ethanol + Natri</p>
              <div class="relative group cursor-pointer">
                <div
                  class="blur-sm select-none bg-slate-200 dark:bg-slate-700 p-2 rounded text-center group-hover:blur-0 transition duration-300 font-mono text-sm"
                >
                  2C₂H₅OH + 2Na → 2C₂H₅ONa + H₂↑
                </div>
                <span
                  class="absolute inset-0 flex items-center justify-center text-xs text-slate-500 group-hover:hidden"
                  >Di chuột để xem đáp án</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Exercise 3: Application -->
        <div class="glass-panel p-6 rounded-2xl border-l-4 border-green-500">
          <h3 class="font-bold text-lg mb-2 text-green-600 dark:text-green-400">
            3. Ứng dụng
          </h3>
          <p class="text-sm mb-4">
            Kể tên 2 ứng dụng quan trọng của Axit Axetic trong đời sống?
          </p>
          <ul
            class="list-disc list-inside text-sm space-y-1 pl-4 text-slate-700 dark:text-slate-300"
          >
            <li>Làm gia vị (Giấm ăn).</li>
            <li>Sản xuất chất dẻo, dược phẩm, thuốc nhuộm.</li>
          </ul>
        </div>
      </div>
    </main>

    <!-- JS LOGIC -->
    <script>
      // --- THEME & NAV ---
      const themeToggle = document.getElementById("themeToggle");
      const html = document.documentElement;

      themeToggle.addEventListener("click", () => {
        html.classList.toggle("dark");
        const icon = themeToggle.querySelector("i");
        if (html.classList.contains("dark")) {
          icon.classList.remove("fa-moon", "text-slate-500");
          icon.classList.add("fa-sun", "text-yellow-400");
        } else {
          icon.classList.remove("fa-sun", "text-yellow-400");
          icon.classList.add("fa-moon", "text-slate-500");
        }
        renderMolecules();
      });

      function switchTab(tabId) {
        document
          .querySelectorAll(".tab-content")
          .forEach((el) => el.classList.remove("active"));
        document.getElementById(tabId).classList.add("active");

        // Update Menu Active State
        document.querySelectorAll(".nav-btn").forEach((btn) => {
          btn.classList.remove("bg-blue-600", "text-white", "shadow-lg");
          btn.classList.add(
            "text-slate-600",
            "dark:text-slate-300",
            "hover:bg-slate-100",
            "dark:hover:bg-slate-800"
          );
        });
        const activeBtn = document.querySelector(
          `button[data-target="${tabId}"]`
        );
        if (activeBtn) {
          activeBtn.classList.remove(
            "text-slate-600",
            "dark:text-slate-300",
            "hover:bg-slate-100",
            "dark:hover:bg-slate-800"
          );
          activeBtn.classList.add("bg-blue-600", "text-white", "shadow-lg");
        }

        // Render 3D if needed
        if (tabId === "ethanol" || tabId === "acetic")
          setTimeout(renderMolecules, 100);
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // --- QUIZ LOGIC ---
      function solveQuiz1() {
        const v = parseFloat(document.getElementById("quiz-vol").value);
        const d = parseFloat(document.getElementById("quiz-deg").value);
        const res = (v * d) / 100;
        const el = document.getElementById("quiz1-result");
        el.classList.remove("hidden");
        el.innerHTML = `V rượu nguyên chất = (${d} x ${v}) / 100 = <span class="text-xl text-red-500">${res} ml</span>`;
      }

      // --- EXPERIMENTS ---
      let currentExp = 0;

      function runExp(id) {
        currentExp = id;
        document
          .querySelectorAll(".scene")
          .forEach((el) => el.classList.add("hidden"));
        document.getElementById("equation-box").classList.add("hidden");
        document.getElementById("equation-box").innerHTML = "";

        const title = document.getElementById("exp-title");
        const desc = document.getElementById("exp-desc");
        const eqBox = document.getElementById("equation-box");

        // Set content based on ID
        switch (id) {
          case 1:
            title.innerText = "1. Đốt cháy Ethanol";
            desc.innerText =
              "Rượu cháy với ngọn lửa xanh nhạt, tỏa nhiều nhiệt.";
            document
              .getElementById("scene-combustion")
              .classList.remove("hidden");
            document.getElementById("fire-el").classList.add("opacity-0");
            break;
          case 2:
            title.innerText = "2. Axit Axetic + Quỳ Tím";
            desc.innerText = "Axit làm quỳ tím hóa đỏ (hồng nhạt).";
            document.getElementById("scene-litmus").classList.remove("hidden");
            document.getElementById("litmus-paper").style.backgroundColor =
              "#a78bfa";
            document.getElementById("litmus-paper").style.transform =
              "translateY(0)";
            break;
          case 3:
            title.innerText = "3. Ethanol + Na";
            desc.innerText = "Hiện tượng sủi bọt khí Hydro.";
            setupReactionScene(3);
            break;
          case 4:
            title.innerText = "4. Axit Axetic + Muối Carbonate";
            desc.innerText = "Axit đẩy CO2 ra khỏi muối (Sủi bọt mạnh).";
            setupReactionScene(4);
            break;
          case 5:
            title.innerText = "5. Axit Axetic + CuO";
            desc.innerText = "Hòa tan oxit bazơ tạo dung dịch xanh lam.";
            document.getElementById("scene-color").classList.remove("hidden");
            document.getElementById("color-liquid").className =
              "w-full h-28 bg-transparent transition-colors duration-2000";
            document.getElementById("cuo-powder").style.opacity = "1";
            break;
          case 6:
            title.innerText = "6. Tẩy cặn ấm đun (Thực tế)";
            desc.innerText = "Giấm hòa tan lớp cặn vôi (CaCO3).";
            document.getElementById("scene-kettle").classList.remove("hidden");
            document.getElementById("scale-layer").style.opacity = "1";
            document.getElementById("kettle-bubbles").innerHTML = "";
            break;
          case 7:
            title.innerText = "7. Oxi hóa Ethanol (Bằng CuO)";
            desc.innerText =
              "CuO đen biến thành Cu đỏ, tạo ra Aldehyde mùi hôi.";
            document
              .getElementById("scene-oxidation")
              .classList.remove("hidden");
            document.getElementById("cuo-ball").className =
              "w-12 h-12 rounded-full border-2 border-slate-500 flex items-center justify-center relative bg-black transition-colors duration-2000";
            document.getElementById("cuo-label").innerText = "CuO (Đen)";
            break;
          case 8:
            title.innerText = "8. Diệt khuẩn: Cồn 70° vs 90°";
            desc.innerText = "Xem tại sao Cồn 70° lại sát khuẩn tốt hơn.";
            document
              .getElementById("scene-bacteria")
              .classList.remove("hidden");
            setupPetriDish();
            break;
        }
      }

      // Logic for Exp 1, 2, 5, 6
      function igniteFire() {
        document.getElementById("fire-el").classList.remove("opacity-0");
        showEq("C₂H₅OH + 3O₂ → 2CO₂ + 3H₂O (t°)");
      }
      function dipLitmus() {
        const p = document.getElementById("litmus-paper");
        p.style.transform = "translateY(40px)";
        setTimeout(() => {
          p.style.backgroundColor = "#ef4444";
          showEq("Quỳ tím → Đỏ");
          setTimeout(() => (p.style.transform = "translateY(0)"), 1000);
        }, 800);
      }
      function heatUp() {
        document.getElementById("color-liquid").classList.add("bg-blue-500/50");
        document.getElementById("cuo-powder").style.opacity = "0";
        showEq("2CH₃COOH + CuO → (CH₃COO)₂Cu + H₂O");
      }
      function pourVinegar() {
        const bubbles = document.getElementById("kettle-bubbles");
        const intv = setInterval(() => {
          const b = document.createElement("div");
          b.className = "bubble w-3 h-3 bg-white/80";
          b.style.left = Math.random() * 80 + 10 + "%";
          bubbles.appendChild(b);
          setTimeout(() => b.remove(), 2000);
        }, 100);
        setTimeout(() => {
          document.getElementById("scale-layer").style.opacity = "0";
          showEq("CaCO₃ + 2CH₃COOH → (CH₃COO)₂Ca + CO₂↑ + H₂O");
        }, 1500);
        setTimeout(() => clearInterval(intv), 3000);
      }

      // Logic for Exp 3 & 4 (Reaction Scene)
      function setupReactionScene(type) {
        document.getElementById("scene-reaction").classList.remove("hidden");
        const liquid = document.getElementById("liquid-react");
        const solid = document.getElementById("solid-reactant");
        liquid.className =
          "w-full h-24 transition-colors duration-1000 " +
          (type === 3 ? "bg-white/10" : "bg-amber-100/30");
        solid.classList.add("hidden");
        document.getElementById("bubbles-container").innerHTML = "";
      }
      function triggerReaction() {
        const solid = document.getElementById("solid-reactant");
        solid.classList.remove("hidden");
        solid.style.bottom = "100px";
        setTimeout(() => (solid.style.bottom = "8px"), 100);
        setTimeout(() => {
          const bubbles = document.getElementById("bubbles-container");
          const intv = setInterval(() => {
            const b = document.createElement("div");
            b.className = "bubble w-2 h-2";
            b.style.left = Math.random() * 80 + 10 + "%";
            bubbles.appendChild(b);
            setTimeout(() => b.remove(), 2000);
          }, 150);
          setTimeout(() => clearInterval(intv), 3000);

          if (currentExp === 3) {
            showEq("2C₂H₅OH + 2Na → 2C₂H₅ONa + H₂↑");
            setTimeout(() => solid.classList.add("hidden"), 2000);
          } else {
            showEq("2CH₃COOH + Na₂CO₃ → ... + CO₂↑ + H₂O");
            setTimeout(() => solid.classList.add("hidden"), 1500);
          }
        }, 600);
      }

      // Logic for Exp 7 (Oxidation)
      function runOxidation() {
        const ball = document.getElementById("cuo-ball");
        ball.className =
          "w-12 h-12 rounded-full border-2 border-slate-500 flex items-center justify-center relative bg-red-600 transition-colors duration-2000";
        document.getElementById("cuo-label").innerText = "Cu (Đỏ)";
        showEq("C₂H₅OH + CuO (đen) → CH₃CHO (mùi hôi) + Cu (đỏ) + H₂O");
      }

      // Logic for Exp 8 (Bacteria)
      function setupPetriDish() {
        const dish = document.getElementById("petri-dish");
        dish.innerHTML = "";
        for (let i = 0; i < 8; i++) {
          const g = document.createElement("div");
          g.className =
            "germ absolute w-8 h-8 flex items-center justify-center text-green-400 text-2xl";
          g.innerHTML = '<i class="fas fa-bug"></i>';
          g.style.left = Math.random() * 70 + 10 + "%";
          g.style.top = Math.random() * 70 + 10 + "%";
          g.style.animationDelay = Math.random() + "s";
          dish.appendChild(g);
        }
      }
      function applyAlcohol(deg) {
        const germs = document.querySelectorAll(".germ");
        const eqBox = document.getElementById("equation-box");
        eqBox.classList.remove("hidden");

        if (deg === 90) {
          eqBox.innerText =
            "Cồn 90°: Làm đông tụ protein bề mặt quá nhanh -> Vi khuẩn tạo vỏ bọc bảo vệ.";
          germs.forEach((g) => {
            g.classList.add("shielded");
          });
        } else {
          eqBox.innerText =
            "Cồn 70°: Thẩm thấu sâu vào bên trong -> Tiêu diệt vi khuẩn.";
          germs.forEach((g) => {
            g.classList.add("dead");
            setTimeout(() => g.remove(), 1000);
          });
        }
      }

      function showEq(text) {
        const b = document.getElementById("equation-box");
        b.innerText = text;
        b.classList.remove("hidden");
      }

      // --- THREE.JS ---
      function initThree(containerId, atomData) {
        const container = document.getElementById(containerId);
        if (!container) return;
        container.innerHTML = "";
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(
          50,
          container.clientWidth / container.clientHeight,
          0.1,
          1000
        );
        const renderer = new THREE.WebGLRenderer({
          alpha: true,
          antialias: true,
        });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(2, 2, 5);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x606060));

        const group = new THREE.Group();
        atomData.forEach((atom) => {
          const sphere = new THREE.Mesh(
            new THREE.SphereGeometry(atom.r, 32, 32),
            new THREE.MeshLambertMaterial({ color: atom.color })
          );
          sphere.position.set(atom.x, atom.y, atom.z);
          group.add(sphere);
        });

        // Bonds
        const bondMat = new THREE.MeshLambertMaterial({ color: 0x999999 });
        const addBond = (p1, p2) => {
          const start = new THREE.Vector3(p1.x, p1.y, p1.z);
          const end = new THREE.Vector3(p2.x, p2.y, p2.z);
          const dist = start.distanceTo(end);
          const cylinder = new THREE.Mesh(
            new THREE.CylinderGeometry(0.12, 0.12, dist, 12),
            bondMat
          );
          const pos = end.clone().add(start).multiplyScalar(0.5);
          cylinder.position.copy(pos);
          cylinder.lookAt(end);
          cylinder.rotateX(Math.PI / 2);
          group.add(cylinder);
        };

        // Hardcoded connections for visual simplicity
        if (atomData.length > 2) {
          for (let i = 0; i < atomData.length - 1; i++) {
            if (atomData[i].r > 0.3 && atomData[i + 1].r > 0.3)
              addBond(atomData[i], atomData[i + 1]); // Connect main skeleton
          }
        }

        scene.add(group);
        camera.position.z = 5;

        const animate = () => {
          requestAnimationFrame(animate);
          group.rotation.y += 0.005;
          group.rotation.x = Math.sin(Date.now() * 0.001) * 0.2;
          renderer.render(scene, camera);
        };
        animate();
      }

      function renderMolecules() {
        // C: Black/Grey, O: Red, H: White
        const ethanolAtoms = [
          { x: -0.8, y: 0, z: 0, r: 0.5, color: 0x333333 },
          { x: 0.6, y: 0, z: 0, r: 0.5, color: 0x333333 },
          { x: 1.6, y: 0.8, z: 0, r: 0.5, color: 0xff0000 }, // Skeleton
          { x: -1.4, y: 0.6, z: 0, r: 0.3, color: 0xffffff },
          { x: -1.4, y: -0.6, z: 0, r: 0.3, color: 0xffffff },
          { x: -0.8, y: 0, z: 1, r: 0.3, color: 0xffffff }, // H on C1
          { x: 0.6, y: -0.8, z: 0, r: 0.3, color: 0xffffff },
          { x: 0.6, y: 0, z: -1, r: 0.3, color: 0xffffff }, // H on C2
          { x: 2.2, y: 0.4, z: 0, r: 0.3, color: 0xffffff }, // H on O
        ];
        const aceticAtoms = [
          { x: -0.8, y: 0, z: 0, r: 0.5, color: 0x333333 },
          { x: 0.6, y: 0, z: 0, r: 0.5, color: 0x333333 }, // C-C
          { x: 1.3, y: 1.0, z: 0, r: 0.45, color: 0xff0000 }, // =O
          { x: 1.3, y: -1.0, z: 0, r: 0.45, color: 0xff0000 }, // -OH
          { x: -1.4, y: 0.6, z: 0, r: 0.3, color: 0xffffff },
          { x: -1.4, y: -0.6, z: 0, r: 0.3, color: 0xffffff },
          { x: -0.8, y: 0, z: 1, r: 0.3, color: 0xffffff }, // H on C1
          { x: 1.9, y: -0.8, z: 0, r: 0.3, color: 0xffffff }, // H on OH
        ];

        if (document.getElementById("ethanol").classList.contains("active"))
          initThree("canvas-ethanol", ethanolAtoms);
        if (document.getElementById("acetic").classList.contains("active"))
          initThree("canvas-acetic", aceticAtoms);
      }

      // Init
      window.onload = () => {
        switchTab("ethanol");
      };
    </script>
  </body>
</html>
