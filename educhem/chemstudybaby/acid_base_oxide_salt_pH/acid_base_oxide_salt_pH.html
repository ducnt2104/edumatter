<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H√≥a H·ªçc 8 - Ch·ªß ƒê·ªÅ 2: H·ª£p Ch·∫•t V√¥ C∆°</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
      :root {
        --primary: #8b5cf6; /* Violet */
        --secondary: #06b6d4; /* Cyan */
        --success: #22c55e;
        --danger: #ef4444;
        --dark-bg: #0f172a;
        --panel-bg: rgba(30, 41, 59, 0.7);
      }

      body {
        font-family: "Be Vietnam Pro", sans-serif;
        background-color: var(--dark-bg);
        background-image: radial-gradient(
            at 0% 0%,
            rgba(139, 92, 246, 0.2) 0px,
            transparent 50%
          ),
          radial-gradient(
            at 100% 100%,
            rgba(6, 182, 212, 0.2) 0px,
            transparent 50%
          );
        color: #f1f5f9;
        height: 100vh;
        overflow: hidden;
        user-select: none;
      }

      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #475569;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }

      /* Effects */
      .glass {
        background: var(--panel-bg);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
      }

      .nav-item.active {
        background: linear-gradient(
          90deg,
          rgba(139, 92, 246, 0.3),
          transparent
        );
        border-left: 4px solid var(--secondary);
        color: white;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Interactive Elements */
      .formula-box {
        font-family: "Courier New", monospace;
        background: rgba(0, 0, 0, 0.3);
        padding: 2px 6px;
        border-radius: 4px;
        color: var(--secondary);
        font-weight: bold;
      }

      /* Drag & Drop */
      .draggable {
        cursor: grab;
        transition: transform 0.2s;
      }
      .draggable:active {
        cursor: grabbing;
        transform: scale(1.1);
      }
      .drop-zone {
        border: 2px dashed #475569;
        transition: all 0.3s;
      }
      .drop-zone.drag-over {
        border-color: var(--success);
        background: rgba(34, 197, 94, 0.1);
        transform: scale(1.02);
      }

      /* Quiz */
      .quiz-opt:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      .quiz-opt.correct {
        background: rgba(34, 197, 94, 0.2);
        border-color: var(--success);
      }
      .quiz-opt.wrong {
        background: rgba(239, 68, 68, 0.2);
        border-color: var(--danger);
      }
    </style>
    <link rel="stylesheet" href="../../component/component.css">
    <script src="../../component/component.js"></script>
  </head>
  <body class="flex flex-col md:flex-row h-screen">
    <aside
      class="w-full md:w-64 glass flex-shrink-0 flex flex-col z-20 md:h-full border-r border-slate-700/50"
    >
      <div class="p-6 flex items-center gap-3 border-b border-slate-700/50">
        <div
          class="w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-cyan-500 flex items-center justify-center shadow-lg animate-pulse"
        >
          <i class="fa-solid fa-flask text-white"></i>
        </div>
        <div>
          <h1
            class="font-black text-lg tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-violet-400"
          >
            E - Chem
          </h1>
          <p class="text-xs text-slate-400">Ch·ªß ƒë·ªÅ 2: V√¥ c∆°</p>
        </div>
      </div>

      <nav class="flex-1 overflow-y-auto p-4 space-y-1" id="nav-menu"></nav>

      <div class="p-4 border-t border-slate-700/50">
        <div class="glass p-3 rounded-xl flex justify-between items-center">
          <span class="text-xs text-slate-400">ƒêi·ªÉm s·ªë</span>
          <span id="total-score" class="font-black text-xl text-green-400"
            >0</span
          >
        </div>
      </div>
    </aside>

    <main class="flex-1 relative overflow-hidden flex flex-col">
      <div class="md:hidden h-14 glass flex items-center px-4 justify-between">
        <span class="font-bold">H√≥a H·ªçc 8</span>

      </div>
        <a href="../chemstudybaby.html">quay v·ªÅ trang ch·ªß</a>
      <div
        id="content-area"
        class="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth relative"
      ></div>
    </main>

    <script>
      /* --- D·ªÆ LI·ªÜU B√ÄI H·ªåC --- */
      const lessons = [
        {
          id: "intro",
          title: "T·ªïng quan",
          icon: "fa-house",
          render: () => `
                    <div class="flex flex-col items-center justify-center min-h-[60vh] text-center fade-in">
                        <div class="mb-6 relative">
                            <i class="fa-solid fa-atom text-8xl text-slate-700 absolute top-0 left-0 animate-spin-slow" style="animation-duration: 10s"></i>
                            <i class="fa-solid fa-flask-vial text-7xl text-cyan-400 relative z-10 drop-shadow-[0_0_15px_rgba(6,182,212,0.5)]"></i>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black mb-4 bg-clip-text text-transparent bg-gradient-to-r from-violet-400 via-fuchsia-400 to-cyan-400">
                            H·ª¢P CH·∫§T V√î C∆†
                        </h1>
                        <p class="text-slate-400 max-w-lg text-lg mb-8">
                            Kh√°m ph√° th·∫ø gi·ªõi c·ªßa <span class="text-red-400 font-bold">Acid</span>, <span class="text-blue-400 font-bold">Base</span>, 
                            <span class="text-green-400 font-bold">Mu·ªëi</span> v√† <span class="text-orange-400 font-bold">Ph√¢n b√≥n</span> th√¥ng qua c√°c th√≠ nghi·ªám ·∫£o v√† b√†i t·∫≠p t∆∞∆°ng t√°c.
                        </p>
                        <button onclick="app.load('acid')" class="group px-8 py-3 bg-gradient-to-r from-violet-600 to-cyan-600 rounded-full font-bold text-white shadow-lg hover:shadow-cyan-500/50 transition-all transform hover:-translate-y-1">
                            B·∫Øt ƒë·∫ßu h·ªçc ngay <i class="fa-solid fa-arrow-right ml-2 group-hover:translate-x-1 transition"></i>
                        </button>
                    </div>
                `,
        },
        {
          id: "acid",
          title: "I. Acid (Axit)",
          icon: "fa-lemon", // Sour
          render: () => `
                    <div class="max-w-4xl mx-auto space-y-6 fade-in">
                        <h2 class="text-3xl font-black text-red-400 border-b border-red-500/30 pb-2">I. ACID (AXIT)</h2>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="glass p-6 rounded-2xl">
                                <h3 class="text-xl font-bold text-slate-200 mb-3"><i class="fa-solid fa-dna text-red-500 mr-2"></i> 1. Kh√°i ni·ªám</h3>
                                <ul class="list-disc pl-5 space-y-2 text-slate-300">
                                    <li>Ph√¢n t·ª≠ c√≥ nguy√™n t·ª≠ <b>H</b> li√™n k·∫øt v·ªõi g·ªëc axit.</li>
                                    <li>Tan trong n∆∞·ªõc ph√¢n li ra ion <span class="formula-box">H‚Å∫</span>.</li>
                                    <li>C√¥ng th·ª©c chung: <span class="formula-box">H‚ÇôA</span>.</li>
                                </ul>
                            </div>
                            <div class="glass p-6 rounded-2xl">
                                <h3 class="text-xl font-bold text-slate-200 mb-3"><i class="fa-solid fa-filter text-red-500 mr-2"></i> 4. Ph√¢n lo·∫°i</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between border-b border-slate-700 pb-1">
                                        <span>M·∫°nh</span>
                                        <span class="text-red-300">HCl, HNO‚ÇÉ, H‚ÇÇSO‚ÇÑ</span>
                                    </div>
                                    <div class="flex justify-between border-b border-slate-700 pb-1">
                                        <span>Y·∫øu</span>
                                        <span class="text-red-300">H‚ÇÇS, H‚ÇÇCO‚ÇÉ</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>H·ªØu c∆°</span>
                                        <span class="text-red-300">CH‚ÇÉCOOH</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="glass p-6 rounded-2xl border-l-4 border-red-500">
                            <h3 class="text-xl font-bold text-slate-200 mb-4">3. T√≠nh ch·∫•t h√≥a h·ªçc</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-slate-800/50 p-3 rounded-lg flex items-center gap-3">
                                    <div class="w-8 h-8 rounded bg-red-500/20 text-red-500 flex items-center justify-center font-bold">1</div>
                                    <div>L√†m qu·ª≥ t√≠m h√≥a <b class="text-red-400">ƒê·ªé</b></div>
                                </div>
                                <div class="bg-slate-800/50 p-3 rounded-lg flex items-center gap-3">
                                    <div class="w-8 h-8 rounded bg-red-500/20 text-red-500 flex items-center justify-center font-bold">2</div>
                                    <div>T√°c d·ª•ng Kim lo·∫°i (tr∆∞·ªõc H) ‚Üí Mu·ªëi + H‚ÇÇ</div>
                                </div>
                                <div class="bg-slate-800/50 p-3 rounded-lg flex items-center gap-3">
                                    <div class="w-8 h-8 rounded bg-red-500/20 text-red-500 flex items-center justify-center font-bold">3</div>
                                    <div>T√°c d·ª•ng Baz∆° ‚Üí Mu·ªëi + N∆∞·ªõc</div>
                                </div>
                                <div class="bg-slate-800/50 p-3 rounded-lg flex items-center gap-3">
                                    <div class="w-8 h-8 rounded bg-red-500/20 text-red-500 flex items-center justify-center font-bold">4</div>
                                    <div>T√°c d·ª•ng Oxit Baz∆° ‚Üí Mu·ªëi + N∆∞·ªõc</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `,
        },
        {
          id: "base",
          title: "II. Base (Baz∆°)",
          icon: "fa-soap",
          render: () => `
                    <div class="max-w-4xl mx-auto space-y-6 fade-in">
                        <h2 class="text-3xl font-black text-blue-400 border-b border-blue-500/30 pb-2">II. BASE (BAZ∆†)</h2>
                        
                        <div class="glass p-6 rounded-2xl">
                            <h3 class="text-xl font-bold text-slate-200 mb-3">1. Kh√°i ni·ªám & Ph√¢n lo·∫°i</h3>
                            <p class="mb-4 text-slate-300">H·ª£p ch·∫•t g·ªìm kim lo·∫°i li√™n k·∫øt v·ªõi nh√≥m <span class="formula-box">OH</span>. Dung d·ªãch t·∫°o ion <span class="formula-box">OH‚Åª</span>.</p>
                            
                            <div class="grid grid-cols-2 gap-4 text-center">
                                <div class="bg-blue-500/10 p-4 rounded-xl border border-blue-500/30">
                                    <div class="font-bold text-blue-400 text-lg mb-1">Ki·ªÅm (Tan)</div>
                                    <div class="text-sm text-slate-400">NaOH, KOH, Ba(OH)‚ÇÇ, Ca(OH)‚ÇÇ</div>
                                    <div class="text-xs text-slate-500 mt-1 italic">"Khi N√†o Ba C·∫ßn"</div>
                                </div>
                                <div class="bg-slate-700/30 p-4 rounded-xl border border-slate-600">
                                    <div class="font-bold text-slate-300 text-lg mb-1">Kh√¥ng Tan</div>
                                    <div class="text-sm text-slate-400">Cu(OH)‚ÇÇ, Fe(OH)‚ÇÉ, Mg(OH)‚ÇÇ</div>
                                    <div class="text-xs text-slate-500 mt-1">B·ªã nhi·ªát ph√¢n h·ªßy</div>
                                </div>
                            </div>
                        </div>

                        <div class="glass p-6 rounded-2xl border-l-4 border-blue-500">
                            <h3 class="text-xl font-bold text-slate-200 mb-4">3. T√≠nh ch·∫•t h√≥a h·ªçc ƒë·∫∑c tr∆∞ng</h3>
                            <ul class="space-y-3">
                                <li class="flex items-center gap-3">
                                    <span class="w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-xs">A</span>
                                    <span>L√†m qu·ª≥ t√≠m h√≥a <b class="text-blue-400">XANH</b>.</span>
                                </li>
                                <li class="flex items-center gap-3">
                                    <span class="w-6 h-6 rounded-full bg-pink-500 flex items-center justify-center text-xs">B</span>
                                    <span>Phenolphthalein kh√¥ng m√†u ‚Üí <b class="text-pink-400">H·ªíNG</b> (ch·ªâ v·ªõi Ki·ªÅm).</span>
                                </li>
                                <li class="flex items-center gap-3">
                                    <span class="w-6 h-6 rounded-full bg-slate-600 flex items-center justify-center text-xs">C</span>
                                    <span>T√°c d·ª•ng v·ªõi Axit (Ph·∫£n ·ª©ng trung h√≤a) ‚Üí Mu·ªëi + N∆∞·ªõc.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                `,
        },
        {
          id: "ph_sim",
          title: "III. M√¥ ph·ªèng pH",
          icon: "fa-eye-dropper",
          script: "initPhSim",
          render: () => `
                    <div class="max-w-4xl mx-auto fade-in">
                         <h2 class="text-3xl font-black text-purple-400 mb-6">III. THANG ƒêO pH</h2>
                         
                         <div class="grid md:grid-cols-2 gap-8 items-center glass p-8 rounded-3xl">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-bold mb-4 text-slate-300">K√©o thanh tr∆∞·ª£t ƒë·ªÉ thay ƒë·ªïi ƒë·ªô pH:</label>
                                    <input type="range" min="0" max="14" value="7" step="0.5" id="ph-slider" class="w-full h-3 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-purple-500">
                                    <div class="flex justify-between text-xs text-slate-500 mt-2 font-mono">
                                        <span class="text-red-500">0 (Acid)</span>
                                        <span class="text-green-500">7 (Trung t√≠nh)</span>
                                        <span class="text-blue-500">14 (Base)</span>
                                    </div>
                                </div>
                                
                                <div class="bg-slate-900/80 p-6 rounded-2xl border border-slate-700 text-center relative overflow-hidden">
                                    <div class="text-xs text-slate-500 uppercase tracking-widest mb-1">Gi√° tr·ªã pH</div>
                                    <div id="ph-val" class="text-6xl font-black text-white z-10 relative">7.0</div>
                                    <div id="ph-env" class="mt-2 inline-block px-4 py-1 rounded-full text-sm font-bold bg-green-500/20 text-green-400">Trung t√≠nh</div>
                                    <div class="mt-4 pt-4 border-t border-slate-700">
                                        <span class="text-slate-400 text-sm italic block mb-1">V√≠ d·ª• th·ª±c t·∫ø:</span>
                                        <span id="ph-ex" class="font-bold text-white text-lg">N∆∞·ªõc tinh khi·∫øt</span>
                                    </div>
                                </div>
                            </div>

                            <div class="relative flex justify-center items-end h-[350px]">
                                <canvas id="ph-canvas" width="250" height="300" class="relative z-10"></canvas>
                                <div class="absolute top-10 right-10 text-4xl animate-bounce text-slate-600"><i class="fa-solid fa-flask"></i></div>
                            </div>
                         </div>

                         <div class="mt-6 grid grid-cols-3 gap-4 text-center text-sm">
                             <div class="glass p-3 rounded-lg"><span class="text-red-400 font-bold">pH < 7</span>: M√¥i tr∆∞·ªùng Acid</div>
                             <div class="glass p-3 rounded-lg"><span class="text-green-400 font-bold">pH = 7</span>: Trung t√≠nh</div>
                             <div class="glass p-3 rounded-lg"><span class="text-blue-400 font-bold">pH > 7</span>: M√¥i tr∆∞·ªùng Baz∆°</div>
                         </div>
                    </div>
                `,
        },
        {
          id: "oxide_game",
          title: "IV. Oxide (Game)",
          icon: "fa-cubes-stacked",
          script: "initDragDrop",
          render: () => `
                    <div class="h-full flex flex-col fade-in">
                        <div class="text-center mb-6">
                            <h2 class="text-3xl font-black text-orange-400">IV. PH√ÇN LO·∫†I OXIDE</h2>
                            <p class="text-slate-400">K√©o c√°c c√¥ng th·ª©c h√≥a h·ªçc v√†o ƒë√∫ng gi·ªè ph√¢n lo·∫°i!</p>
                        </div>

                        <div class="glass p-4 rounded-xl mb-8 min-h-[80px] flex flex-wrap gap-4 justify-center items-center" id="drag-source">
                            </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 flex-1">
                            <div class="drop-zone glass rounded-2xl p-4 flex flex-col items-center justify-start relative group" data-type="acid">
                                <i class="fa-solid fa-cloud text-4xl text-red-500/30 mb-2 group-hover:text-red-500 transition"></i>
                                <h3 class="font-bold text-red-400">Oxit Axit</h3>
                                <p class="text-xs text-slate-500 mb-4 text-center">(Th∆∞·ªùng l√† phi kim)</p>
                                <div class="dropped-items w-full space-y-2"></div>
                            </div>
                            
                            <div class="drop-zone glass rounded-2xl p-4 flex flex-col items-center justify-start relative group" data-type="base">
                                <i class="fa-solid fa-gem text-4xl text-blue-500/30 mb-2 group-hover:text-blue-500 transition"></i>
                                <h3 class="font-bold text-blue-400">Oxit Baz∆°</h3>
                                <p class="text-xs text-slate-500 mb-4 text-center">(Th∆∞·ªùng l√† kim lo·∫°i)</p>
                                <div class="dropped-items w-full space-y-2"></div>
                            </div>

                            <div class="drop-zone glass rounded-2xl p-4 flex flex-col items-center justify-start relative group" data-type="ampho">
                                <i class="fa-solid fa-scale-balanced text-4xl text-purple-500/30 mb-2 group-hover:text-purple-500 transition"></i>
                                <h3 class="font-bold text-purple-400">L∆∞·ª°ng t√≠nh</h3>
                                <p class="text-xs text-slate-500 mb-4 text-center">(T√°c d·ª•ng c·∫£ 2)</p>
                                <div class="dropped-items w-full space-y-2"></div>
                            </div>

                            <div class="drop-zone glass rounded-2xl p-4 flex flex-col items-center justify-start relative group" data-type="neutral">
                                <i class="fa-solid fa-ban text-4xl text-slate-500/30 mb-2 group-hover:text-slate-400 transition"></i>
                                <h3 class="font-bold text-slate-400">Trung t√≠nh</h3>
                                <p class="text-xs text-slate-500 mb-4 text-center">(Kh√¥ng t√°c d·ª•ng)</p>
                                <div class="dropped-items w-full space-y-2"></div>
                            </div>
                        </div>

                        <div id="game-feedback" class="h-10 text-center font-bold text-lg mt-4"></div>
                    </div>
                `,
        },
        {
          id: "salt_fert",
          title: "V-VI. Mu·ªëi & Ph√¢n b√≥n",
          icon: "fa-seedling",
          render: () => `
                    <div class="max-w-4xl mx-auto space-y-8 fade-in">
                        <div class="glass p-6 rounded-2xl border-l-4 border-green-500">
                            <h2 class="text-2xl font-black text-green-400 mb-4">V. MU·ªêI</h2>
                            <p class="mb-4 text-slate-300">H·ª£p ch·∫•t g·ªìm cation kim lo·∫°i (ho·∫∑c NH‚ÇÑ‚Å∫) v√† anion g·ªëc axit.</p>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="bg-slate-800 p-3 rounded border border-slate-700">
                                    <div class="font-bold text-green-300">Ph·∫£n ·ª©ng t·∫°o mu·ªëi</div>
                                    <ul class="list-disc pl-5 text-sm text-slate-400 mt-2 space-y-1">
                                        <li>Axit + Baz∆°</li>
                                        <li>Axit + Oxit baz∆°</li>
                                        <li>Baz∆° + Oxit axit</li>
                                        <li>Mu·ªëi + Mu·ªëi (trao ƒë·ªïi)</li>
                                    </ul>
                                </div>
                                <div class="bg-slate-800 p-3 rounded border border-slate-700">
                                    <div class="font-bold text-green-300">V√≠ d·ª•</div>
                                    <div class="flex flex-wrap gap-2 mt-2">
                                        <span class="px-2 py-1 bg-white/10 rounded text-xs font-mono">NaCl</span>
                                        <span class="px-2 py-1 bg-white/10 rounded text-xs font-mono">CaCO‚ÇÉ</span>
                                        <span class="px-2 py-1 bg-white/10 rounded text-xs font-mono">KNO‚ÇÉ</span>
                                        <span class="px-2 py-1 bg-white/10 rounded text-xs font-mono">BaSO‚ÇÑ (‚Üì)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h2 class="text-2xl font-black text-yellow-400 mb-4">VI. PH√ÇN B√ìN H√ìA H·ªåC</h2>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="glass p-4 rounded-xl text-center hover:bg-slate-800 transition cursor-help relative group">
                                    <div class="text-4xl font-black text-white mb-2">N</div>
                                    <div class="font-bold text-yellow-400">Ph√¢n ƒê·∫°m</div>
                                    <p class="text-sm text-slate-400 mt-2">K√≠ch th√≠ch l√°, sinh tr∆∞·ªüng.</p>
                                    <div class="absolute inset-0 border-2 border-yellow-400 rounded-xl opacity-0 group-hover:opacity-100 transition"></div>
                                </div>
                                <div class="glass p-4 rounded-xl text-center hover:bg-slate-800 transition cursor-help relative group">
                                    <div class="text-4xl font-black text-white mb-2">P</div>
                                    <div class="font-bold text-orange-400">Ph√¢n L√¢n</div>
                                    <p class="text-sm text-slate-400 mt-2">K√≠ch th√≠ch r·ªÖ, c·ªß, qu·∫£.</p>
                                    <div class="absolute inset-0 border-2 border-orange-400 rounded-xl opacity-0 group-hover:opacity-100 transition"></div>
                                </div>
                                <div class="glass p-4 rounded-xl text-center hover:bg-slate-800 transition cursor-help relative group">
                                    <div class="text-4xl font-black text-white mb-2">K</div>
                                    <div class="font-bold text-purple-400">Ph√¢n Kali</div>
                                    <p class="text-sm text-slate-400 mt-2">TƒÉng s·ª©c ƒë·ªÅ kh√°ng, c·ª©ng c√¢y.</p>
                                    <div class="absolute inset-0 border-2 border-purple-400 rounded-xl opacity-0 group-hover:opacity-100 transition"></div>
                                </div>
                            </div>
                            <div class="mt-4 text-center text-slate-500 text-sm">
                                <i class="fa-solid fa-triangle-exclamation mr-1"></i> Nguy√™n t·∫Øc: ƒê√∫ng lo·∫°i - ƒê√∫ng li·ªÅu - ƒê√∫ng l√∫c - ƒê√∫ng c√°ch.
                            </div>
                        </div>
                    </div>
                `,
        },
        {
          id: "quiz",
          title: "Luy·ªán t·∫≠p",
          icon: "fa-clipboard-question",
          script: "initQuiz",
          render: () => `
                    <div class="max-w-3xl mx-auto fade-in pb-20">
                        <div class="text-center mb-8">
                            <h2 class="text-3xl font-black text-white mb-2">B√ÄI KI·ªÇM TRA NHANH</h2>
                            <p class="text-slate-400">H√£y ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t cho c√°c c√¢u h·ªèi sau.</p>
                        </div>
                        <div id="quiz-container" class="space-y-6">
                            </div>
                        <div class="mt-8 text-center">
                            <button onclick="submitQuiz()" class="px-10 py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-xl shadow-lg transition transform active:scale-95">
                                N·ªôp b√†i & Xem ƒëi·ªÉm
                            </button>
                        </div>
                        <div id="quiz-result" class="hidden mt-6 text-center glass p-6 rounded-xl animate-bounce"></div>
                    </div>
                `,
        },
      ];

      /* --- APP ENGINE --- */
      const app = {
        activeSim: null,
        score: 0,
        load: (id) => {
          // Clear animation frames
          if (app.activeSim) cancelAnimationFrame(app.activeSim);

          const lesson = lessons.find((l) => l.id === id);
          if (!lesson) return;

          // Render Content
          document.getElementById("content-area").innerHTML = lesson.render();

          // Update Nav UI
          document.querySelectorAll(".nav-item").forEach((el) => {
            el.classList.remove("active");
            el.classList.add("text-slate-400", "hover:bg-slate-800");
          });
          const activeNav = document.getElementById(`nav-${id}`);
          if (activeNav) {
            activeNav.classList.add("active");
            activeNav.classList.remove("text-slate-400", "hover:bg-slate-800");
          }

          // Run Scripts
          if (lesson.script && window[lesson.script]) {
            setTimeout(() => window[lesson.script](), 100);
          }

          playSound("pop");
        },
        init: () => {
          const nav = document.getElementById("nav-menu");
          nav.innerHTML = lessons
            .map(
              (l) => `
                    <button id="nav-${l.id}" onclick="app.load('${l.id}')" 
                        class="nav-item w-full text-left p-3 rounded-xl flex items-center gap-3 transition-all duration-200 text-slate-400 hover:bg-slate-800">
                        <div class="w-8 flex justify-center"><i class="fa-solid ${l.icon}"></i></div>
                        <span class="font-semibold text-sm">${l.title}</span>
                    </button>
                `
            )
            .join("");

          // Start at Intro
          app.load("intro");
        },
        addScore: (points) => {
          app.score += points;
          const el = document.getElementById("total-score");
          el.innerText = app.score;
          el.parentElement.classList.add("bg-slate-700");
          setTimeout(
            () => el.parentElement.classList.remove("bg-slate-700"),
            200
          );
        },
      };

      /* --- SOUND EFFECTS --- */
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      function playSound(type) {
        if (audioCtx.state === "suspended") audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        const now = audioCtx.currentTime;
        if (type === "pop") {
          osc.type = "sine";
          osc.frequency.setValueAtTime(600, now);
          osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
          gain.gain.setValueAtTime(0.1, now);
          gain.gain.linearRampToValueAtTime(0, now + 0.1);
          osc.start(now);
          osc.stop(now + 0.1);
        } else if (type === "correct") {
          osc.type = "triangle";
          osc.frequency.setValueAtTime(400, now);
          osc.frequency.linearRampToValueAtTime(800, now + 0.1);
          gain.gain.setValueAtTime(0.1, now);
          gain.gain.linearRampToValueAtTime(0, now + 0.3);
          osc.start(now);
          osc.stop(now + 0.3);
        } else if (type === "wrong") {
          osc.type = "sawtooth";
          osc.frequency.setValueAtTime(150, now);
          osc.frequency.linearRampToValueAtTime(100, now + 0.2);
          gain.gain.setValueAtTime(0.1, now);
          gain.gain.linearRampToValueAtTime(0, now + 0.3);
          osc.start(now);
          osc.stop(now + 0.3);
        }
      }

      /* --- SCRIPT: pH SIMULATION --- */
      function initPhSim() {
        const canvas = document.getElementById("ph-canvas");
        const ctx = canvas.getContext("2d");
        const slider = document.getElementById("ph-slider");
        const valDisplay = document.getElementById("ph-val");
        const envDisplay = document.getElementById("ph-env");
        const exDisplay = document.getElementById("ph-ex");

        let bubbles = [];
        for (let i = 0; i < 15; i++)
          bubbles.push({
            x: Math.random() * 200 + 25,
            y: Math.random() * 300,
            r: Math.random() * 4 + 1,
            s: Math.random() + 0.5,
          });

        function getInfo(ph) {
          if (ph < 3)
            return { c: "#ef4444", t: "Acid M·∫°nh", e: "Axit trong ·∫Øc quy" };
          if (ph < 7)
            return { c: "#f97316", t: "Acid Y·∫øu", e: "N∆∞·ªõc chanh, C√† ph√™" };
          if (ph == 7)
            return { c: "#22c55e", t: "Trung t√≠nh", e: "N∆∞·ªõc tinh khi·∫øt" };
          if (ph < 11)
            return { c: "#3b82f6", t: "Base Y·∫øu", e: "X√† ph√≤ng, Baking soda" };
          return { c: "#8b5cf6", t: "Base M·∫°nh", e: "Thu·ªëc t·∫©y, Th√¥ng c·ªëng" };
        }

        function draw() {
          const ph = parseFloat(slider.value);
          const info = getInfo(ph);

          // Update Text
          valDisplay.innerText = ph;
          envDisplay.innerText = info.t;
          envDisplay.style.color = info.c;
          envDisplay.style.backgroundColor = info.c + "33"; // 20% opacity
          exDisplay.innerText = info.e;

          // Draw Beaker
          ctx.clearRect(0, 0, canvas.width, canvas.height);

          // Liquid
          ctx.fillStyle = info.c + "cc"; // 80% opacity
          const liquidH = 220;
          ctx.fillRect(25, 300 - liquidH, 200, liquidH);

          // Bubbles
          ctx.fillStyle = "rgba(255,255,255,0.3)";
          bubbles.forEach((b) => {
            b.y -= b.s;
            if (b.y < 300 - liquidH) b.y = 290;
            ctx.beginPath();
            ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
            ctx.fill();
          });

          // Glass Container
          ctx.strokeStyle = "rgba(255,255,255,0.5)";
          ctx.lineWidth = 5;
          ctx.strokeRect(25, 50, 200, 250);

          // Ticks
          ctx.fillStyle = "rgba(255,255,255,0.5)";
          for (let i = 1; i <= 4; i++) {
            ctx.fillRect(180, 300 - i * 40, 45, 2);
          }

          app.activeSim = requestAnimationFrame(draw);
        }
        draw();
        slider.oninput = () => playSound("pop");
      }

      /* --- SCRIPT: DRAG & DROP GAME --- */
      function initDragDrop() {
        const items = [
          { id: "i1", txt: "CO‚ÇÇ", type: "acid" },
          { id: "i2", txt: "SO‚ÇÇ", type: "acid" },
          { id: "i3", txt: "Na‚ÇÇO", type: "base" },
          { id: "i4", txt: "CaO", type: "base" },
          { id: "i5", txt: "ZnO", type: "ampho" },
          { id: "i6", txt: "Al‚ÇÇO‚ÇÉ", type: "ampho" },
          { id: "i7", txt: "NO", type: "neutral" },
          { id: "i8", txt: "CO", type: "neutral" },
        ];

        const source = document.getElementById("drag-source");
        const zones = document.querySelectorAll(".drop-zone");
        const feedback = document.getElementById("game-feedback");

        // Render Draggables
        source.innerHTML = items
          .map(
            (i) => `
                <div draggable="true" id="${i.id}" data-type="${i.type}" 
                     class="draggable px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded shadow border border-slate-500 text-white font-bold cursor-grab">
                    ${i.txt}
                </div>
            `
          )
          .join("");

        // Add Event Listeners
        const draggables = document.querySelectorAll(".draggable");
        draggables.forEach((d) => {
          d.addEventListener("dragstart", (e) => {
            e.dataTransfer.setData(
              "text/plain",
              JSON.stringify({
                id: d.id,
                type: d.dataset.type,
                txt: d.innerText,
              })
            );
            d.classList.add("opacity-50");
          });
          d.addEventListener("dragend", () => d.classList.remove("opacity-50"));
        });

        zones.forEach((zone) => {
          zone.addEventListener("dragover", (e) => {
            e.preventDefault();
            zone.classList.add("drag-over");
          });
          zone.addEventListener("dragleave", () =>
            zone.classList.remove("drag-over")
          );
          zone.addEventListener("drop", (e) => {
            e.preventDefault();
            zone.classList.remove("drag-over");
            const data = JSON.parse(e.dataTransfer.getData("text/plain"));

            if (zone.dataset.type === data.type) {
              // Correct
              const el = document.getElementById(data.id);
              if (el) {
                el.parentNode.removeChild(el);
                const newEl = document.createElement("div");
                newEl.className =
                  "px-3 py-1 bg-green-500/20 text-green-400 border border-green-500 rounded text-sm font-bold text-center";
                newEl.innerText = data.txt;
                zone.querySelector(".dropped-items").appendChild(newEl);

                app.addScore(10);
                playSound("correct");
                feedback.innerHTML =
                  '<span class="text-green-400">Ch√≠nh x√°c! +10 ƒëi·ªÉm</span>';
                confetti({ particleCount: 30, spread: 50, origin: { y: 0.7 } });
              }
            } else {
              playSound("wrong");
              feedback.innerHTML =
                '<span class="text-red-400">Sai r·ªìi! Th·ª≠ l·∫°i nh√©.</span>';
            }
          });
        });
      }

      /* --- SCRIPT: QUIZ --- */
      const quizData = [
        {
          q: "Dung d·ªãch n√†o l√†m qu·ª≥ t√≠m h√≥a ƒë·ªè?",
          a: ["NaOH", "HCl", "NaCl", "H‚ÇÇO"],
          correct: 1,
        },
        {
          q: "Baz∆° n√†o sau ƒë√¢y KH√îNG tan trong n∆∞·ªõc?",
          a: ["NaOH", "KOH", "Cu(OH)‚ÇÇ", "Ba(OH)‚ÇÇ"],
          correct: 2,
        },
        {
          q: "pH = 12 th·ªÉ hi·ªán m√¥i tr∆∞·ªùng g√¨?",
          a: ["Acid m·∫°nh", "Trung t√≠nh", "Base m·∫°nh", "Acid y·∫øu"],
          correct: 2,
        },
        {
          q: "Oxit n√†o t√°c d·ª•ng ƒë∆∞·ª£c v·ªõi c·∫£ Acid v√† Base?",
          a: ["ZnO", "CaO", "SO‚ÇÇ", "CO"],
          correct: 0,
        },
        {
          q: "Ph√¢n ƒê·∫°m cung c·∫•p nguy√™n t·ªë dinh d∆∞·ª°ng n√†o?",
          a: ["Nit∆° (N)", "Photpho (P)", "Kali (K)", "L∆∞u hu·ª≥nh (S)"],
          correct: 0,
        },
      ];

      function initQuiz() {
        const container = document.getElementById("quiz-container");
        container.innerHTML = quizData
          .map(
            (item, idx) => `
                <div class="glass p-6 rounded-xl border border-slate-700">
                    <p class="font-bold text-lg mb-4 text-white"><span class="text-cyan-400">C√¢u ${
                      idx + 1
                    }:</span> ${item.q}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        ${item.a
                          .map(
                            (opt, optIdx) => `
                            <button class="quiz-opt p-3 rounded-lg border border-slate-600 text-left text-slate-300 transition" 
                                onclick="selectOpt(${idx}, ${optIdx}, this)">${String.fromCharCode(
                              65 + optIdx
                            )}. ${opt}</button>
                        `
                          )
                          .join("")}
                    </div>
                </div>
            `
          )
          .join("");
      }

      let userAnswers = {};
      window.selectOpt = (qIdx, optIdx, btn) => {
        userAnswers[qIdx] = optIdx;
        // Visual selection
        const parent = btn.parentElement;
        Array.from(parent.children).forEach((c) => {
          c.classList.remove(
            "bg-violet-600",
            "border-violet-400",
            "text-white"
          );
          c.classList.add("border-slate-600");
        });
        btn.classList.add("bg-violet-600", "border-violet-400", "text-white");
        btn.classList.remove("border-slate-600");
        playSound("pop");
      };

      window.submitQuiz = () => {
        let score = 0;
        const resultDiv = document.getElementById("quiz-result");

        quizData.forEach((item, idx) => {
          const buttons = document.querySelectorAll(
            `#quiz-container > div:nth-child(${idx + 1}) button`
          );

          // Reset styles
          buttons.forEach((b) =>
            b.classList.remove("correct", "wrong", "bg-violet-600")
          );

          if (userAnswers[idx] === item.correct) {
            score++;
            buttons[item.correct].classList.add("correct");
          } else {
            if (userAnswers[idx] !== undefined)
              buttons[userAnswers[idx]].classList.add("wrong");
            buttons[item.correct].classList.add("correct"); // Show right answer
          }
        });

        app.addScore(score * 20); // 20 points per question

        resultDiv.classList.remove("hidden");
        resultDiv.innerHTML = `
                <h3 class="text-2xl font-black mb-2 text-white">K·∫øt qu·∫£: ${score}/${
          quizData.length
        }</h3>
                <p class="text-slate-300">${
                  score === 5
                    ? "Tuy·ªát v·ªùi! B·∫°n l√† thi√™n t√†i h√≥a h·ªçc! üèÜ"
                    : "H√£y c·ªë g·∫Øng h∆°n l·∫ßn sau nh√©!"
                }</p>
            `;

        if (score >= 4) {
          playSound("correct");
          confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        } else {
          playSound("pop");
        }
      };

      // START APP
      window.onload = app.init;
    </script>
  </body>
</html>
