<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Ch·ªß ƒë·ªÅ 2: Ph√¢n T·ª≠ & Li√™n K·∫øt H√≥a H·ªçc - L·ªõp 7 | EduChem</title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />

    <!-- LIBRARIES -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;900&family=Patrick+Hand&display=swap"
      rel="stylesheet"
    />
    <script src="atom.js"></script>
    <script src="misson.js"></script>
    <!-- CONFIG & STYLES -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["'Be Vietnam Pro'", "sans-serif"],
              hand: ["'Patrick Hand'", "cursive"],
            },
            colors: {
              chem: {
                dark: "#0f172a",
                light: "#f8fafc",
                primary: "#6366f1", // Indigo
                accent: "#0ea5e9", // Sky
                ion: "#ef4444", // Red
                covalent: "#22c55e", // Green
              },
            },
            animation: {
              float: "float 6s ease-in-out infinite",
              "pulse-slow": "pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            },
            keyframes: {
              float: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-15px)" },
              },
            },
          },
        },
      };
    </script>
    <style>
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #94a3b8;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
      }
      .dark .glass-panel {
        background: rgba(15, 23, 42, 0.75);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .neon-text {
        text-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
      }

      body {
        -webkit-tap-highlight-color: transparent;
        overflow-x: hidden;
      }
    </style>
  </head>
  <body
    class="bg-chem-light dark:bg-chem-dark text-slate-800 dark:text-slate-100 transition-colors duration-300"
  >
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useMemo } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { createIcons } = window.lucide;
      // --- UTILS ---
      const playSound = (type) => {
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (!AudioContext) return;
        const ctx = new AudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        const now = ctx.currentTime;

        if (type === "click") {
          osc.frequency.setValueAtTime(800, now);
          gain.gain.setValueAtTime(0.05, now);
          gain.gain.exponentialRampToValueAtTime(0.001, now + 0.05);
          osc.start(now);
          osc.stop(now + 0.05);
        } else if (type === "success") {
          osc.type = "sine";
          osc.frequency.setValueAtTime(500, now);
          osc.frequency.exponentialRampToValueAtTime(1000, now + 0.1);
          gain.gain.setValueAtTime(0.1, now);
          gain.gain.linearRampToValueAtTime(0, now + 0.5);
          osc.start(now);
          osc.stop(now + 0.5);
        } else if (type === "error") {
          osc.type = "sawtooth";
          osc.frequency.setValueAtTime(150, now);
          osc.frequency.linearRampToValueAtTime(100, now + 0.2);
          gain.gain.setValueAtTime(0.1, now);
          gain.gain.linearRampToValueAtTime(0, now + 0.2);
          osc.start(now);
          osc.stop(now + 0.2);
        }
      };

      // --- COMPONENTS NH·ªé ---

      const AtomIcon = ({ type, size = "md", className = "" }) => {
        const data = ATOMS[type] || ATOMS["H"];
        const sizeClasses = {
          sm: "w-8 h-8 text-xs border-b-2",
          md: "w-12 h-12 text-base border-b-4",
          lg: "w-16 h-16 text-xl border-b-4",
          xl: "w-24 h-24 text-3xl border-b-8",
        };

        return (
          <motion.div
            whileHover={{ scale: 1.1, rotate: 5 }}
            whileTap={{ scale: 0.9 }}
            className={`rounded-full flex items-center justify-center font-bold shadow-lg ${data.color} ${sizeClasses[size]} ${className}`}
          >
            {data.symbol}
          </motion.div>
        );
      };

      const Card = ({ children, title, className = "", delay = 0 }) => (
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay, duration: 0.4 }}
          className={`glass-panel rounded-2xl p-6 shadow-xl ${className}`}
        >
          {title && (
            <h3 className="text-xl font-bold mb-4 text-chem-primary dark:text-chem-accent font-sans border-b border-gray-200 dark:border-gray-700 pb-2">
              {title}
            </h3>
          )}
          {children}
        </motion.div>
      );

      const QuizAccordion = ({ question, answer }) => {
        const [isOpen, setIsOpen] = useState(false);
        return (
          <div className="border border-slate-300 dark:border-slate-600 rounded-lg overflow-hidden mt-4 bg-white/50 dark:bg-slate-800/50">
            <button
              onClick={() => setIsOpen(!isOpen)}
              className="w-full flex justify-between items-center p-4 text-left font-bold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition"
            >
              <span>{question}</span>
              <i
                data-lucide={isOpen ? "chevron-up" : "chevron-down"}
                className="w-5 h-5"
              ></i>
            </button>
            <AnimatePresence>
              {isOpen && (
                <motion.div
                  initial={{ height: 0, opacity: 0 }}
                  animate={{ height: "auto", opacity: 1 }}
                  exit={{ height: 0, opacity: 0 }}
                  className="border-t border-slate-200 dark:border-slate-700"
                >
                  <div className="p-4 bg-green-50 dark:bg-green-900/20 text-slate-700 dark:text-slate-300 text-sm">
                    <strong>ƒê√°p √°n:</strong> {answer}
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        );
      };

      // --- TAB 1: L√ù THUY·∫æT & M√î PH·ªéNG (THEORY) ---
      const TheoryTab = () => {
        const [activeSection, setActiveSection] = useState("molecule"); // molecule, bonding, valency

        // Component con: M√¥ ph·ªèng li√™n k·∫øt Ion
        const IonicSim = () => {
          const [step, setStep] = useState(0);
          return (
            <div className="bg-slate-100 dark:bg-slate-800 rounded-xl p-4 md:p-8 flex flex-col items-center my-4">
              <h4 className="font-bold text-lg mb-4 text-chem-ion">
                M√¥ ph·ªèng: Li√™n k·∫øt ION (Na - Cl)
              </h4>
              <div className="h-48 w-full flex items-center justify-center gap-12 relative">
                <div className="flex flex-col items-center gap-2 relative">
                  <AtomIcon type="Na" size="lg" />
                  <div className="absolute -top-2 -right-2 w-4 h-4 bg-yellow-400 rounded-full shadow-lg z-10 animate-bounce">
                    e
                  </div>
                  <span className="font-bold">Kim lo·∫°i (Cho e)</span>
                </div>
                <AnimatePresence>
                  {step === 1 && (
                    <motion.div
                      initial={{ left: "30%", top: "30%" }}
                      animate={{ left: "65%", top: "30%" }}
                      transition={{ duration: 1.5, ease: "easeInOut" }}
                      className="absolute w-6 h-6 bg-yellow-400 rounded-full shadow-[0_0_10px_yellow] z-20 flex items-center justify-center text-[10px] font-bold"
                    >
                      e-
                    </motion.div>
                  )}
                </AnimatePresence>
                <div className="flex flex-col items-center gap-2">
                  <AtomIcon type="Cl" size="lg" />
                  <span className="font-bold">Phi kim (Nh·∫≠n e)</span>
                </div>
              </div>
              <div className="mt-4 text-center">
                {step === 0 && (
                  <button
                    onClick={() => setStep(1)}
                    className="bg-chem-ion text-white px-6 py-2 rounded-full font-bold shadow-lg hover:scale-105 transition"
                  >
                    Cho Electron!
                  </button>
                )}
                {step === 1 && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    onAnimationComplete={() =>
                      setTimeout(() => setStep(2), 2000)
                    }
                    className="text-lg font-bold text-yellow-500"
                  >
                    ƒêang chuy·ªÉn giao electron...
                  </motion.div>
                )}
                {step === 2 && (
                  <motion.div
                    initial={{ scale: 0.8 }}
                    animate={{ scale: 1 }}
                    className="flex flex-col items-center gap-2"
                  >
                    <div className="flex gap-1 items-center bg-white/10 p-4 rounded-xl border border-chem-ion">
                      <div className="text-center">
                        <div className="font-bold text-chem-ion text-xl">
                          Na‚Å∫
                        </div>
                      </div>
                      <div className="text-2xl text-slate-400">‚ô•</div>
                      <div className="text-center">
                        <div className="font-bold text-chem-ion text-xl">
                          Cl‚Åª
                        </div>
                      </div>
                    </div>
                    <p className="text-sm mt-2">
                      H√∫t nhau b·∫±ng l·ª±c tƒ©nh ƒëi·ªán -> T·∫°o NaCl
                    </p>
                    <button
                      onClick={() => setStep(0)}
                      className="mt-2 text-sm text-slate-500 underline"
                    >
                      L√†m l·∫°i
                    </button>
                  </motion.div>
                )}
              </div>
            </div>
          );
        };

        // Component con: M√¥ ph·ªèng li√™n k·∫øt C·ªông h√≥a tr·ªã
        const CovalentSim = () => {
          const [shared, setShared] = useState(false);
          return (
            <div className="bg-slate-100 dark:bg-slate-800 rounded-xl p-4 md:p-8 flex flex-col items-center mt-6">
              <h4 className="font-bold text-lg mb-4 text-chem-covalent">
                M√¥ ph·ªèng: C·ªông h√≥a tr·ªã (H - H)
              </h4>
              <div className="h-40 w-full flex items-center justify-center relative">
                <motion.div
                  animate={{ x: shared ? 20 : -50 }}
                  className="absolute"
                >
                  <AtomIcon
                    type="H"
                    size="lg"
                    className="border-chem-covalent"
                  />
                </motion.div>
                <motion.div
                  animate={{ x: shared ? -20 : 50 }}
                  className="absolute"
                >
                  <AtomIcon
                    type="H"
                    size="lg"
                    className="border-chem-covalent"
                  />
                </motion.div>
                <AnimatePresence>
                  {shared && (
                    <motion.div
                      initial={{ opacity: 0, scale: 0 }}
                      animate={{ opacity: 1, scale: 1 }}
                      className="absolute z-10 bg-yellow-400/30 w-16 h-8 rounded-full border-2 border-yellow-400 flex items-center justify-center gap-1"
                    >
                      <div className="w-2 h-2 bg-yellow-600 rounded-full"></div>
                      <div className="w-2 h-2 bg-yellow-600 rounded-full"></div>
                    </motion.div>
                  )}
                </AnimatePresence>
              </div>
              <div className="mt-4 text-center">
                <button
                  onClick={() => setShared(!shared)}
                  className={`px-6 py-2 rounded-full font-bold shadow-lg transition hover:scale-105 ${
                    shared
                      ? "bg-slate-500 text-white"
                      : "bg-chem-covalent text-white"
                  }`}
                >
                  {shared ? "T√°ch ra" : "G√≥p chung (G√≥p g·∫°o)"}
                </button>
              </div>
            </div>
          );
        };

        // Component con: H√≥a tr·ªã (Hands)
        const ValencyHands = () => {
          const examples = [
            { atom: "H", hands: 1 },
            { atom: "O", hands: 2 },
            { atom: "N", hands: 3 },
            { atom: "C", hands: 4 },
          ];
          return (
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              {examples.map((item) => (
                <div
                  key={item.atom}
                  className="bg-white/50 dark:bg-slate-700/50 p-4 rounded-xl flex flex-col items-center"
                >
                  <AtomIcon type={item.atom} size="md" />
                  <div className="mt-2 font-bold text-lg">
                    H√≥a tr·ªã {item.hands}
                  </div>
                  <div className="text-xs text-slate-500 mb-2">
                    C√≥ {item.hands} tay v·ªãn
                  </div>
                  <div className="flex gap-1">
                    {[...Array(item.hands)].map((_, i) => (
                      <div
                        key={i}
                        className="w-2 h-6 bg-chem-accent rounded-full animate-pulse"
                        title="1 li√™n k·∫øt"
                      ></div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          );
        };

        return (
          <div className="pb-24">
            {/* Sub-nav */}
            <div className="flex overflow-x-auto gap-2 mb-6 pb-2 no-scrollbar">
              <button
                onClick={() => setActiveSection("molecule")}
                className={`whitespace-nowrap px-4 py-2 rounded-xl font-bold transition border border-transparent ${
                  activeSection === "molecule"
                    ? "bg-chem-primary text-white shadow-lg"
                    : "bg-white dark:bg-slate-800 hover:border-chem-primary"
                }`}
              >
                I. Ph√¢n t·ª≠ & Ch·∫•t
              </button>
              <button
                onClick={() => setActiveSection("bonding")}
                className={`whitespace-nowrap px-4 py-2 rounded-xl font-bold transition border border-transparent ${
                  activeSection === "bonding"
                    ? "bg-chem-primary text-white shadow-lg"
                    : "bg-white dark:bg-slate-800 hover:border-chem-primary"
                }`}
              >
                II. Li√™n k·∫øt h√≥a h·ªçc
              </button>
              <button
                onClick={() => setActiveSection("valency")}
                className={`whitespace-nowrap px-4 py-2 rounded-xl font-bold transition border border-transparent ${
                  activeSection === "valency"
                    ? "bg-chem-primary text-white shadow-lg"
                    : "bg-white dark:bg-slate-800 hover:border-chem-primary"
                }`}
              >
                III. H√≥a tr·ªã & CT
              </button>
            </div>

            <AnimatePresence mode="wait">
              {/* SECTION I: MOLECULE, SIMPLE SUBSTANCE, COMPOUND */}
              {activeSection === "molecule" && (
                <motion.div
                  key="molecule"
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: 20 }}
                >
                  <Card title="1. Ph√¢n t·ª≠ (Molecules)">
                    <div className="space-y-4">
                      <div>
                        <h4 className="font-bold text-chem-accent">
                          a. Kh√°i ni·ªám
                        </h4>
                        <p>
                          Ph√¢n t·ª≠ l√† h·∫°t nh·ªè nh·∫•t c·ªßa m·ªôt ch·∫•t gi·ªØ nguy√™n{" "}
                          <strong>t√≠nh ch·∫•t h√≥a h·ªçc</strong> c·ªßa ch·∫•t ƒë√≥. Ph√¢n
                          t·ª≠ ƒë∆∞·ª£c t·∫°o b·ªüi m·ªôt hay nhi·ªÅu nguy√™n t·ª≠ li√™n k·∫øt v·ªõi
                          nhau.
                        </p>
                      </div>
                      <div>
                        <h4 className="font-bold text-chem-accent">
                          b. ƒê·∫∑c ƒëi·ªÉm
                        </h4>
                        <ul className="list-disc pl-5 text-sm space-y-1">
                          <li>
                            C√°c nguy√™n t·ª≠ trong ph√¢n t·ª≠ ƒë∆∞·ª£c gh√©p l·∫°i b·∫±ng li√™n
                            k·∫øt h√≥a h·ªçc.
                          </li>
                          <li>
                            <strong>Ph√¢n t·ª≠ kh·ªëi (M)</strong> = T·ªïng kh·ªëi l∆∞·ª£ng
                            nguy√™n t·ª≠ c·ªßa c√°c nguy√™n t·ªë t·∫°o n√™n n√≥.
                          </li>
                        </ul>
                      </div>
                      <div className="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm border-l-4 border-blue-500">
                        <span className="font-bold">V√≠ d·ª•:</span> N∆∞·ªõc (H‚ÇÇO),
                        Oxi (O‚ÇÇ), Cacbon ƒëioxit (CO‚ÇÇ), Amoniac (NH‚ÇÉ).
                      </div>
                      <div className="text-xs text-slate-500 italic">
                        üí° Em c√≥ bi·∫øt? 1 gi·ªçt n∆∞·ªõc ch·ª©a kho·∫£ng 10¬≤¬π ph√¢n t·ª≠ n∆∞·ªõc
                        ‚Äì con s·ªë kh·ªïng l·ªì v∆∞·ª£t xa s·ªë h·∫°t c√°t tr√™n Tr√°i ƒê·∫•t!
                      </div>
                    </div>
                  </Card>

                  <div className="grid md:grid-cols-2 gap-4 mt-4">
                    <Card title="2. ƒê∆°n ch·∫•t">
                      <p className="mb-2">
                        L√† ch·∫•t ƒë∆∞·ª£c t·∫°o b·ªüi{" "}
                        <strong>1 nguy√™n t·ªë h√≥a h·ªçc</strong>.
                      </p>
                      <div className="flex flex-wrap gap-2 justify-center">
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <AtomIcon type="O" size="sm" className="mx-auto" />
                          <div className="text-xs font-bold mt-1">
                            O‚ÇÇ (Kh√≠ oxi)
                          </div>
                        </div>
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <AtomIcon type="Fe" size="sm" className="mx-auto" />
                          <div className="text-xs font-bold mt-1">Fe (S·∫Øt)</div>
                        </div>
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <AtomIcon type="Cu" size="sm" className="mx-auto" />
                          <div className="text-xs font-bold mt-1">
                            Cu (ƒê·ªìng)
                          </div>
                        </div>
                      </div>
                    </Card>
                    <Card title="3. H·ª£p ch·∫•t">
                      <p className="mb-2">
                        L√† ch·∫•t ƒë∆∞·ª£c t·∫°o b·ªüi{" "}
                        <strong>2 nguy√™n t·ªë tr·ªü l√™n</strong> li√™n k·∫øt v·ªõi nhau
                        theo t·ªâ l·ªá x√°c ƒë·ªãnh.
                      </p>
                      <div className="flex flex-wrap gap-2 justify-center">
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <div className="flex -space-x-1 justify-center">
                            <AtomIcon type="H" size="sm" />
                            <AtomIcon type="O" size="sm" />
                          </div>
                          <div className="text-xs font-bold mt-1">H‚ÇÇO</div>
                        </div>
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <div className="flex -space-x-1 justify-center">
                            <AtomIcon type="Na" size="sm" />
                            <AtomIcon type="Cl" size="sm" />
                          </div>
                          <div className="text-xs font-bold mt-1">NaCl</div>
                        </div>
                        <div className="text-center p-2 bg-slate-100 dark:bg-slate-800 rounded">
                          <div className="flex -space-x-1 justify-center">
                            <AtomIcon type="C" size="sm" />
                            <AtomIcon type="O" size="sm" />
                          </div>
                          <div className="text-xs font-bold mt-1">CO‚ÇÇ</div>
                        </div>
                      </div>
                    </Card>
                  </div>

                  <Card
                    title="B√†i t·∫≠p luy·ªán t·∫≠p (B·∫•m ƒë·ªÉ xem ƒë√°p √°n)"
                    className="mt-4 border-2 border-chem-primary/20"
                  >
                    <QuizAccordion
                      question="1. Ph√¢n lo·∫°i c√°c ch·∫•t sau th√†nh ƒë∆°n ch·∫•t v√† h·ª£p ch·∫•t: O‚ÇÇ, Fe, CO‚ÇÇ, Cu, NH‚ÇÉ, Cl‚ÇÇ"
                      answer={
                        <ul className="list-disc pl-5">
                          <li>
                            <strong>ƒê∆°n ch·∫•t:</strong> O‚ÇÇ, Fe, Cu, Cl‚ÇÇ (T·∫°o t·ª´ 1
                            nguy√™n t·ªë).
                          </li>
                          <li>
                            <strong>H·ª£p ch·∫•t:</strong> CO‚ÇÇ, NH‚ÇÉ (T·∫°o t·ª´ 2 nguy√™n
                            t·ªë tr·ªü l√™n).
                          </li>
                        </ul>
                      }
                    />
                    <QuizAccordion
                      question="2. Ph√¢n t·ª≠ H‚ÇÇSO‚ÇÑ c√≥ bao nhi√™u nguy√™n t·ª≠? Bao nhi√™u nguy√™n t·ªë?"
                      answer="C√≥ 3 nguy√™n t·ªë (H, S, O). T·ªïng s·ªë nguy√™n t·ª≠ = 2(H) + 1(S) + 4(O) = 7 nguy√™n t·ª≠."
                    />
                    <QuizAccordion
                      question="3. So s√°nh ph√¢n t·ª≠ ƒë∆°n ch·∫•t O‚ÇÇ v√† ph√¢n t·ª≠ h·ª£p ch·∫•t H‚ÇÇO."
                      answer="O‚ÇÇ ƒë∆∞·ª£c t·∫°o t·ª´ 2 nguy√™n t·ª≠ c·ªßa c√πng 1 nguy√™n t·ªë Oxi. H‚ÇÇO ƒë∆∞·ª£c t·∫°o t·ª´ 2 nguy√™n t·ª≠ Hidro v√† 1 nguy√™n t·ª≠ Oxi (2 nguy√™n t·ªë kh√°c nhau)."
                    />
                  </Card>
                </motion.div>
              )}

              {/* SECTION II: CHEMICAL BONDING */}
              {activeSection === "bonding" && (
                <motion.div
                  key="bonding"
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: 20 }}
                >
                  <Card title="1. V·ªè nguy√™n t·ª≠ kh√≠ hi·∫øm & Quy t·∫Øc b·ªÅn v·ªØng">
                    <p>
                      C√°c nguy√™n t·ª≠ kh√≠ hi·∫øm (He, Ne, Ar...) c√≥ l·ªõp electron
                      ngo√†i c√πng ƒë√£ b√£o h√≤a (2 ho·∫∑c 8e) ‚Üí r·∫•t b·ªÅn v·ªØng.
                    </p>
                    <p className="mt-2 text-sm bg-yellow-100 dark:bg-yellow-900/30 p-2 rounded">
                      üëâ <strong>Quy t·∫Øc b·ªÅn v·ªØng (Octet):</strong> Nguy√™n t·ª≠ c√≥
                      xu h∆∞·ªõng Nh∆∞·ªùng, Nh·∫≠n ho·∫∑c Chung electron ƒë·ªÉ ƒë·∫°t c·∫•u h√¨nh
                      8e (ho·∫∑c 2e) gi·ªëng kh√≠ hi·∫øm.
                    </p>
                  </Card>

                  <Card title="2. Li√™n k·∫øt Ion" className="mt-4">
                    <h4 className="font-bold text-chem-ion">
                      a. Kh√°i ni·ªám & C√°ch h√¨nh th√†nh
                    </h4>
                    <p className="text-sm mb-2">
                      H√¨nh th√†nh do l·ª±c h√∫t tƒ©nh ƒëi·ªán gi·ªØa ion d∆∞∆°ng v√† ion √¢m.
                    </p>
                    <ul className="list-disc pl-5 text-sm mb-4">
                      <li>Kim lo·∫°i nh∆∞·ªùng e ‚Üí Ion d∆∞∆°ng (Cation).</li>
                      <li>Phi kim nh·∫≠n e ‚Üí Ion √¢m (Anion).</li>
                    </ul>
                    <p className="font-bold text-sm">
                      V√≠ d·ª•: Na + Cl ‚Üí Na‚Å∫ + Cl‚Åª ‚Üí NaCl
                    </p>
                    <IonicSim />
                  </Card>

                  <Card title="3. Li√™n k·∫øt C·ªông h√≥a tr·ªã" className="mt-4">
                    <h4 className="font-bold text-chem-covalent">
                      a. Kh√°i ni·ªám & V√≠ d·ª•
                    </h4>
                    <p className="text-sm mb-2">
                      H√¨nh th√†nh do s·ª± <strong>d√πng chung</strong> m·ªôt hay nhi·ªÅu
                      c·∫∑p electron gi·ªØa hai nguy√™n t·ª≠ phi kim.
                    </p>
                    <div className="grid grid-cols-2 gap-2 text-sm mb-4">
                      <div className="bg-slate-100 dark:bg-slate-800 p-2 rounded">
                        H‚ÇÇ: D√πng chung 1 c·∫∑p e
                      </div>
                      <div className="bg-slate-100 dark:bg-slate-800 p-2 rounded">
                        O‚ÇÇ: D√πng chung 2 c·∫∑p e
                      </div>
                    </div>
                    <CovalentSim />
                  </Card>

                  <Card
                    title="4. So s√°nh Ch·∫•t Ion & Ch·∫•t C·ªông h√≥a tr·ªã"
                    className="mt-4"
                  >
                    <div className="overflow-x-auto">
                      <table className="w-full text-sm text-left">
                        <thead>
                          <tr className="bg-slate-200 dark:bg-slate-700">
                            <th className="p-2">ƒê·∫∑c ƒëi·ªÉm</th>
                            <th className="p-2 text-chem-ion">
                              Ch·∫•t Ion (NaCl, CaO...)
                            </th>
                            <th className="p-2 text-chem-covalent">
                              Ch·∫•t CHT (H‚ÇÇO, CO‚ÇÇ...)
                            </th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-slate-200 dark:divide-slate-700">
                          <tr>
                            <td className="p-2 font-bold">Tr·∫°ng th√°i</td>
                            <td className="p-2">R·∫Øn tinh th·ªÉ</td>
                            <td className="p-2">R·∫Øn, l·ªèng ho·∫∑c kh√≠</td>
                          </tr>
                          <tr>
                            <td className="p-2 font-bold">ƒê·ªô tan</td>
                            <td className="p-2">D·ªÖ tan trong n∆∞·ªõc</td>
                            <td className="p-2">√çt tan (ƒëa s·ªë)</td>
                          </tr>
                          <tr>
                            <td className="p-2 font-bold">D·∫´n ƒëi·ªán</td>
                            <td className="p-2">C√≥ (khi n√≥ng ch·∫£y/tan)</td>
                            <td className="p-2">Kh√¥ng (v√¨ kh√¥ng c√≥ ion)</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </Card>

                  <Card
                    title="B√†i t·∫≠p luy·ªán t·∫≠p"
                    className="mt-4 border-2 border-chem-primary/20"
                  >
                    <QuizAccordion
                      question="1. Ho√†n th√†nh qu√° tr√¨nh t·∫°o NaCl t·ª´ Na v√† Cl."
                      answer="Na nh∆∞·ªùng 1e th√†nh Na‚Å∫. Cl nh·∫≠n 1e th√†nh Cl‚Åª. Hai ion tr√°i d·∫•u h√∫t nhau t·∫°o th√†nh tinh th·ªÉ NaCl."
                    />
                    <QuizAccordion
                      question="2. H‚ÇÇO thu·ªôc lo·∫°i ch·∫•t g√¨? V√¨ sao?"
                      answer="H‚ÇÇO l√† ch·∫•t c·ªông h√≥a tr·ªã. V√¨ li√™n k·∫øt gi·ªØa H v√† O ƒë∆∞·ª£c h√¨nh th√†nh do s·ª± d√πng chung electron (kh√¥ng ph·∫£i cho nh·∫≠n)."
                    />
                    <QuizAccordion
                      question="3. Trong c√°c ch·∫•t: CO‚ÇÇ, KCl, CaO, CH‚ÇÑ, O‚ÇÇ ‚Äì ch·∫•t n√†o l√† ch·∫•t ion?"
                      answer="Ch·∫•t ion th∆∞·ªùng t·∫°o b·ªüi Kim lo·∫°i v√† Phi kim. ƒê√°p √°n: KCl, CaO."
                    />
                  </Card>
                </motion.div>
              )}

              {/* SECTION III: VALENCY & FORMULA */}
              {activeSection === "valency" && (
                <motion.div
                  key="valency"
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: 20 }}
                >
                  <Card title="1. H√≥a tr·ªã (Valency)">
                    <p className="mb-4">
                      H√≥a tr·ªã bi·ªÉu th·ªã kh·∫£ nƒÉng li√™n k·∫øt c·ªßa nguy√™n t·ª≠ nguy√™n t·ªë
                      n√†y v·ªõi nguy√™n t·ª≠ nguy√™n t·ªë kh√°c. (Quy ∆∞·ªõc: H=I, O=II).
                    </p>
                    <ValencyHands />
                  </Card>

                  <Card
                    title="2. Quy t·∫Øc h√≥a tr·ªã & C√¥ng th·ª©c h√≥a h·ªçc"
                    className="mt-4"
                  >
                    <div className="bg-yellow-50 dark:bg-yellow-900/20 p-4 border-l-4 border-yellow-500 rounded-r mb-4">
                      <h4 className="font-bold text-yellow-700 dark:text-yellow-400">
                        Quy t·∫Øc ch√©o
                      </h4>
                      <div className="flex items-center justify-around text-center my-2">
                        <div>
                          <div className="text-xl font-bold">Al</div>
                          <div className="text-sm text-red-500 font-bold">
                            III
                          </div>
                        </div>
                        <div className="text-2xl text-slate-300">‚ùå</div>
                        <div>
                          <div className="text-xl font-bold">O</div>
                          <div className="text-sm text-red-500 font-bold">
                            II
                          </div>
                        </div>
                      </div>
                      <p className="text-center font-bold text-lg">‚ûú Al‚ÇÇO‚ÇÉ</p>
                      <p className="text-xs text-center text-slate-500 mt-1">
                        (H√≥a tr·ªã c·ªßa Al l√†m ch·ªâ s·ªë c·ªßa O v√† ng∆∞·ª£c l·∫°i)
                      </p>
                    </div>

                    <div className="space-y-4">
                      <h4 className="font-bold text-chem-accent">
                        3. C√¥ng th·ª©c h√≥a h·ªçc
                      </h4>
                      <p className="text-sm">
                        Cho bi·∫øt: Nguy√™n t·ªë t·∫°o n√™n ch·∫•t, s·ªë nguy√™n t·ª≠ m·ªói lo·∫°i,
                        v√† ph√¢n t·ª≠ kh·ªëi.
                      </p>
                      <h4 className="font-bold text-chem-accent">
                        4. T√≠nh % Nguy√™n t·ªë
                      </h4>
                      <div className="bg-slate-100 dark:bg-slate-800 p-3 rounded font-mono text-sm text-center">
                        %X = (M_nguy√™n_t·ª≠ * s·ªë_l∆∞·ª£ng / M_h·ª£p_ch·∫•t) * 100%
                      </div>
                      <div className="text-sm">
                        <strong>V√≠ d·ª•: %O trong H‚ÇÇO (M=18)</strong>
                        <br />
                        %O = (16 * 1 / 18) * 100% = 88.9%
                      </div>
                    </div>
                  </Card>

                  <Card
                    title="B√†i t·∫≠p luy·ªán t·∫≠p"
                    className="mt-4 border-2 border-chem-primary/20"
                  >
                    <QuizAccordion
                      question="1. X√°c ƒë·ªãnh h√≥a tr·ªã c·ªßa N trong NH‚ÇÉ."
                      answer="H c√≥ h√≥a tr·ªã I. C√¥ng th·ª©c NH‚ÇÉ ‚Üí 1 x H√≥a tr·ªã(N) = 3 x I ‚Üí H√≥a tr·ªã c·ªßa N l√† III."
                    />
                    <QuizAccordion
                      question="2. L·∫≠p c√¥ng th·ª©c h√≥a h·ªçc c·ªßa: Ca (II) v√† Cl (I); Al (III) v√† O (II)."
                      answer={
                        <ul className="list-disc pl-5">
                          <li>Ca(II) v√† Cl(I) ‚Üí ch√©o ‚Üí CaCl‚ÇÇ.</li>
                          <li>Al(III) v√† O(II) ‚Üí ch√©o ‚Üí Al‚ÇÇO‚ÇÉ.</li>
                        </ul>
                      }
                    />
                    <QuizAccordion
                      question="3. T√≠nh % nguy√™n t·ªë C trong CO‚ÇÇ (M=44)."
                      answer="Trong CO‚ÇÇ c√≥ 1 nguy√™n t·ª≠ C (M=12). %C = (12 / 44) * 100% ‚âà 27.27%."
                    />
                  </Card>

                  <div className="mt-4 p-4 text-center text-slate-500 text-sm">
                    <h4 className="font-bold text-chem-primary uppercase mb-2">
                      M·ªü r·ªông - T√¨m hi·ªÉu th√™m
                    </h4>
                    <p>
                      Li√™n k·∫øt kim lo·∫°i (t·∫°o ƒë·ªô d·∫ªo, d·∫´n ƒëi·ªán) ‚Ä¢ Ph√¢n t·ª≠ ph√¢n
                      c·ª±c ‚Ä¢ Li√™n k·∫øt ƒë√¥i/ba trong O‚ÇÇ, N‚ÇÇ.
                    </p>
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        );
      };

      // --- TAB 2: LAB (L·∫ÆP GH√âP PH√ÇN T·ª¨ - GAME 1) ---
      const LabTab = () => {
        const [bench, setBench] = useState([]);
        const [target, setTarget] = useState(MISSIONS[0]);
        const [success, setSuccess] = useState(false);

        const addToBench = (type) => {
          if (success) return;
          setBench([...bench, type]);
          playSound("click");
        };

        const clearBench = () => {
          setBench([]);
          setSuccess(false);
          playSound("click");
        };

        const checkResult = () => {
          const currentCounts = {};
          bench.forEach(
            (a) => (currentCounts[a] = (currentCounts[a] || 0) + 1)
          );

          const targetCounts = target.recipe;

          // Check consistency
          const keys1 = Object.keys(currentCounts).sort();
          const keys2 = Object.keys(targetCounts).sort();

          if (JSON.stringify(keys1) !== JSON.stringify(keys2)) return false;

          for (let k of keys1) {
            if (currentCounts[k] !== targetCounts[k]) return false;
          }
          return true;
        };

        useEffect(() => {
          if (checkResult()) {
            setSuccess(true);
            playSound("success");
            confetti({
              particleCount: 150,
              spread: 70,
              origin: { y: 0.6 },
              colors: ["#6366f1", "#0ea5e9", "#ef4444"],
            });
          }
        }, [bench]);

        const nextMission = () => {
          const nextId = target.id < MISSIONS.length ? target.id + 1 : 1;
          setTarget(MISSIONS.find((m) => m.id === nextId));
          setBench([]);
          setSuccess(false);
        };

        return (
          <div className="h-full flex flex-col pb-20">
            {/* Target Card */}
            <Card className="mb-4 relative overflow-hidden bg-gradient-to-r from-slate-900 to-slate-800 !text-white !p-4">
              <div className="flex justify-between items-start z-10 relative">
                <div>
                  <div className="text-xs uppercase tracking-widest text-slate-400 mb-1">
                    Nhi·ªám v·ª• {target.id}/{MISSIONS.length}
                  </div>
                  <h2 className="text-2xl font-bold text-chem-accent">
                    {target.name}
                  </h2>
                  <div className="text-4xl font-mono font-bold mt-2">
                    {target.formula}
                  </div>
                </div>
                <div className="text-right">
                  <div className="text-xs text-slate-300 max-w-[150px]">
                    {target.desc}
                  </div>
                  <div className="mt-2 text-xs font-bold px-2 py-1 bg-white/20 rounded inline-block">
                    {target.type}
                  </div>
                </div>
              </div>
              {/* Visual hint */}
              <div className="absolute -right-4 -bottom-4 opacity-10 rotate-12">
                <AtomIcon type="C" size="xl" />
              </div>
            </Card>

            {/* Workspace */}
            <div
              className="flex-1 glass-panel rounded-2xl relative border-2 border-dashed border-slate-400/30 flex items-center justify-center transition-all duration-500 overflow-hidden"
              style={{ borderColor: success ? "#22c55e" : "" }}
            >
              {bench.length === 0 && !success && (
                <div className="text-slate-400 text-center animate-pulse">
                  <i
                    data-lucide="flask-conical"
                    className="w-8 h-8 mx-auto mb-2"
                  ></i>
                  Th√™m nguy√™n t·ª≠ v√†o ƒë√¢y...
                </div>
              )}

              {/* Atoms in Workspace */}
              <div className="flex flex-wrap justify-center items-center gap-2 p-4 z-10 relative">
                <AnimatePresence>
                  {bench.map((type, i) => (
                    <motion.div
                      key={`${type}-${i}`}
                      initial={{ scale: 0, rotate: 180 }}
                      animate={{ scale: 1, rotate: 0 }}
                      exit={{ scale: 0 }}
                      onClick={() => {
                        if (success) return;
                        const newBench = [...bench];
                        newBench.splice(i, 1);
                        setBench(newBench);
                      }}
                      className="cursor-pointer"
                    >
                      <AtomIcon type={type} size="md" />
                    </motion.div>
                  ))}
                </AnimatePresence>

                {/* Bonding lines visualization (simple) */}
                {bench.length > 1 && !success && (
                  <div className="absolute inset-0 pointer-events-none flex items-center justify-center opacity-30">
                    <div className="w-full h-1 bg-slate-500 rounded-full blur-sm"></div>
                  </div>
                )}
              </div>

              {/* Success Overlay */}
              {success && (
                <motion.div
                  initial={{ y: 50, opacity: 0 }}
                  animate={{ y: 0, opacity: 1 }}
                  className="absolute bottom-0 left-0 right-0 bg-chem-dark/90 backdrop-blur text-white p-6 rounded-t-2xl z-20 text-center border-t-4 border-green-500"
                >
                  <h3 className="text-2xl font-bold text-green-400 mb-2">
                    üéâ Ch·∫ø t·∫°o th√†nh c√¥ng!
                  </h3>
                  <p className="text-slate-300 mb-4">
                    {target.name} ({target.formula}) ƒë√£ ƒë∆∞·ª£c t·∫°o ra.
                  </p>
                  <button
                    onClick={nextMission}
                    className="bg-green-500 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-green-600 transition w-full md:w-auto"
                  >
                    Ti·∫øp t·ª•c{" "}
                    <i
                      data-lucide="arrow-right"
                      className="w-4 h-4 inline ml-2"
                    ></i>
                  </button>
                </motion.div>
              )}
            </div>

            {/* Inventory / Palette */}
            <div className="mt-4 overflow-x-auto pb-2 no-scrollbar">
              <div className="flex gap-3 px-1 min-w-max">
                {/* Show relevant atoms first, then others */}
                {Object.keys(target.recipe).map((key) => (
                  <button
                    key={key}
                    onClick={() => addToBench(key)}
                    className="group flex flex-col items-center"
                  >
                    <AtomIcon
                      type={key}
                      size="md"
                      className="shadow-none border-2 scale-90 group-hover:scale-100 transition"
                    />
                    <span className="text-xs font-bold mt-1 text-chem-accent">
                      {key}
                    </span>
                  </button>
                ))}
                <div className="w-px bg-slate-300 dark:bg-slate-700 mx-2"></div>
                {Object.keys(ATOMS)
                  .filter((k) => !target.recipe[k])
                  .slice(0, 5)
                  .map((key) => (
                    <button
                      key={key}
                      onClick={() => addToBench(key)}
                      className="group flex flex-col items-center opacity-60 hover:opacity-100"
                    >
                      <AtomIcon
                        type={key}
                        size="sm"
                        className="shadow-none border-2 scale-90"
                      />
                    </button>
                  ))}

                <button
                  onClick={clearBench}
                  className="ml-4 flex flex-col items-center justify-center text-red-500 hover:text-red-600"
                >
                  <div className="w-10 h-10 rounded-full border-2 border-red-500 flex items-center justify-center">
                    <i data-lucide="trash-2" className="w-5 h-5"></i>
                  </div>
                  <span className="text-xs font-bold mt-1">X√≥a</span>
                </button>
              </div>
            </div>
          </div>
        );
      };

      // --- TAB 3: TR√í CH∆†I PH√ÇN LO·∫†I (GAME 2) ---
      const GameTab = () => {
        const [qIdx, setQIdx] = useState(0);
        const [score, setScore] = useState(0);
        const [status, setStatus] = useState("playing"); // playing, correct, wrong, finished
        const currentQ = MISSIONS[qIdx];

        const handleAnswer = (ans) => {
          if (status !== "playing") return;
          const isCorrect = ans === currentQ.type;

          if (isCorrect) {
            setScore((s) => s + 10);
            setStatus("correct");
            playSound("success");
          } else {
            setStatus("wrong");
            playSound("error");
          }

          setTimeout(() => {
            if (qIdx < MISSIONS.length - 1) {
              setQIdx((i) => i + 1);
              setStatus("playing");
            } else {
              setStatus("finished");
            }
          }, 1500);
        };

        const restart = () => {
          setQIdx(0);
          setScore(0);
          setStatus("playing");
        };

        if (status === "finished") {
          return (
            <div className="flex flex-col items-center justify-center h-full text-center">
              <i
                data-lucide="trophy"
                className="w-24 h-24 text-yellow-400 mb-4 animate-bounce"
              ></i>
              <h2 className="text-3xl font-bold mb-2">Ho√†n th√†nh!</h2>
              <p className="text-xl mb-6">
                ƒêi·ªÉm s·ªë:{" "}
                <span className="text-chem-primary font-bold">{score}</span> /{" "}
                {MISSIONS.length * 10}
              </p>
              <button
                onClick={restart}
                className="bg-chem-primary text-white px-6 py-3 rounded-xl font-bold shadow-lg flex items-center gap-2"
              >
                <i data-lucide="rotate-ccw" className="w-4 h-4"></i> Ch∆°i l·∫°i
              </button>
            </div>
          );
        }

        return (
          <div className="flex flex-col items-center h-full pt-8 max-w-lg mx-auto">
            <div className="w-full flex justify-between items-center mb-8 px-4">
              <div className="text-sm font-bold bg-slate-200 dark:bg-slate-700 px-3 py-1 rounded-full">
                C√¢u {qIdx + 1}/{MISSIONS.length}
              </div>
              <div className="text-xl font-mono font-bold text-chem-primary">
                Score: {score}
              </div>
            </div>

            <div className="relative w-full px-4">
              <AnimatePresence mode="wait">
                <motion.div
                  key={currentQ.id}
                  initial={{ scale: 0.8, opacity: 0 }}
                  animate={{ scale: 1, opacity: 1 }}
                  exit={{ scale: 0.8, opacity: 0 }}
                  className={`glass-panel p-8 rounded-3xl text-center shadow-2xl border-2 transition-colors duration-300 ${
                    status === "correct"
                      ? "border-green-500 bg-green-500/10"
                      : status === "wrong"
                      ? "border-red-500 bg-red-500/10"
                      : "border-slate-300 dark:border-slate-600"
                  }`}
                >
                  <div className="text-6xl font-mono font-bold mb-2">
                    {currentQ.formula}
                  </div>
                  <div className="text-xl text-slate-500 dark:text-slate-400 font-hand">
                    {currentQ.name}
                  </div>

                  {status !== "playing" && (
                    <div
                      className={`mt-4 font-bold text-lg ${
                        status === "correct" ? "text-green-500" : "text-red-500"
                      }`}
                    >
                      {status === "correct"
                        ? "CH√çNH X√ÅC! üéâ"
                        : `SAI R·ªíI! L√† ${currentQ.type}`}
                    </div>
                  )}
                </motion.div>
              </AnimatePresence>
            </div>

            <div className="grid grid-cols-2 gap-4 w-full px-4 mt-8">
              <button
                onClick={() => handleAnswer("ƒê∆°n ch·∫•t")}
                disabled={status !== "playing"}
                className="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-2xl text-xl font-bold shadow-lg hover:scale-105 active:scale-95 transition flex flex-col items-center gap-2"
              >
                <i data-lucide="circle-dot" className="w-8 h-8 opacity-50"></i>
                ƒê∆°n ch·∫•t
              </button>
              <button
                onClick={() => handleAnswer("H·ª£p ch·∫•t")}
                disabled={status !== "playing"}
                className="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-2xl text-xl font-bold shadow-lg hover:scale-105 active:scale-95 transition flex flex-col items-center gap-2"
              >
                <i data-lucide="component" className="w-8 h-8 opacity-50"></i>
                H·ª£p ch·∫•t
              </button>
            </div>

            <p className="mt-8 text-center text-sm text-slate-400 px-8">
              G·ª£i √Ω: ƒê∆°n ch·∫•t t·∫°o t·ª´ 1 nguy√™n t·ªë (O‚ÇÇ, Fe...). H·ª£p ch·∫•t t·∫°o t·ª´ 2
              nguy√™n t·ªë tr·ªü l√™n (H‚ÇÇO, NaCl...).
            </p>
          </div>
        );
      };

      // --- TAB 4: M√ÅY T√çNH KH·ªêI L∆Ø·ª¢NG (TOOLS) ---
      const ToolTab = () => {
        const [search, setSearch] = useState("");

        const filtered = useMemo(() => {
          if (!search) return MISSIONS;
          return MISSIONS.filter(
            (m) =>
              m.formula.toLowerCase().includes(search.toLowerCase()) ||
              m.name.toLowerCase().includes(search.toLowerCase())
          );
        }, [search]);

        const calcM = (recipe) => {
          let total = 0;
          let details = [];
          for (let [atom, count] of Object.entries(recipe)) {
            const mass = ATOMS[atom].mass;
            total += mass * count;
            details.push(`${count}√ó${mass}(${atom})`);
          }
          return { total, details: details.join(" + ") };
        };

        return (
          <div className="pb-24 max-w-2xl mx-auto">
            <div className="glass-panel p-4 rounded-2xl sticky top-0 z-10 mb-6">
              <div className="relative">
                <i
                  data-lucide="search"
                  className="absolute left-3 top-3 text-slate-400"
                ></i>
                <input
                  type="text"
                  placeholder="T√¨m ch·∫•t (VD: N∆∞·ªõc, NaCl...)"
                  value={search}
                  onChange={(e) => setSearch(e.target.value)}
                  className="w-full pl-10 pr-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-chem-primary outline-none transition"
                />
              </div>
            </div>

            <div className="space-y-4">
              {filtered.map((item) => {
                const { total, details } = calcM(item.recipe);
                return (
                  <motion.div
                    key={item.id}
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className="glass-panel p-4 rounded-xl flex items-center justify-between group hover:border-chem-primary transition"
                  >
                    <div className="flex items-center gap-4">
                      <div className="w-12 h-12 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center font-bold text-slate-500">
                        {item.id}
                      </div>
                      <div>
                        <h3 className="font-bold text-lg">
                          {item.name} ({item.formula})
                        </h3>
                        <p className="text-xs text-slate-500 font-mono">
                          {details}
                        </p>
                      </div>
                    </div>
                    <div className="text-right">
                      <div className="text-2xl font-bold text-chem-accent">
                        {total}
                      </div>
                      <div className="text-xs text-slate-400">amu (ƒëvC)</div>
                    </div>
                  </motion.div>
                );
              })}
            </div>

            {filtered.length === 0 && (
              <div className="text-center text-slate-400 mt-10">
                Kh√¥ng t√¨m th·∫•y ch·∫•t n√†o.
              </div>
            )}
          </div>
        );
      };

      // --- MAIN APP SHELL ---
      const App = () => {
        const [tab, setTab] = useState("theory"); // theory, lab, game, tools
        const [dark, setDark] = useState(false);

        useEffect(() => {
          if (window.lucide) createIcons();
        }, [tab]);

        useEffect(() => {
          if (dark) {
            document.documentElement.classList.add("dark");
          } else {
            document.documentElement.classList.remove("dark");
          }
        }, [dark]);

        const tabs = [
          { id: "theory", label: "L√Ω thuy·∫øt", icon: "book-open" },
          { id: "lab", label: "Ph√≤ng TN", icon: "flask-conical" },
          { id: "game", label: "Ph√¢n lo·∫°i", icon: "gamepad-2" },
          { id: "tools", label: "Tra c·ª©u", icon: "calculator" },
        ];

        return (
          <div className="min-h-screen flex flex-col relative overflow-hidden">
            {/* Background Decorations */}
            <div className="fixed top-20 left-10 w-64 h-64 bg-purple-500/20 rounded-full blur-3xl pointer-events-none animate-pulse-slow"></div>
            <div
              className="fixed bottom-20 right-10 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl pointer-events-none animate-pulse-slow"
              style={{ animationDelay: "1s" }}
            ></div>

            {/* Header */}
            <header className="glass-panel sticky top-0 z-50 px-4 py-3 flex items-center justify-between border-b border-white/10">
              <div className="flex items-center gap-3">
                <a
                  href="../chemstudybaby.html"
                  className="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition"
                  title="Quay l·∫°i"
                >
                  <i data-lucide="arrow-left" className="w-5 h-5"></i>
                </a>
                <h1 className="font-bold text-lg md:text-xl bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-purple-600">
                  ChemStudy Baby - h√≥a h·ªçc 7: ch·ªß ƒë·ªÅ 2: Ph√¢n t·ª≠ ƒë∆°n ch·∫•t & h·ª£p
                  ch·∫•t
                </h1>
              </div>

              <button
                onClick={() => setDark(!dark)}
                className="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition"
              >
                {dark ? (
                  <i data-lucide="sun" className="w-5 h-5 text-yellow-400"></i>
                ) : (
                  <i data-lucide="moon" className="w-5 h-5 text-slate-600"></i>
                )}
              </button>
            </header>

            {/* Main Content Area */}
            <main className="flex-1 p-4 md:p-6 container mx-auto max-w-4xl relative z-0">
              <AnimatePresence mode="wait">
                <motion.div
                  key={tab}
                  initial={{ opacity: 0, y: 10 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, y: -10 }}
                  transition={{ duration: 0.3 }}
                  className="h-full"
                >
                  {tab === "theory" && <TheoryTab />}
                  {tab === "lab" && <LabTab />}
                  {tab === "game" && <GameTab />}
                  {tab === "tools" && <ToolTab />}
                </motion.div>
              </AnimatePresence>
            </main>

            {/* Bottom Navigation (Mobile) / Top (Desktop) - simplified as Bottom for app feel */}
            <nav className="fixed bottom-0 left-0 right-0 glass-panel border-t border-white/10 pb-safe pt-2 px-6 flex justify-between md:justify-center md:gap-12 z-50 md:sticky md:bottom-auto md:top-0">
              {tabs.map((t) => (
                <button
                  key={t.id}
                  onClick={() => {
                    setTab(t.id);
                    playSound("click");
                  }}
                  className={`flex flex-col items-center gap-1 p-2 rounded-xl transition duration-300 relative ${
                    tab === t.id
                      ? "text-chem-primary"
                      : "text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
                  }`}
                >
                  <i
                    data-lucide={t.icon}
                    className={`w-6 h-6 transition-transform ${
                      tab === t.id ? "scale-110" : ""
                    }`}
                  ></i>
                  <span className="text-[10px] font-bold uppercase tracking-wider">
                    {t.label}
                  </span>
                  {tab === t.id && (
                    <motion.div
                      layoutId="bubble"
                      className="absolute -top-2 w-1 h-1 bg-chem-primary rounded-full"
                    ></motion.div>
                  )}
                </button>
              ))}
            </nav>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
