<!doctype html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CHƯƠNG 4: HYDROCARBON – ChemStudy Expert</title>
    <link rel="icon" href="../../../favicon/educhem.avg" />

    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Space+Grotesk:wght@500;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "sans-serif"],
              display: ["Space Grotesk", "sans-serif"],
            },
            colors: {
              chem: {
                blue: "#3b82f6",
                purple: "#8b5cf6",
                green: "#10b981",
                dark: "#0f172a",
                light: "#f8fafc",
              },
            },
            animation: {
              "spin-slow": "spin 8s linear infinite",
              float: "floating 3s ease-in-out infinite",
              "pulse-glow":
                "pulseGlow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            },
            keyframes: {
              floating: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-10px)" },
              },
              pulseGlow: {
                "0%, 100%": {
                  opacity: 1,
                  boxShadow: "0 0 20px rgba(59, 130, 246, 0.5)",
                },
                "50%": {
                  opacity: 0.5,
                  boxShadow: "0 0 0px rgba(59, 130, 246, 0)",
                },
              },
            },
          },
        },
      };
    </script>

    <style>
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 10px;
      }
      ::-webkit-scrollbar-track {
        background: #1e293b;
      }
      ::-webkit-scrollbar-thumb {
        background: #475569;
        border-radius: 5px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }

      /* Glassmorphism Utilities */
      .glass-panel {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }

      .dark .glass-panel {
        background: rgba(30, 41, 59, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
      }

      /* Text Gradient */
      .text-gradient {
        background: linear-gradient(to right, #3b82f6, #8b5cf6, #ec4899);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Simulation Specific Styles */
      .atom {
        transition: all 0.5s ease;
      }
      .bond {
        transition: all 0.5s ease;
      }

      /* 3D Model Placeholder Container */
      .molecule-container {
        perspective: 1000px;
        transform-style: preserve-3d;
      }

      /* REQUIRED STYLES FROM PROMPT (FOOTER & PREFS) */
      :root {
        --footer-bg: #0f172a;
        --footer-text: #e2e8f0;
        --p-primary: #3b82f6;
      }
      html.dark :root {
        --footer-bg: #020617;
      }
      .footer-waves {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 60px;
        background: var(--footer-bg);
        clip-path: polygon(
          0% 45%,
          16% 44%,
          33% 50%,
          54% 60%,
          70% 61%,
          84% 59%,
          100% 52%,
          100% 100%,
          0% 100%
        );
        transition: background-color 0.8s;
      }
      footer {
        background: var(--footer-bg);
        color: var(--footer-text);
        padding: 100px 5% 40px;
        position: relative;
        overflow: hidden;
        transition:
          background-color 0.8s ease,
          color 0.8s ease;
      }
      .footer-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 60px;
        max-width: 1200px;
        margin: 0 auto;
      }
      .icon-btn {
        color: #94a3b8;
        font-size: 1.2rem;
        transition: 0.3s;
      }
      .icon-btn:hover {
        color: white;
        transform: scale(1.1);
      }
      .contact-item {
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
        color: #94a3b8;
        transition: 0.3s;
      }
      .contact-item:hover {
        color: white;
        transform: translateX(5px);
      }
      .contact-item i {
        color: var(--p-primary);
      }
      .copyright {
        margin-top: 80px;
        text-align: center;
        padding-top: 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        color: #475569;
        font-size: 0.9rem;
      }
    </style>
  </head>
  <body
    class="bg-chem-light dark:bg-gray-900 text-gray-800 dark:text-gray-100 transition-colors duration-300 font-sans selection:bg-blue-500 selection:text-white"
  >
    <!-- HEADER (CỐ ĐỊNH) -->
    <header
      class="fixed top-0 left-0 w-full z-50 glass-panel border-b border-gray-200 dark:border-gray-800 transition-all duration-300"
      id="main-header"
    >
      <div
        class="container mx-auto px-6 h-20 flex items-center justify-between"
      >
        <!-- Logo -->
        <div
          class="flex items-center gap-3 cursor-pointer group"
          onclick="window.scrollTo(0, 0)"
        >
          <div
            class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-green-500 flex items-center justify-center text-white font-bold text-xl shadow-lg group-hover:shadow-blue-500/50 transition-all"
          >
            <i
              class="fas fa-atom text-2xl md:text-2xl group-hover:animate-spin-slow"
            ></i>
          </div>
          <span
            class="font-display font-bold text-2xl tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-green-600 dark:from-blue-400 dark:to-green-400"
          >
            ChemStudy Expert
          </span>
        </div>

        <!-- Menu Desktop -->
        <nav
          class="hidden md:flex items-center gap-8 font-semibold text-sm uppercase tracking-wider text-gray-600 dark:text-gray-400"
        >
          <a
            href="#alkane"
            class="hover:text-blue-500 transition-colors relative group"
          >
            Alkane
            <span
              class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-500 transition-all group-hover:w-full"
            ></span>
          </a>
          <a
            href="#alkene-alkyne"
            class="hover:text-purple-500 transition-colors relative group"
          >
            Alkene & Alkyne
            <span
              class="absolute -bottom-1 left-0 w-0 h-0.5 bg-purple-500 transition-all group-hover:w-full"
            ></span>
          </a>
          <a
            href="#arene"
            class="hover:text-pink-500 transition-colors relative group"
          >
            Arene
            <span
              class="absolute -bottom-1 left-0 w-0 h-0.5 bg-pink-500 transition-all group-hover:w-full"
            ></span>
          </a>
          <a
            href="#quiz"
            class="hover:text-green-500 transition-colors relative group"
          >
            Luyện tập
            <span
              class="absolute -bottom-1 left-0 w-0 h-0.5 bg-green-500 transition-all group-hover:w-full"
            ></span>
          </a>
        </nav>

        <!-- Dark/Light Button -->
        <button
          id="theme-toggle"
          class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-700 dark:text-yellow-400 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all focus:outline-none ring-2 ring-offset-2 ring-transparent focus:ring-blue-500"
        >
          <i class="fas fa-sun text-xl" id="theme-icon"></i>
        </button>
      </div>
    </header>

    <!-- HERO SECTION -->
    <section
      class="relative min-h-screen flex items-center justify-center pt-20 overflow-hidden"
    >
      <!-- Background Elements -->
      <div
        class="absolute top-20 left-10 w-20 h-20 bg-blue-500/20 rounded-full blur-xl animate-float"
      ></div>
      <div
        class="absolute bottom-40 right-10 w-32 h-32 bg-purple-500/20 rounded-full blur-xl animate-float"
        style="animation-delay: 1s"
      ></div>
      <div
        class="absolute top-1/2 left-1/4 w-10 h-10 bg-green-400/30 rounded-full blur-md animate-pulse"
      ></div>

      <div class="container mx-auto px-4 text-center z-10">
        <div
          class="inline-block px-4 py-2 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 font-bold text-sm mb-6 animate-fadeIn border border-blue-200 dark:border-blue-800"
        >
          <i class="fas fa-flask mr-2"></i> CHƯƠNG 4: HÓA HỌC HỮU CƠ
        </div>

        <h1
          class="font-display text-5xl md:text-7xl font-extrabold mb-6 leading-tight"
        >
          Khám phá thế giới <br />
          <span class="text-gradient">Hydrocarbon</span>
        </h1>

        <p
          class="text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto mb-10 leading-relaxed"
        >
          Từ nhiên liệu hóa thạch đến dược phẩm hiện đại. Trải nghiệm mô hình
          3D, thí nghiệm ảo và bài giảng tương tác để làm chủ Alkane, Alkene,
          Alkyne và Arene.
        </p>

        <div class="flex flex-col md:flex-row gap-4 justify-center">
          <a
            href="#alkane"
            class="px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-full font-bold shadow-lg shadow-blue-500/30 transform hover:-translate-y-1 transition-all flex items-center justify-center gap-2"
          >
            <i class="fas fa-play"></i> Vào bài học ngay
          </a>
          <a
            href="#quiz"
            class="px-8 py-4 glass-panel text-gray-800 dark:text-white rounded-full font-bold hover:bg-white/40 dark:hover:bg-slate-700/50 transform hover:-translate-y-1 transition-all flex items-center justify-center gap-2"
          >
            <i class="fas fa-gamepad"></i> Thử thách
          </a>
        </div>
      </div>

      <!-- Decoration SVG Bottom -->
      <div class="absolute bottom-0 left-0 w-full overflow-hidden leading-none">
        <svg
          class="relative block w-full h-[100px]"
          data-name="Layer 1"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 1200 120"
          preserveAspectRatio="none"
        >
          <path
            d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z"
            class="fill-white dark:fill-gray-900"
          ></path>
        </svg>
      </div>
    </section>

    <!-- MAIN CONTENT -->
    <main class="container mx-auto px-4 pb-20 space-y-32">
      <!-- ==============================================
             SECTION I: ALKANE
             ============================================== -->
      <section id="alkane" class="scroll-mt-24">
        <div class="flex items-center gap-4 mb-10">
          <div
            class="w-12 h-12 rounded-2xl bg-blue-500 flex items-center justify-center text-white text-2xl shadow-lg shadow-blue-500/30"
          >
            <i class="fas fa-cube"></i>
          </div>
          <div>
            <h2
              class="font-display text-4xl font-bold text-gray-900 dark:text-white"
            >
              I. ALKANE (ANE)
            </h2>
            <p class="text-blue-500 font-semibold">Hydrocarbon no, mạch hở</p>
          </div>
        </div>

        <!-- Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <!-- Left: Theory -->
          <div class="lg:col-span-7 space-y-6">
            <!-- A. Lý thuyết -->
            <div class="glass-panel p-6 rounded-2xl border-l-4 border-blue-500">
              <h3
                class="font-display text-xl font-bold mb-4 flex items-center gap-2"
              >
                <i class="fas fa-book-open text-blue-500"></i> A. Kiến thức lý
                thuyết
              </h3>
              <ul class="space-y-3 text-gray-700 dark:text-gray-300">
                <li class="flex items-start gap-2">
                  <i
                    class="fas fa-check-circle mt-1 text-green-500 text-xs"
                  ></i>
                  <span
                    ><strong>Khái niệm:</strong> Hydrocarbon no, mạch hở, chỉ
                    chứa liên kết đơn C-C và C-H. CTTQ:
                    <code
                      class="bg-gray-100 dark:bg-gray-800 px-1 rounded font-mono text-pink-500"
                      >CnH2n+2 (n ≥ 1)</code
                    >.</span
                  >
                </li>
                <li class="flex items-start gap-2">
                  <i
                    class="fas fa-check-circle mt-1 text-green-500 text-xs"
                  ></i>
                  <span
                    ><strong>Đồng phân:</strong> C1-C3 không có đồng phân. Từ C4
                    có đồng phân mạch C (phân nhánh/không phân nhánh). Càng
                    nhiều C, số đồng phân càng tăng nhanh.</span
                  >
                </li>
                <li class="flex items-start gap-2">
                  <i
                    class="fas fa-check-circle mt-1 text-green-500 text-xs"
                  ></i>
                  <span
                    ><strong>Danh pháp:</strong> <br />
                    - Không nhánh: Tiền tố số lượng C + "ane". <br />
                    - Phân nhánh: Vị trí nhánh - Tên nhánh + Tên mạch chính
                    (chọn mạch dài nhất, nhiều nhánh nhất).
                  </span>
                </li>
                <li class="flex items-start gap-2">
                  <i
                    class="fas fa-check-circle mt-1 text-green-500 text-xs"
                  ></i>
                  <span
                    ><strong>Tính chất vật lý:</strong> C1-C4 (khí), C5-C17
                    (lỏng), C18+ (rắn). Nhẹ hơn nước, không tan trong
                    nước.</span
                  >
                </li>
              </ul>
            </div>

            <!-- B. Mô hình & Mô phỏng -->
            <div class="glass-panel p-6 rounded-2xl">
              <h3
                class="font-display text-xl font-bold mb-4 flex items-center gap-2"
              >
                <i class="fas fa-microscope text-purple-500"></i> B. Mô hình &
                Cấu trúc
              </h3>
              <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                Phân tử Methane (CH4) có cấu trúc tứ diện đều. Góc liên kết
                ~109.5°.
              </p>

              <!-- SIMULATION 1: 3D Methane CSS -->
              <div
                class="relative w-full h-64 bg-gray-900 rounded-xl overflow-hidden flex items-center justify-center cursor-pointer group"
                onclick="toggleMethaneRotation()"
              >
                <div
                  class="absolute top-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded"
                >
                  Click to Pause/Play
                </div>

                <!-- CSS 3D Molecule -->
                <div
                  id="methane-molecule"
                  class="relative w-20 h-20 animate-spin-slow"
                  style="transform-style: preserve-3d"
                >
                  <!-- Carbon Center -->
                  <div
                    class="absolute inset-0 m-auto w-12 h-12 bg-gradient-to-br from-gray-700 to-black rounded-full shadow-lg z-10 flex items-center justify-center text-white font-bold text-xs border border-gray-600"
                  >
                    C
                  </div>

                  <!-- Hydrogen 1 (Top) -->
                  <div
                    class="absolute w-8 h-8 bg-gradient-to-br from-white to-gray-300 rounded-full shadow-md flex items-center justify-center text-black font-bold text-[10px]"
                    style="top: -40px; left: 50%; transform: translateX(-50%)"
                  >
                    H
                  </div>
                  <div
                    class="absolute w-1 h-10 bg-gray-400"
                    style="
                      top: -20px;
                      left: 50%;
                      transform: translateX(-50%);
                      z-index: -1;
                    "
                  ></div>

                  <!-- Hydrogen 2 (Bottom Left) -->
                  <div
                    class="absolute w-8 h-8 bg-gradient-to-br from-white to-gray-300 rounded-full shadow-md flex items-center justify-center text-black font-bold text-[10px]"
                    style="bottom: -30px; left: -20px"
                  >
                    H
                  </div>
                  <div
                    class="absolute w-1 h-12 bg-gray-400 origin-top"
                    style="
                      bottom: 10px;
                      left: 50%;
                      transform: rotate(120deg);
                      z-index: -1;
                    "
                  ></div>

                  <!-- Hydrogen 3 (Bottom Right) -->
                  <div
                    class="absolute w-8 h-8 bg-gradient-to-br from-white to-gray-300 rounded-full shadow-md flex items-center justify-center text-black font-bold text-[10px]"
                    style="bottom: -30px; right: -20px"
                  >
                    H
                  </div>
                  <div
                    class="absolute w-1 h-12 bg-gray-400 origin-top"
                    style="
                      bottom: 10px;
                      left: 50%;
                      transform: rotate(-120deg);
                      z-index: -1;
                    "
                  ></div>

                  <!-- Hydrogen 4 (Back) -->
                  <div
                    class="absolute w-8 h-8 bg-gradient-to-br from-gray-200 to-gray-400 rounded-full shadow-inner opacity-80 flex items-center justify-center text-black font-bold text-[10px]"
                    style="
                      top: 50%;
                      left: 50%;
                      transform: translate(-50%, -50%) translateZ(-50px);
                    "
                  >
                    H
                  </div>
                </div>
              </div>
              <p class="text-center text-xs mt-2 text-gray-500 italic">
                Mô hình quả cầu - thanh nối của CH4 (Click để dừng quay)
              </p>
            </div>
          </div>

          <!-- Right: Properties & Experiments -->
          <div class="lg:col-span-5 space-y-6">
            <!-- Tính chất hóa học -->
            <div class="glass-panel p-6 rounded-2xl border-l-4 border-red-500">
              <h3
                class="font-display text-xl font-bold mb-4 flex items-center gap-2"
              >
                <i class="fas fa-flask text-red-500"></i> C. Tính chất hóa học &
                Thí nghiệm
              </h3>
              <ul
                class="space-y-3 text-sm text-gray-700 dark:text-gray-300 mb-4"
              >
                <li>
                  <strong>1. Phản ứng thế (Halogenation):</strong> Đặc trưng
                  nhất. Cần ánh sáng/nhiệt.
                </li>
                <li>
                  <strong>2. Phản ứng tách (Cracking/Dehydrogen):</strong> Bẻ
                  mạch hoặc tách H2.
                </li>
                <li>
                  <strong>3. Phản ứng cháy:</strong> Tỏa nhiều nhiệt. nH2O >
                  nCO2.
                </li>
              </ul>

              <!-- SIMULATION 2: Substitution Reaction -->
              <div
                class="bg-gray-100 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"
              >
                <h4 class="font-bold text-center mb-2">
                  Mô phỏng: Thế Halogen (CH4 + Cl2)
                </h4>
                <div
                  id="sim-substitution"
                  class="h-40 relative bg-white dark:bg-gray-900 rounded-lg flex items-center justify-center overflow-hidden"
                >
                  <!-- Initial State -->
                  <div
                    id="sub-reactants"
                    class="flex items-center gap-4 transition-all duration-700"
                  >
                    <div class="text-center">
                      <div
                        class="w-10 h-10 bg-gray-500 rounded-full mx-auto mb-1"
                      ></div>
                      CH4
                    </div>
                    <div class="text-xl">+</div>
                    <div class="text-center">
                      <div
                        class="w-10 h-10 bg-green-500 rounded-full mx-auto mb-1 opacity-80"
                      ></div>
                      Cl2
                    </div>
                  </div>
                  <!-- Final State (Hidden) -->
                  <div
                    id="sub-products"
                    class="absolute flex items-center gap-4 opacity-0 scale-0 transition-all duration-700"
                  >
                    <div class="text-center">
                      <div
                        class="w-10 h-10 bg-gradient-to-r from-gray-500 to-green-500 rounded-full mx-auto mb-1"
                      ></div>
                      CH3Cl
                    </div>
                    <div class="text-xl">+</div>
                    <div class="text-center">
                      <div
                        class="w-8 h-8 bg-gray-200 border border-green-500 rounded-full mx-auto mb-1"
                      ></div>
                      HCl
                    </div>
                  </div>
                  <!-- Light Energy -->
                  <div
                    id="uv-light"
                    class="absolute top-0 right-0 p-2 opacity-30 transition-all duration-300"
                  >
                    <i class="fas fa-sun text-yellow-400 text-3xl"></i>
                  </div>
                </div>
                <div class="mt-3 flex gap-2">
                  <button
                    onclick="runSubstitution()"
                    class="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded-lg text-sm font-bold transition-colors"
                  >
                    <i class="fas fa-lightbulb"></i> Chiếu sáng (UV)
                  </button>
                  <button
                    onclick="resetSubstitution()"
                    class="px-3 bg-gray-300 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-400"
                  >
                    <i class="fas fa-redo"></i>
                  </button>
                </div>
                <p
                  id="sub-feedback"
                  class="text-xs text-center mt-2 text-gray-500 min-h-[1.5em]"
                >
                  Điều kiện thường: Không phản ứng.
                </p>
              </div>
            </div>

            <!-- D. Công thức -->
            <div
              class="glass-panel p-6 rounded-2xl bg-gradient-to-br from-blue-50/50 to-transparent dark:from-blue-900/20"
            >
              <h3 class="font-display text-xl font-bold mb-4">
                D. Công thức quan trọng
              </h3>
              <div class="space-y-4 font-mono text-sm">
                <div
                  class="p-3 bg-white/50 dark:bg-black/20 rounded-lg border border-blue-200 dark:border-blue-800"
                >
                  <p class="text-blue-600 dark:text-blue-400 font-bold">
                    Phản ứng cháy:
                  </p>
                  <p>CnH2n+2 + (3n+1)/2 O2 → nCO2 + (n+1)H2O</p>
                  <p class="text-xs text-gray-500 mt-1">
                    ⇒ n(alkane) = n(H2O) - n(CO2)
                  </p>
                </div>
                <div
                  class="p-3 bg-white/50 dark:bg-black/20 rounded-lg border border-purple-200 dark:border-purple-800"
                >
                  <p class="text-purple-600 dark:text-purple-400 font-bold">
                    Độ bất bão hòa (k):
                  </p>
                  <p>k = (2C + 2 - H)/2</p>
                  <p class="text-xs text-gray-500 mt-1">Alkane: k = 0</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ==============================================
             SECTION II: ALKENE & ALKYNE
             ============================================== -->
      <section
        id="alkene-alkyne"
        class="scroll-mt-24 pt-10 border-t border-gray-200 dark:border-gray-800"
      >
        <div class="flex items-center gap-4 mb-10">
          <div
            class="w-12 h-12 rounded-2xl bg-purple-500 flex items-center justify-center text-white text-2xl shadow-lg shadow-purple-500/30"
          >
            <i class="fas fa-bacon"></i>
          </div>
          <div>
            <h2
              class="font-display text-4xl font-bold text-gray-900 dark:text-white"
            >
              II. ALKENE & ALKYNE
            </h2>
            <p class="text-purple-500 font-semibold">
              Hydrocarbon không no (Liên kết đôi & ba)
            </p>
          </div>
        </div>

        <!-- Theory Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
          <!-- Alkene Theory -->
          <div
            class="glass-panel p-6 rounded-2xl hover:border-purple-400 transition-colors"
          >
            <h3 class="text-xl font-bold text-purple-600 mb-3">
              Alkene (CnH2n, n≥2)
            </h3>
            <ul class="text-sm space-y-2 text-gray-700 dark:text-gray-300">
              <li>• Có 1 liên kết đôi (C=C).</li>
              <li>
                • Đồng phân: Mạch C, vị trí nối đôi, hình học (cis-trans).
              </li>
              <li>
                • Phản ứng đặc trưng: <strong>Cộng (H2, Br2, HX, H2O)</strong>.
              </li>
              <li>• Trùng hợp tạo Polymer.</li>
            </ul>
          </div>
          <!-- Alkyne Theory -->
          <div
            class="glass-panel p-6 rounded-2xl hover:border-pink-400 transition-colors"
          >
            <h3 class="text-xl font-bold text-pink-600 mb-3">
              Alkyne (CnH2n-2, n≥2)
            </h3>
            <ul class="text-sm space-y-2 text-gray-700 dark:text-gray-300">
              <li>• Có 1 liên kết ba (C≡C).</li>
              <li>• Không có đồng phân hình học.</li>
              <li>• Phản ứng cộng theo 2 giai đoạn.</li>
              <li>• Alk-1-yne thế ion kim loại (AgNO3/NH3).</li>
            </ul>
          </div>
        </div>

        <!-- SIMULATION AREA: BROMINE TEST & BONDING -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- SIMULATION 3: Bromine Water Test -->
          <div
            class="glass-panel p-6 rounded-2xl border border-orange-200 dark:border-orange-900"
          >
            <h3
              class="font-display text-lg font-bold mb-4 flex items-center justify-between"
            >
              <span
                ><i class="fas fa-vial text-orange-500"></i> Thí nghiệm: Tác
                dụng Br2</span
              >
              <span
                class="text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded"
                >Interactive</span
              >
            </h3>

            <div class="flex flex-col items-center">
              <!-- Beaker Visual -->
              <div class="relative w-32 h-40 mb-4">
                <div
                  class="absolute bottom-0 w-full h-3/4 border-2 border-white/50 border-t-0 rounded-b-xl bg-white/10 backdrop-blur-sm overflow-hidden"
                >
                  <!-- Fluid -->
                  <div
                    id="beaker-fluid"
                    class="absolute bottom-0 w-full h-full bg-orange-400 transition-colors duration-1000 opacity-90 flex items-end justify-center pb-2"
                  >
                    <span
                      id="fluid-label"
                      class="text-xs font-bold text-white shadow-black drop-shadow-md"
                      >Dung dịch Br2</span
                    >
                  </div>
                  <!-- Bubbles -->
                  <div
                    id="bubbles"
                    class="hidden absolute bottom-0 w-full h-full"
                  >
                    <div
                      class="absolute bottom-0 left-1/4 w-2 h-2 bg-white rounded-full animate-float"
                    ></div>
                    <div
                      class="absolute bottom-2 right-1/4 w-3 h-3 bg-white rounded-full animate-float"
                      style="animation-delay: 0.5s"
                    ></div>
                  </div>
                </div>
              </div>

              <!-- Controls -->
              <div class="w-full space-y-3">
                <div class="flex justify-between text-sm font-bold">
                  <span>Chất dẫn vào:</span>
                  <span id="gas-type" class="text-blue-500"
                    >Ethylene (C2H4)</span
                  >
                </div>
                <div class="flex gap-2">
                  <button
                    onclick="setGas('alkane')"
                    class="flex-1 py-1 px-2 rounded bg-gray-200 dark:bg-gray-700 text-xs hover:bg-gray-300"
                  >
                    Alkane
                  </button>
                  <button
                    onclick="setGas('alkene')"
                    class="flex-1 py-1 px-2 rounded bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 border border-purple-500 text-xs font-bold"
                  >
                    Alkene
                  </button>
                  <button
                    onclick="setGas('alkyne')"
                    class="flex-1 py-1 px-2 rounded bg-gray-200 dark:bg-gray-700 text-xs hover:bg-gray-300"
                  >
                    Alkyne
                  </button>
                </div>

                <label class="block text-xs mt-2">Lượng khí sục vào:</label>
                <input
                  type="range"
                  id="gas-amount"
                  min="0"
                  max="100"
                  value="0"
                  class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"
                  oninput="updateBromineSim()"
                />

                <div
                  id="sim-explanation"
                  class="text-xs p-2 bg-gray-100 dark:bg-gray-800 rounded mt-2 border-l-2 border-blue-500"
                >
                  Kéo thanh trượt để sục khí C2H4 vào dung dịch.
                </div>
              </div>
            </div>
          </div>

          <!-- SIMULATION 4: Pi Bond Visualizer (SVG) -->
          <div class="glass-panel p-6 rounded-2xl">
            <h3
              class="font-display text-lg font-bold mb-4 flex items-center gap-2"
            >
              <i class="fas fa-project-diagram text-pink-500"></i> Bản chất liên
              kết
            </h3>
            <div class="flex flex-col items-center justify-center h-full">
              <svg
                width="250"
                height="150"
                viewBox="0 0 200 120"
                class="overflow-visible"
              >
                <!-- Sigma Bond -->
                <line
                  x1="60"
                  y1="60"
                  x2="140"
                  y2="60"
                  stroke="#94a3b8"
                  stroke-width="8"
                  stroke-linecap="round"
                />
                <text
                  x="100"
                  y="55"
                  text-anchor="middle"
                  fill="#64748b"
                  font-size="10"
                  font-weight="bold"
                >
                  σ
                </text>

                <!-- Pi Bond (Top Lobe) -->
                <path
                  d="M60,60 Q100,20 140,60"
                  fill="none"
                  stroke="#ec4899"
                  stroke-width="4"
                  stroke-dasharray="5,2"
                  class="animate-pulse"
                >
                  <animate
                    attributeName="d"
                    values="M60,60 Q100,20 140,60; M60,60 Q100,30 140,60; M60,60 Q100,20 140,60"
                    dur="2s"
                    repeatCount="indefinite"
                  />
                </path>
                <!-- Pi Bond (Bottom Lobe) -->
                <path
                  d="M60,60 Q100,100 140,60"
                  fill="none"
                  stroke="#ec4899"
                  stroke-width="4"
                  stroke-dasharray="5,2"
                  class="animate-pulse"
                >
                  <animate
                    attributeName="d"
                    values="M60,60 Q100,100 140,60; M60,60 Q100,90 140,60; M60,60 Q100,100 140,60"
                    dur="2s"
                    repeatCount="indefinite"
                  />
                </path>
                <text
                  x="100"
                  y="20"
                  text-anchor="middle"
                  fill="#ec4899"
                  font-size="10"
                  font-weight="bold"
                >
                  Liên kết π (Kém bền)
                </text>

                <!-- Carbon Atoms -->
                <circle cx="60" cy="60" r="15" fill="#334155" />
                <text
                  x="60"
                  y="64"
                  text-anchor="middle"
                  fill="white"
                  font-size="12"
                >
                  C
                </text>
                <circle cx="140" cy="60" r="15" fill="#334155" />
                <text
                  x="140"
                  y="64"
                  text-anchor="middle"
                  fill="white"
                  font-size="12"
                >
                  C
                </text>
              </svg>
              <p
                class="text-center text-sm mt-4 text-gray-600 dark:text-gray-400"
              >
                Liên kết π (Pi) nằm ngoài trục nối 2 hạt nhân, lực liên kết yếu
                <i class="fas fa-arrow-right"></i> Dễ bị bẻ gãy tham gia phản
                ứng cộng.
              </p>
            </div>
          </div>
        </div>

        <!-- E. Ứng dụng & Mở rộng -->
        <div
          class="mt-8 glass-panel p-6 rounded-2xl bg-green-50/50 dark:bg-green-900/10"
        >
          <h3 class="font-bold text-green-600 mb-2">Ứng dụng thực tế:</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600"
              >
                <i class="fas fa-lemon"></i>
              </div>
              <span><strong>Ethylene:</strong> Kích thích quả mau chín.</span>
            </div>
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600"
              >
                <i class="fas fa-fire"></i>
              </div>
              <span
                ><strong>Acetylene:</strong> Hàn cắt kim loại (đèn xì).</span
              >
            </div>
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600"
              >
                <i class="fas fa-box"></i>
              </div>
              <span><strong>PE/PP/PVC:</strong> Sản xuất chất dẻo.</span>
            </div>
          </div>
        </div>
      </section>

      <!-- ==============================================
             SECTION III: ARENE
             ============================================== -->
      <section
        id="arene"
        class="scroll-mt-24 pt-10 border-t border-gray-200 dark:border-gray-800"
      >
        <div class="flex items-center gap-4 mb-10">
          <div
            class="w-12 h-12 rounded-2xl bg-pink-500 flex items-center justify-center text-white text-2xl shadow-lg shadow-pink-500/30"
          >
            <i class="fas fa-ring"></i>
          </div>
          <div>
            <h2
              class="font-display text-4xl font-bold text-gray-900 dark:text-white"
            >
              III. ARENE (BENZENE)
            </h2>
            <p class="text-pink-500 font-semibold">
              Hydrocarbon thơm & Hệ liên hợp bền vững
            </p>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <!-- Theory -->
          <div class="lg:col-span-8 space-y-6">
            <div class="glass-panel p-6 rounded-2xl">
              <h3 class="text-xl font-bold mb-4">
                Đặc điểm cấu tạo & Tính chất
              </h3>
              <ul class="space-y-4 text-gray-700 dark:text-gray-300">
                <li>
                  <strong class="text-pink-500">Cấu tạo Benzene (C6H6):</strong>
                  6 nguyên tử C tạo lục giác đều phẳng. Hệ 6e π liên hợp giải
                  tỏa đều (vòng tròn ở giữa) → Rất bền vững.
                </li>
                <li>
                  <strong class="text-pink-500">Tính thơm:</strong> Dễ thế, khó
                  cộng, bền với tác nhân oxi hóa.
                </li>
                <li class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2">
                  <div
                    class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border-l-4 border-yellow-500"
                  >
                    <strong>Thế (Substitution):</strong>
                    <br />
                    + Br2 (xúc tác Fe): Thế H nhánh. <br />
                    + HNO3 (H2SO4 đặc): Tạo Nitrobenzene.
                  </div>
                  <div
                    class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border-l-4 border-blue-500"
                  >
                    <strong>Quy tắc thế vòng Benzene:</strong>
                    <br />
                    - Nhóm đẩy e (Alkyl, -OH): Định hướng Ortho/Para. <br />
                    - Nhóm hút e (-NO2, -COOH): Định hướng Meta.
                  </div>
                </li>
              </ul>
            </div>
          </div>

          <!-- Simulation 5: Resonance -->
          <div class="lg:col-span-4">
            <div
              class="glass-panel p-6 rounded-2xl h-full flex flex-col items-center justify-center bg-gradient-to-b from-white to-pink-50 dark:from-gray-800 dark:to-gray-900"
            >
              <h4 class="font-bold mb-6 text-center">
                Cấu trúc cộng hưởng Kekulé
              </h4>

              <div
                class="relative w-40 h-40 cursor-pointer"
                onclick="toggleResonance()"
              >
                <!-- Hexagon SVG -->
                <svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-xl">
                  <polygon
                    points="50,5 93.3,30 93.3,80 50,105 6.7,80 6.7,30"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    class="text-gray-800 dark:text-gray-200"
                  />

                  <!-- Double Bonds State A -->
                  <g id="bonds-a" class="transition-opacity duration-500">
                    <line
                      x1="12"
                      y1="35"
                      x2="12"
                      y2="75"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                    <line
                      x1="50"
                      y1="98"
                      x2="88"
                      y2="76"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                    <line
                      x1="88"
                      y1="24"
                      x2="50"
                      y2="12"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                  </g>

                  <!-- Double Bonds State B -->
                  <g
                    id="bonds-b"
                    class="opacity-0 transition-opacity duration-500"
                  >
                    <line
                      x1="12"
                      y1="75"
                      x2="50"
                      y2="98"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                    <line
                      x1="93"
                      y1="75"
                      x2="93"
                      y2="25"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                    <line
                      x1="50"
                      y1="5"
                      x2="12"
                      y2="25"
                      stroke="#ec4899"
                      stroke-width="3"
                    />
                  </g>

                  <!-- Delocalized Circle (Hidden by default) -->
                  <circle
                    id="bond-circle"
                    cx="50"
                    cy="55"
                    r="30"
                    fill="none"
                    stroke="#ec4899"
                    stroke-width="2"
                    stroke-dasharray="4,4"
                    class="opacity-0 scale-50 transition-all duration-700"
                  />
                </svg>
              </div>

              <div class="flex gap-2 mt-6">
                <button
                  onclick="animateResonance()"
                  class="px-4 py-2 bg-pink-500 hover:bg-pink-600 text-white rounded-full text-xs font-bold shadow-lg shadow-pink-500/30"
                >
                  Chuyển đổi trạng thái
                </button>
                <button
                  onclick="showDelocalized()"
                  class="px-4 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 text-gray-800 dark:text-white rounded-full text-xs font-bold"
                >
                  Hệ liên hợp
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Experiment: Nitro hóa -->
        <div
          class="mt-8 glass-panel p-6 rounded-2xl border-t-4 border-yellow-500"
        >
          <h3 class="font-bold text-lg mb-4">
            Thí nghiệm ảo: Điều chế Nitrobenzene (Mùi hạnh nhân)
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div class="text-sm space-y-2">
              <p>
                <strong>Phương trình:</strong> C6H6 + HNO3 (đ) → C6H5NO2 + H2O
              </p>
              <p><strong>Xúc tác:</strong> H2SO4 đặc, t° ~ 60°C.</p>
              <p>
                <strong>Hiện tượng:</strong> Chất lỏng màu vàng, nặng hơn nước,
                mùi hạnh nhân lắng xuống đáy.
              </p>
              <button
                onclick="runNitroSim()"
                class="mt-4 px-6 py-3 bg-yellow-500 text-white font-bold rounded-lg shadow hover:bg-yellow-600 transition-transform active:scale-95 w-full md:w-auto"
              >
                <i class="fas fa-flask"></i> Tiến hành thí nghiệm
              </button>
            </div>

            <!-- Sim View -->
            <div
              class="h-48 bg-gray-100 dark:bg-gray-800 rounded-xl relative overflow-hidden flex items-center justify-center border border-gray-300 dark:border-gray-600"
            >
              <!-- Tube -->
              <div
                class="w-16 h-32 border-2 border-gray-400 border-t-0 rounded-b-2xl bg-white/20 relative"
              >
                <!-- Liquid Base -->
                <div
                  class="absolute bottom-0 w-full h-10 bg-transparent transition-all duration-1000"
                  id="nitro-liquid"
                ></div>
                <!-- Drops Animation Container -->
                <div
                  id="acid-drops"
                  class="absolute top-0 w-full h-full pointer-events-none"
                ></div>
              </div>
              <div
                id="nitro-result-text"
                class="absolute bottom-2 text-yellow-600 font-bold text-xs opacity-0 transition-opacity"
              >
                Nitrobenzene (Vàng)
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ==============================================
             SECTION F: GAME HÓA - BÀI TẬP
             ============================================== -->
      <section id="quiz" class="scroll-mt-24 pt-10">
        <div class="text-center mb-10">
          <h2 class="font-display text-4xl font-bold mb-2">
            <span class="text-gradient">THỬ THÁCH KIẾN THỨC</span>
          </h2>
          <p class="text-gray-500">
            Hoàn thành 5 câu hỏi để nhận huy hiệu "Chuyên gia Hóa học"
          </p>
        </div>

        <div
          class="max-w-3xl mx-auto glass-panel p-8 rounded-3xl shadow-2xl relative overflow-hidden"
        >
          <!-- Progress Bar -->
          <div
            class="absolute top-0 left-0 w-full h-2 bg-gray-200 dark:bg-gray-700"
          >
            <div
              id="quiz-progress"
              class="h-full bg-gradient-to-r from-blue-500 to-green-500 w-0 transition-all duration-500"
            ></div>
          </div>

          <!-- Quiz Container -->
          <div id="quiz-container" class="mt-4">
            <!-- Question Display -->
            <div id="question-area" class="animate-fadeIn">
              <div class="flex justify-between items-center mb-6">
                <span
                  class="text-sm font-bold text-blue-500 uppercase tracking-widest"
                  >Câu hỏi <span id="q-current">1</span>/5</span
                >
                <span
                  class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded-full text-xs font-bold"
                  id="q-score"
                  >Điểm: 0</span
                >
              </div>

              <h3
                class="text-xl md:text-2xl font-bold mb-8 text-gray-800 dark:text-white"
                id="q-text"
              >
                Đang tải dữ liệu...
              </h3>

              <div class="grid gap-4" id="q-options">
                <!-- Options generated by JS -->
              </div>
            </div>

            <!-- Result Screen (Hidden) -->
            <div id="result-area" class="hidden text-center py-10">
              <div
                class="w-24 h-24 mx-auto bg-green-100 rounded-full flex items-center justify-center text-green-500 text-5xl mb-6 animate-bounce"
              >
                <i class="fas fa-trophy"></i>
              </div>
              <h3 class="text-3xl font-bold mb-2 text-gray-900 dark:text-white">
                Hoàn thành!
              </h3>
              <p class="text-gray-600 mb-8">
                Bạn đã trả lời đúng
                <span id="final-score" class="font-bold text-green-500 text-xl"
                  >0</span
                >/5 câu.
              </p>
              <button
                onclick="resetQuiz()"
                class="px-8 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-full font-bold shadow-lg transition-transform hover:scale-105"
              >
                <i class="fas fa-redo mr-2"></i> Làm lại
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- NAVIGATION BUTTONS (REQUIRED FROM PROMPT) -->
      <section class="text-center space-x-4 mb-20 pt-10">
        <button
          onclick="
            document
              .getElementById('quiz')
              .scrollIntoView({ behavior: 'smooth' })
          "
          style="
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            color: #fff;
            background: linear-gradient(135deg, #3b82f6, #6366f1);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.35);
            transition: 0.3s ease;
          "
          onmouseover="
            this.style.transform = 'translateY(-3px) scale(1.03)';
            this.style.boxShadow = '0 18px 45px rgba(99,102,241,.55)';
          "
          onmouseout="
            this.style.transform = 'translateY(0) scale(1)';
            this.style.boxShadow = '0 10px 30px rgba(59,130,246,.35)';
          "
        >
          <i class="fas fa-pen-to-square"></i>
          Bài tập củng cố
        </button>

        <button
          onclick="alert('Đây là bản Demo trong phạm vi 1 file HTML.')"
          style="
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            color: #fff;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.35);
            transition: 0.3s ease;
          "
          onmouseover="
            this.style.transform = 'translateY(-3px)';
            this.style.boxShadow = '0 18px 45px rgba(22,163,74,.55)';
          "
          onmouseout="
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 10px 30px rgba(34,197,94,.35)';
          "
        >
          <i class="fas fa-arrow-left"></i>
          Quay về CS Expert
        </button>
      </section>
    </main>

    <!-- FOOTER (REQUIRED FROM PROMPT) -->
    <footer>
      <div class="footer-waves"></div>
      <div class="footer-grid">
        <div class="footer-brand" data-aos="fade-right">
          <h2>EDUMATTER</h2>
          <p style="color: #94a3b8; line-height: 1.8">
            Kiến tạo môi trường học tập cảm xúc, nơi tri thức được số hóa và
            truyền tải đầy cảm hứng.
          </p>
          <div style="display: flex; gap: 15px; margin-top: 30px">
            <a href="https://www.facebook.com/ducnt214" class="icon-btn"
              ><i class="fab fa-facebook" alt="facebook"></i
            ></a>
            <a href="https://github.com/ducnt2104" class="icon-btn" alt="github"
              ><i class="fab fa-github"></i
            ></a>
            <a
              href="https://www.tiktok.com/@ktbtcthm210"
              class="icon-btn"
              alt="tiktok"
              ><i class="fab fa-tiktok"></i
            ></a>
          </div>
        </div>
        <div class="footer-links" data-aos="fade-up">
          <h3>Liên hệ nhanh</h3>
          <div class="contact-item">
            <i class="fas fa-envelope"></i>
            <span>ducnt21042010@gmail.com</span>
          </div>
          <div class="contact-item">
            <i class="fas fa-phone"></i>
            <span>034 226 6204</span>
          </div>
          <div class="contact-item">
            <i class="fas fa-location-dot"></i>
            <span>THPT Tôn Đức Thắng, Đồng Nai</span>
          </div>
        </div>
        <div class="footer-links" data-aos="fade-left">
          <h4>Đội ngũ DNT</h4>
          <p style="color: #94a3b8">
            "Sáng tạo không ngừng - Vươn tầm tri thức"
          </p>
          <div
            style="
              margin-top: 20px;
              padding: 15px;
              background: rgba(255, 255, 255, 0.05);
              border-radius: 15px;
            "
          >
            <p style="font-size: 0.8rem; color: #fff">
              Dự án được phát triển bởi các thành viên đam mê công nghệ tại Việt
              Nam.
            </p>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>
          © 2024 EDUMATTER Educational Ecosystem. Designed with
          <i class="fas fa-heart" style="color: #ef4444"></i> by DNT Team.
        </p>
      </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
      // --- 1. DARK MODE & UI LOGIC ---
      const themeToggle = document.getElementById("theme-toggle");
      const themeIcon = document.getElementById("theme-icon");
      const html = document.documentElement;

      // Check system preference or localStorage
      if (
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        html.classList.add("dark");
        themeIcon.classList.replace("fa-sun", "fa-moon");
      } else {
        html.classList.remove("dark");
        themeIcon.classList.replace("fa-moon", "fa-sun");
      }

      themeToggle.addEventListener("click", () => {
        html.classList.toggle("dark");
        if (html.classList.contains("dark")) {
          localStorage.theme = "dark";
          themeIcon.classList.replace("fa-sun", "fa-moon");
        } else {
          localStorage.theme = "light";
          themeIcon.classList.replace("fa-moon", "fa-sun");
        }
      });

      // --- 2. SIMULATION: METHANE 3D ROTATION ---
      let isRotating = true;
      function toggleMethaneRotation() {
        const molecule = document.getElementById("methane-molecule");
        isRotating = !isRotating;
        if (isRotating) {
          molecule.classList.add("animate-spin-slow");
          molecule.style.animationPlayState = "running";
        } else {
          molecule.style.animationPlayState = "paused";
        }
      }

      // --- 3. SIMULATION: SUBSTITUTION REACTION (CH4 + Cl2) ---
      function runSubstitution() {
        const reactants = document.getElementById("sub-reactants");
        const products = document.getElementById("sub-products");
        const feedback = document.getElementById("sub-feedback");
        const light = document.getElementById("uv-light");

        // Feedback update
        feedback.innerHTML =
          '<span class="text-yellow-600 font-bold"><i class="fas fa-bolt"></i> Phản ứng đang xảy ra... (Cơ chế gốc tự do)</span>';

        // Animation sequence
        light.classList.replace("opacity-30", "opacity-100"); // Flash light
        light.classList.add("animate-pulse");

        setTimeout(() => {
          reactants.classList.add("opacity-0", "scale-75"); // Hide reactants
          setTimeout(() => {
            reactants.classList.add("hidden");
            products.classList.remove("hidden");
            setTimeout(() => {
              products.classList.remove("opacity-0", "scale-0"); // Show products
              feedback.innerHTML =
                '<span class="text-green-600 font-bold"><i class="fas fa-check"></i> Tạo thành Methyl chloride (CH3Cl) và HCl!</span>';
              light.classList.replace("opacity-100", "opacity-30");
              light.classList.remove("animate-pulse");
            }, 100);
          }, 700);
        }, 1000);
      }

      function resetSubstitution() {
        const reactants = document.getElementById("sub-reactants");
        const products = document.getElementById("sub-products");
        const feedback = document.getElementById("sub-feedback");

        products.classList.add("opacity-0", "scale-0");
        setTimeout(() => {
          products.classList.add("hidden");
          reactants.classList.remove("hidden");
          setTimeout(() => {
            reactants.classList.remove("opacity-0", "scale-75");
            feedback.textContent = "Điều kiện thường: Không phản ứng.";
          }, 50);
        }, 700);
      }

      // --- 4. SIMULATION: BROMINE TEST ---
      let currentGas = "alkene"; // default

      function setGas(type) {
        currentGas = type;
        const label = document.getElementById("gas-type");
        const slider = document.getElementById("gas-amount");

        // Reset slider visual
        slider.value = 0;
        updateBromineSim();

        // Update Label
        if (type === "alkane") label.innerText = "Ethane (C2H6) - Alkane";
        if (type === "alkene") label.innerText = "Ethylene (C2H4) - Alkene";
        if (type === "alkyne") label.innerText = "Acetylene (C2H2) - Alkyne";

        // Update color logic
        if (type === "alkane") {
          label.className = "text-gray-500";
        } else {
          label.className = "text-blue-500";
        }
      }

      function updateBromineSim() {
        const val = document.getElementById("gas-amount").value;
        const liquid = document.getElementById("beaker-fluid");
        const feedback = document.getElementById("sim-explanation");
        const bubbles = document.getElementById("bubbles");

        // Show bubbles if gas is flowing
        if (val > 5) bubbles.classList.remove("hidden");
        else bubbles.classList.add("hidden");

        if (currentGas === "alkane") {
          // Alkane: No reaction -> Color stays Orange
          liquid.style.backgroundColor = `rgba(251, 146, 60, 0.9)`; // Orange-400
          if (val > 10)
            feedback.innerHTML =
              "Alkane <strong class='text-red-500'>KHÔNG</strong> làm mất màu dung dịch Bromine.";
        } else {
          // Alkene/Alkyne: Reaction -> Color fades to clear
          // Max opacity 0.9, min 0.1
          const opacity = 0.9 - (val / 100) * 0.8;
          liquid.style.backgroundColor = `rgba(251, 146, 60, ${opacity})`;

          if (val > 80) {
            feedback.innerHTML = `<strong class="text-green-600">Phản ứng hoàn toàn!</strong> Dung dịch mất màu. <br> ${currentGas === "alkene" ? "C2H4 + Br2 → C2H4Br2" : "C2H2 + 2Br2 → C2H2Br4"}`;
          } else if (val > 10) {
            feedback.innerHTML =
              "Dung dịch đang nhạt màu dần do phản ứng cộng xảy ra.";
          }
        }
      }

      // --- 5. SIMULATION: BENZENE RESONANCE ---
      let isResonanceAnimating = false;
      function animateResonance() {
        const groupA = document.getElementById("bonds-a");
        const groupB = document.getElementById("bonds-b");

        // Simple toggle animation
        if (groupA.classList.contains("opacity-0")) {
          groupA.classList.remove("opacity-0");
          groupB.classList.add("opacity-0");
        } else {
          groupA.classList.add("opacity-0");
          groupB.classList.remove("opacity-0");
        }
      }

      function showDelocalized() {
        const circle = document.getElementById("bond-circle");
        const groupA = document.getElementById("bonds-a");
        const groupB = document.getElementById("bonds-b");

        // Hide Kekule bonds, show circle
        groupA.classList.add("opacity-0");
        groupB.classList.add("opacity-0");
        circle.classList.remove("opacity-0", "scale-50");
      }

      function toggleResonance() {
        // Click on hexagon resets to State A
        const circle = document.getElementById("bond-circle");
        const groupA = document.getElementById("bonds-a");

        if (!circle.classList.contains("opacity-0")) {
          circle.classList.add("opacity-0", "scale-50");
          groupA.classList.remove("opacity-0");
        } else {
          animateResonance();
        }
      }

      // --- 6. SIMULATION: NITROGENATION EXPERIMENT ---
      function runNitroSim() {
        const drops = document.getElementById("acid-drops");
        const liquid = document.getElementById("nitro-liquid");
        const text = document.getElementById("nitro-result-text");

        // Reset
        drops.innerHTML = "";
        liquid.style.height = "10px";
        liquid.style.backgroundColor = "transparent";
        text.classList.add("opacity-0");

        // Create drops visual
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            const d = document.createElement("div");
            d.className =
              "absolute left-1/2 w-2 h-2 bg-yellow-200 rounded-full animate-bounce";
            d.style.top = i * 10 + "px";
            drops.appendChild(d);
          }, i * 300);
        }

        // Fill reaction
        setTimeout(() => {
          liquid.style.height = "40px";
          liquid.style.backgroundColor = "#facc15"; // Yellow-400
          text.classList.remove("opacity-0");
          text.classList.add("animate-pulse");
        }, 1800);
      }

      // --- 7. QUIZ SYSTEM (GAMIFICATION) ---
      const questions = [
        {
          q: "Alkane nào sau đây ở trạng thái KHÍ tại điều kiện thường?",
          options: [
            "Hexane (C6H14)",
            "Butane (C4H10)",
            "Octane (C8H18)",
            "Decane (C10H22)",
          ],
          correct: 1, // index starts 0
          explain: "Alkane từ C1 đến C4 là chất khí.",
        },
        {
          q: "Phản ứng đặc trưng của Alkene là gì?",
          options: [
            "Phản ứng Thế",
            "Phản ứng Cộng",
            "Phản ứng Tách",
            "Phản ứng Oxi hóa",
          ],
          correct: 1,
          explain:
            "Do có liên kết đôi (Pi kém bền) nên dễ tham gia phản ứng cộng.",
        },
        {
          q: "Để phân biệt Alk-1-yne với Alkene, ta dùng thuốc thử nào?",
          options: [
            "Dung dịch Br2",
            "Dung dịch KMnO4",
            "AgNO3 / NH3",
            "Quỳ tím",
          ],
          correct: 2,
          explain:
            "Alk-1-yne tạo kết tủa vàng nhạt với AgNO3/NH3 (thế ion kim loại).",
        },
        {
          q: "Công thức chung của Alkane là?",
          options: ["CnH2n", "CnH2n+2", "CnH2n-2", "CnH2n-6"],
          correct: 1,
          explain: "Alkane là hydrocarbon no mạch hở: CnH2n+2.",
        },
        {
          q: "Benzene phản ứng với Br2 (xúc tác bột Fe) tạo ra sản phẩm gì?",
          options: [
            "Bromobenzene",
            "Hexachlorocyclohexane",
            "Benzyl bromide",
            "Không phản ứng",
          ],
          correct: 0,
          explain:
            "Đây là phản ứng thế vào nhân thơm: C6H6 + Br2 -> C6H5Br + HBr.",
        },
      ];

      let currentQIndex = 0;
      let score = 0;

      function loadQuestion() {
        const qData = questions[currentQIndex];
        document.getElementById("q-current").innerText = currentQIndex + 1;
        document.getElementById("q-text").innerText = qData.q;

        const optionsDiv = document.getElementById("q-options");
        optionsDiv.innerHTML = ""; // Clear old

        qData.options.forEach((opt, idx) => {
          const btn = document.createElement("button");
          btn.className =
            "w-full text-left p-4 rounded-xl bg-white dark:bg-gray-800 border-2 border-transparent hover:border-blue-400 shadow-sm transition-all flex justify-between items-center group";
          btn.innerHTML = `<span class="font-semibold text-gray-700 dark:text-gray-300">${opt}</span> <i class="fas fa-circle-check opacity-0 group-hover:opacity-50 text-blue-500"></i>`;
          btn.onclick = () =>
            checkAnswer(idx, btn, qData.correct, qData.explain);
          optionsDiv.appendChild(btn);
        });
      }

      function checkAnswer(selectedIdx, btnElement, correctIdx, explanation) {
        // Disable all buttons
        const allBtns = document.getElementById("q-options").children;
        for (let b of allBtns) b.disabled = true;

        if (selectedIdx === correctIdx) {
          // Correct
          btnElement.classList.add(
            "border-green-500",
            "bg-green-50",
            "dark:bg-green-900/20",
          );
          btnElement.innerHTML = `<span class="font-bold text-green-700 dark:text-green-400">${questions[currentQIndex].options[selectedIdx]}</span> <i class="fas fa-check text-green-500 text-xl"></i>`;
          score++;
          document.getElementById("q-score").innerText = `Điểm: ${score}`;
        } else {
          // Wrong
          btnElement.classList.add(
            "border-red-500",
            "bg-red-50",
            "dark:bg-red-900/20",
          );
          btnElement.innerHTML = `<span class="font-bold text-red-700 dark:text-red-400">${questions[currentQIndex].options[selectedIdx]}</span> <i class="fas fa-times text-red-500 text-xl"></i>`;

          // Highlight correct one
          const correctBtn = allBtns[correctIdx];
          correctBtn.classList.add("border-green-500");
          correctBtn.innerHTML += ` <span class="text-xs text-green-600 font-bold ml-2">(Đáp án đúng)</span>`;
        }

        // Show explanation toast/div
        const expDiv = document.createElement("div");
        expDiv.className =
          "mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded-lg text-sm animate-fadeIn";
        expDiv.innerHTML = `<strong>Giải thích:</strong> ${explanation}`;
        document.getElementById("q-options").appendChild(expDiv);

        // Update Progress
        const progress = ((currentQIndex + 1) / questions.length) * 100;
        document.getElementById("quiz-progress").style.width = `${progress}%`;

        // Next button logic
        setTimeout(() => {
          currentQIndex++;
          if (currentQIndex < questions.length) {
            const nextBtn = document.createElement("button");
            nextBtn.innerText = "Câu tiếp theo >";
            nextBtn.className =
              "mt-4 w-full py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-lg";
            nextBtn.onclick = loadQuestion;
            document.getElementById("q-options").appendChild(nextBtn);
            nextBtn.scrollIntoView({ behavior: "smooth" });
          } else {
            showResult();
          }
        }, 2000);
      }

      function showResult() {
        document.getElementById("question-area").classList.add("hidden");
        document.getElementById("result-area").classList.remove("hidden");
        document.getElementById("final-score").innerText = score;
      }

      function resetQuiz() {
        currentQIndex = 0;
        score = 0;
        document.getElementById("q-score").innerText = "Điểm: 0";
        document.getElementById("quiz-progress").style.width = "0%";
        document.getElementById("result-area").classList.add("hidden");
        document.getElementById("question-area").classList.remove("hidden");
        loadQuestion();
      }

      // --- INIT ---
      window.addEventListener("DOMContentLoaded", () => {
        loadQuestion();
        // Start subtle animation for hero
        setInterval(() => {
          const bubbles = document.querySelectorAll(".animate-float");
          bubbles.forEach((b) => {
            b.style.transform = `translateY(${Math.random() * 10 - 5}px)`;
          });
        }, 2000);
      });
    </script>
  </body>
</html>
