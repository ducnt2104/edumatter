<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chương 4: Phản Ứng Oxi Hoá – Khử</title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- MathJax for formulas -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              chem: {
                primary: "#3B82F6",
                secondary: "#10B981",
                dark: "#0F172A",
                accent: "#F59E0B",
              },
            },
            fontFamily: {
              sans: ["Segoe UI", "Roboto", "Arial", "sans-serif"],
            },
          },
        },
      };
    </script>

    <style>
      /* Custom Styles & Animations */
      body {
        font-family: "Segoe UI", sans-serif;
        overflow-x: hidden;
      }

      .glass-nav {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .dark .glass-nav {
        background: rgba(15, 23, 42, 0.85);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sim-container {
        position: relative;
        border-radius: 1rem;
        overflow: hidden;
        background: #f1f5f9;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.05);
      }

      .dark .sim-container {
        background: #1e293b;
      }

      /* Beaker Styles for Sim 3 */
      .beaker {
        border-left: 4px solid rgba(200, 200, 200, 0.5);
        border-right: 4px solid rgba(200, 200, 200, 0.5);
        border-bottom: 4px solid rgba(200, 200, 200, 0.5);
        border-radius: 0 0 20px 20px;
        position: relative;
      }

      .bubble {
        position: absolute;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        animation: rise 2s infinite linear;
      }

      @keyframes rise {
        0% {
          bottom: 0;
          opacity: 0;
          transform: scale(0.5);
        }
        50% {
          opacity: 1;
        }
        100% {
          bottom: 100%;
          opacity: 0;
          transform: scale(1.2);
        }
      }

      /* Helper classes */
      .chem-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .chem-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1),
          0 8px 10px -6px rgba(0, 0, 0, 0.1);
      }

      /* MathJax Customization */
      mjx-container {
        font-size: 110% !important;
      }
    </style>
  </head>
  <body
    class="bg-gray-50 text-slate-800 dark:bg-slate-900 dark:text-gray-100 transition-colors duration-300"
  >
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav transition-all duration-300">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center gap-4">
            <a
              href="../chemstudyteen.html"
              class="flex items-center justify-center w-10 h-10 rounded-full bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 transition"
            >
              <i class="fas fa-arrow-left text-slate-700 dark:text-white"></i>
            </a>
            <span
              class="font-bold text-xl bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-teal-500"
            >
              ChemStudyTeen
            </span>
          </div>

          <div class="hidden md:flex items-center space-x-8">
            <a
              href="#section-1"
              class="hover:text-blue-600 dark:hover:text-blue-400 font-medium transition"
              >Số Oxi Hoá</a
            >
            <a
              href="#section-2"
              class="hover:text-blue-600 dark:hover:text-blue-400 font-medium transition"
              >Phản Ứng</a
            >
            <a
              href="#section-3"
              class="hover:text-blue-600 dark:hover:text-blue-400 font-medium transition"
              >Cân Bằng</a
            >
            <a
              href="#section-4"
              class="hover:text-blue-600 dark:hover:text-blue-400 font-medium transition"
              >Ý Nghĩa</a
            >
          </div>

          <button
            id="theme-toggle"
            class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition focus:outline-none"
          >
            <i class="fas fa-moon dark:hidden text-gray-600"></i>
            <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
          </button>
        </div>
      </div>
    </nav>

    <!-- Hero Section with 3D Simulation 1 -->
    <header class="relative pt-24 pb-12 lg:pt-32 lg:pb-20 overflow-hidden">
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"
      >
        <div class="z-10">
          <div
            class="inline-block px-4 py-1.5 mb-4 text-sm font-semibold tracking-wider text-blue-600 uppercase bg-blue-100 rounded-full dark:bg-blue-900/30 dark:text-blue-400"
          >
            Chương 4 • Hóa Học 10
          </div>
          <h1 class="text-4xl lg:text-6xl font-extrabold tracking-tight mb-6">
            Phản Ứng <br />
            <span
              class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-400"
              >Oxi Hoá – Khử</span
            >
          </h1>
          <p class="text-lg text-gray-600 dark:text-gray-300 mb-8 max-w-lg">
            Khám phá bản chất của sự chuyển dịch electron, nền tảng của năng
            lượng, sự sống và công nghiệp hoá chất.
          </p>
          <div class="flex flex-wrap gap-4">
            <a
              href="#section-1"
              class="px-8 py-3 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 transition shadow-lg shadow-blue-500/30"
            >
              Bắt Đầu Học
            </a>
            <button
              onclick="scrollToSim()"
              class="px-8 py-3 rounded-xl border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition font-medium"
            >
              Xem Thí Nghiệm
            </button>
          </div>
        </div>

        <!-- SIMULATION 1: 3D Atom Model -->
        <div
          id="sim-3d-atom"
          class="h-[400px] w-full bg-transparent relative z-0"
        >
          <!-- Three.js will inject canvas here -->
          <div
            class="absolute bottom-4 right-4 bg-white/90 dark:bg-slate-800/90 p-2 rounded text-xs shadow backdrop-blur"
          >
            <i class="fas fa-cube mr-1"></i> Mô phỏng 1: Cấu trúc nguyên tử 3D
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24">
      <!-- SECTION I: Số Oxi Hoá -->
      <section id="section-1" class="scroll-mt-24">
        <div class="flex items-center gap-4 mb-8">
          <span
            class="flex items-center justify-center w-12 h-12 rounded-xl bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 font-bold text-xl"
            >I</span
          >
          <h2 class="text-3xl font-bold">Số Oxi Hoá (Số OXH)</h2>
        </div>

        <div class="grid md:grid-cols-2 gap-8">
          <!-- Theory -->
          <div class="space-y-6">
            <div
              class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700"
            >
              <h3 class="text-xl font-bold mb-4 text-blue-500">
                1. Khái niệm & Quy Tắc
              </h3>
              <ul class="space-y-3 text-gray-700 dark:text-gray-300">
                <li>
                  <i class="fas fa-check-circle text-green-500 mr-2"></i>
                  <strong>Đơn chất:</strong> Số oxh = 0 (Ví dụ: \(Na, O_2,
                  Cl_2\)).
                </li>
                <li>
                  <i class="fas fa-check-circle text-green-500 mr-2"></i>
                  <strong>Ion đơn:</strong> Bằng điện tích ion (Ví dụ: \(Na^+ =
                  +1\)).
                </li>
                <li>
                  <i class="fas fa-check-circle text-green-500 mr-2"></i>
                  <strong>Trong hợp chất:</strong>
                  <ul class="pl-8 mt-1 list-disc text-sm">
                    <li>H thường là +1 (trừ hidrua kim loại: -1).</li>
                    <li>O thường là -2 (trừ peroxit: -1, \(OF_2\): +2).</li>
                    <li>Kim loại kiềm (IA): +1, Kiềm thổ (IIA): +2.</li>
                  </ul>
                </li>
                <li>
                  <i class="fas fa-check-circle text-green-500 mr-2"></i>
                  <strong>Tổng đại số:</strong> Trong phân tử trung hoà bằng 0.
                </li>
              </ul>
            </div>
          </div>

          <!-- SIMULATION 2: Interactive OXH Calculator/Game -->
          <div
            class="bg-indigo-50 dark:bg-slate-800 p-6 rounded-2xl border-2 border-dashed border-indigo-200 dark:border-slate-600"
          >
            <div class="flex justify-between items-center mb-4">
              <h3 class="font-bold text-indigo-700 dark:text-indigo-400">
                <i class="fas fa-gamepad mr-2"></i>Mô phỏng 2: Luyện tập Số OXH
              </h3>
              <span
                id="score-display"
                class="bg-indigo-600 text-white px-3 py-1 rounded-full text-sm"
                >Điểm: 0</span
              >
            </div>

            <div class="text-center py-8">
              <p class="text-lg mb-2">
                Xác định số oxi hoá của nguyên tố màu đỏ:
              </p>
              <div
                id="quiz-compound"
                class="text-4xl font-bold font-mono mb-6 text-slate-800 dark:text-white"
              >
                K<span class="text-red-500">Mn</span>O<sub>4</sub>
              </div>

              <div class="flex justify-center gap-2 mb-4">
                <button
                  onclick="checkOxh(-1)"
                  class="w-10 h-10 rounded bg-white dark:bg-slate-700 shadow hover:bg-gray-100 font-bold"
                >
                  -
                </button>
                <input
                  type="number"
                  id="oxh-input"
                  class="w-20 text-center rounded border dark:bg-slate-700 dark:border-slate-600 text-xl font-bold"
                  value="0"
                />
                <button
                  onclick="checkOxh(1)"
                  class="w-10 h-10 rounded bg-white dark:bg-slate-700 shadow hover:bg-gray-100 font-bold"
                >
                  +
                </button>
              </div>

              <button
                onclick="submitOxh()"
                class="w-full py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-bold transition"
              >
                Kiểm Tra
              </button>
              <p id="oxh-feedback" class="mt-4 h-6 text-sm font-bold"></p>
            </div>
          </div>
        </div>
      </section>

      <!-- SECTION II: Bản Chất Phản Ứng -->
      <section id="section-2" class="scroll-mt-24">
        <div class="flex items-center gap-4 mb-8">
          <span
            class="flex items-center justify-center w-12 h-12 rounded-xl bg-teal-100 dark:bg-teal-900 text-teal-600 dark:text-teal-400 font-bold text-xl"
            >II</span
          >
          <h2 class="text-3xl font-bold">Bản Chất Phản Ứng Oxi Hoá – Khử</h2>
        </div>

        <!-- Mnemonics Box -->
        <div
          class="bg-gradient-to-r from-orange-100 to-amber-100 dark:from-slate-800 dark:to-slate-800 p-6 rounded-xl border-l-8 border-orange-500 mb-8"
        >
          <h3
            class="text-xl font-bold text-orange-700 dark:text-orange-400 mb-2"
          >
            Thần Chú Ghi Nhớ:
          </h3>
          <p class="text-2xl font-bold text-slate-800 dark:text-white">
            "KHỬ CHO – O NHẬN"
          </p>
          <p class="mt-2 text-gray-700 dark:text-gray-300">
            <span class="font-bold text-red-500">Chất Khử</span>: Cho (nhường)
            e, số oxh tăng. (Bị oxi hoá)<br />
            <span class="font-bold text-blue-500">Chất Oxi hoá</span>: Nhận e,
            số oxh giảm. (Bị khử)
          </p>
        </div>

        <!-- SIMULATION 3: Reaction Visualization (Zn + HCl) -->
        <div class="grid lg:grid-cols-2 gap-8 items-center">
          <div>
            <h3 class="text-xl font-bold mb-4">
              Mô phỏng 3: Phản ứng Zn + 2HCl
            </h3>
            <p class="mb-4 text-gray-600 dark:text-gray-400">
              Quan sát hiện tượng vĩ mô (sủi bọt khí) và vi mô (electron di
              chuyển).<br />
              Phương trình: \(Zn + 2H^+ \rightarrow Zn^{2+} + H_2 \uparrow\)
            </p>
            <div class="flex gap-4">
              <button
                onclick="startSim3()"
                class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded shadow"
              >
                <i class="fas fa-flask mr-2"></i>Thả kẽm vào axit
              </button>
              <button
                onclick="resetSim3()"
                class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded shadow"
              >
                Làm lại
              </button>
            </div>
            <div
              class="mt-4 p-4 bg-slate-100 dark:bg-slate-800 rounded text-sm"
            >
              <p>
                <strong>Quá trình oxi hoá:</strong> \(Zn \rightarrow Zn^{2+} +
                2e\)
              </p>
              <p>
                <strong>Quá trình khử:</strong> \(2H^+ + 2e \rightarrow H_2\)
              </p>
            </div>
          </div>

          <div
            class="sim-container h-80 bg-white dark:bg-slate-800 flex items-end justify-center pb-4"
          >
            <canvas id="sim3Canvas" width="400" height="300"></canvas>
          </div>
        </div>
      </section>

      <!-- SECTION III: Cân Bằng Phương Trình -->
      <section id="section-3" class="scroll-mt-24">
        <div class="flex items-center gap-4 mb-8">
          <span
            class="flex items-center justify-center w-12 h-12 rounded-xl bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 font-bold text-xl"
            >III</span
          >
          <h2 class="text-3xl font-bold">Cân Bằng Phương Trình</h2>
        </div>

        <div class="grid md:grid-cols-2 gap-12">
          <div class="space-y-6">
            <h3 class="text-xl font-bold">Phương pháp thăng bằng electron</h3>
            <ol
              class="list-decimal pl-5 space-y-3 text-gray-700 dark:text-gray-300"
            >
              <li>
                <strong>Xác định số oxh</strong> của các nguyên tố thay đổi.
              </li>
              <li><strong>Viết bán phản ứng</strong> oxi hoá và khử.</li>
              <li>
                <strong>Nhân hệ số</strong> sao cho tổng e nhường = tổng e nhận.
              </li>
              <li>
                <strong>Cộng vế với vế</strong> và đưa hệ số vào phương trình.
              </li>
              <li><strong>Kiểm tra</strong> lại số nguyên tử các nguyên tố.</li>
            </ol>

            <div
              class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-700"
            >
              <p class="text-sm font-bold text-yellow-800 dark:text-yellow-400">
                <i class="fas fa-exclamation-triangle mr-1"></i> Lưu ý:
              </p>
              <p class="text-sm mt-1">
                Đừng quên cân bằng điện tích và kiểm tra số nguyên tử Oxi cuối
                cùng.
              </p>
            </div>
          </div>

          <!-- SIMULATION 4: Interactive Balancing Scale -->
          <div
            class="bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-gray-200 dark:border-slate-700 p-6"
          >
            <h3 class="font-bold text-purple-600 dark:text-purple-400 mb-4">
              <i class="fas fa-balance-scale mr-2"></i>Mô phỏng 4: Cân bằng trực
              quan
            </h3>
            <p class="text-sm mb-4 text-center">
              Phương trình:
              <span
                class="font-mono bg-gray-100 dark:bg-slate-900 px-2 py-1 rounded"
                >Al + O₂ → Al₂O₃</span
              >
            </p>

            <div
              class="flex justify-center items-center gap-2 mb-8 font-mono text-xl"
            >
              <!-- Reactants -->
              <div class="flex flex-col items-center">
                <input
                  type="number"
                  id="coef-al"
                  min="1"
                  max="10"
                  value="1"
                  class="w-12 text-center border rounded dark:bg-slate-700"
                  onchange="updateBalance()"
                />
                <span class="text-sm text-gray-500">Al</span>
              </div>
              <span>+</span>
              <div class="flex flex-col items-center">
                <input
                  type="number"
                  id="coef-o2"
                  min="1"
                  max="10"
                  value="1"
                  class="w-12 text-center border rounded dark:bg-slate-700"
                  onchange="updateBalance()"
                />
                <span class="text-sm text-gray-500">O₂</span>
              </div>
              <span>→</span>
              <!-- Product -->
              <div class="flex flex-col items-center">
                <input
                  type="number"
                  id="coef-al2o3"
                  min="1"
                  max="10"
                  value="1"
                  class="w-12 text-center border rounded dark:bg-slate-700"
                  onchange="updateBalance()"
                />
                <span class="text-sm text-gray-500">Al₂O₃</span>
              </div>
            </div>

            <!-- Visual Representation -->
            <div
              class="flex justify-between items-end h-40 border-b-4 border-gray-300 relative mb-4"
              id="scale-base"
            >
              <!-- Left Scale -->
              <div
                id="left-pan"
                class="w-1/3 bg-blue-100 dark:bg-blue-900/50 rounded-t-lg transition-all duration-500 flex flex-wrap content-end p-2 gap-1 justify-center"
                style="height: 50%"
              >
                <!-- Atoms injected via JS -->
              </div>

              <!-- Center Fulcrum -->
              <div
                class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-b-[30px] border-b-gray-400"
              ></div>

              <!-- Right Scale -->
              <div
                id="right-pan"
                class="w-1/3 bg-green-100 dark:bg-green-900/50 rounded-t-lg transition-all duration-500 flex flex-wrap content-end p-2 gap-1 justify-center"
                style="height: 50%"
              >
                <!-- Atoms injected via JS -->
              </div>
            </div>

            <p id="balance-msg" class="text-center font-bold text-red-500">
              Chưa cân bằng!
            </p>
          </div>
        </div>
      </section>

      <!-- SECTION IV: Ý Nghĩa & Ứng Dụng -->
      <section id="section-4" class="scroll-mt-24 pb-20">
        <div class="flex items-center gap-4 mb-8">
          <span
            class="flex items-center justify-center w-12 h-12 rounded-xl bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 font-bold text-xl"
            >IV</span
          >
          <h2 class="text-3xl font-bold">Ý Nghĩa Thực Tiễn</h2>
        </div>

        <!-- Cards Grid -->
        <div class="grid md:grid-cols-3 gap-6 mb-12">
          <div
            class="chem-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-100 dark:border-slate-700"
          >
            <div
              class="w-12 h-12 bg-yellow-100 text-yellow-600 rounded-full flex items-center justify-center mb-4 text-2xl"
            >
              <i class="fas fa-bolt"></i>
            </div>
            <h3 class="font-bold text-lg mb-2">Sản xuất năng lượng</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              Pin điện hoá, ắc quy chì, pin Lithium-ion đều hoạt động dựa trên
              phản ứng oxi hoá khử để sinh dòng điện.
            </p>
          </div>
          <div
            class="chem-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-100 dark:border-slate-700"
          >
            <div
              class="w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-4 text-2xl"
            >
              <i class="fas fa-leaf"></i>
            </div>
            <h3 class="font-bold text-lg mb-2">Sinh học</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              Quang hợp (khử CO₂) và Hô hấp tế bào (oxi hoá Glucose) là chuỗi
              phản ứng redox duy trì sự sống.
            </p>
          </div>
          <div
            class="chem-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-100 dark:border-slate-700"
          >
            <div
              class="w-12 h-12 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center mb-4 text-2xl"
            >
              <i class="fas fa-industry"></i>
            </div>
            <h3 class="font-bold text-lg mb-2">Công nghiệp</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              Luyện kim (khử quặng sắt), sản xuất hoá chất (H₂SO₄, NH₃), mạ điện
              và chống ăn mòn kim loại.
            </p>
          </div>
        </div>

        <!-- SIMULATION 5: Galvanic Cell -->
        <div
          class="bg-slate-900 text-white rounded-2xl p-8 shadow-2xl relative overflow-hidden"
        >
          <div class="absolute top-0 right-0 p-4 opacity-10 text-9xl">
            <i class="fas fa-battery-full"></i>
          </div>
          <div class="relative z-10 grid lg:grid-cols-2 gap-8">
            <div>
              <h3 class="text-2xl font-bold mb-4 text-yellow-400">
                Mô phỏng 5: Pin Điện Hoá (Pin Daniell)
              </h3>
              <p class="mb-6 text-gray-300">
                Hệ thống chuyển năng lượng hoá học thành điện năng.
                <br />Cực Âm (Zn): Oxi hoá. Cực Dương (Cu): Khử.
              </p>

              <div class="flex items-center gap-4 mb-6">
                <button
                  id="btn-toggle-cell"
                  onclick="toggleCell()"
                  class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-full font-bold shadow-lg shadow-green-500/50 transition"
                >
                  <i class="fas fa-power-off mr-2"></i> Bật/Tắt Pin
                </button>
                <div class="flex flex-col">
                  <span class="text-xs text-gray-400">Vôn kế</span>
                  <span
                    id="voltmeter"
                    class="font-mono text-2xl text-yellow-400"
                    >0.00 V</span
                  >
                </div>
              </div>

              <div class="text-sm space-y-2 text-gray-400">
                <p>
                  <span class="text-red-400 font-bold">Anot (-):</span> \(Zn
                  \rightarrow Zn^{2+} + 2e\)
                </p>
                <p>
                  <span class="text-blue-400 font-bold">Catot (+):</span>
                  \(Cu^{2+} + 2e \rightarrow Cu\)
                </p>
              </div>
            </div>

            <!-- SVG Visual of Galvanic Cell -->
            <div
              class="relative h-64 bg-slate-800 rounded-xl border border-slate-700 p-4 flex justify-center items-end"
            >
              <!-- Beaker Left (Zn) -->
              <div
                class="relative w-24 h-32 bg-blue-900/30 border-b-2 border-l-2 border-r-2 border-slate-500 rounded-b-lg mx-4"
              >
                <div
                  class="absolute bottom-0 w-full h-24 bg-blue-500/20 w-full"
                ></div>
                <!-- Solution -->
                <div
                  id="zn-rod"
                  class="absolute bottom-4 left-6 w-8 h-36 bg-gray-400 border border-gray-300"
                ></div>
                <!-- Rod -->
                <div class="absolute -bottom-8 w-full text-center text-xs">
                  ZnSO₄
                </div>
              </div>

              <!-- Salt Bridge -->
              <div
                class="absolute bottom-24 w-32 h-12 border-t-8 border-x-8 border-gray-600 rounded-t-full pointer-events-none z-0"
              ></div>

              <!-- Beaker Right (Cu) -->
              <div
                class="relative w-24 h-32 bg-blue-900/30 border-b-2 border-l-2 border-r-2 border-slate-500 rounded-b-lg mx-4"
              >
                <div
                  class="absolute bottom-0 w-full h-24 bg-blue-600/30 w-full"
                ></div>
                <!-- Solution -->
                <div
                  id="cu-rod"
                  class="absolute bottom-4 left-6 w-8 h-36 bg-orange-700 border border-orange-600"
                ></div>
                <!-- Rod -->
                <div class="absolute -bottom-8 w-full text-center text-xs">
                  CuSO₄
                </div>
              </div>

              <!-- Wires & Bulb -->
              <svg
                class="absolute top-0 w-full h-full pointer-events-none z-20"
              >
                <path
                  d="M 90 60 L 90 20 L 290 20 L 290 60"
                  fill="none"
                  stroke="#F59E0B"
                  stroke-width="2"
                />
                <circle
                  cx="190"
                  cy="20"
                  r="15"
                  fill="#333"
                  stroke="#F59E0B"
                  stroke-width="2"
                  id="bulb"
                />
                <circle
                  cx="95"
                  cy="20"
                  r="3"
                  fill="#FFFF00"
                  class="electron hidden"
                />
              </svg>

              <!-- Glow Effect -->
              <div
                id="bulb-glow"
                class="absolute top-2 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-yellow-400 rounded-full blur-xl opacity-0 transition duration-300"
              ></div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Scripts Implementation -->
    <script>
      // --- 1. Dark Mode Toggle ---
      const themeToggle = document.getElementById("theme-toggle");
      const html = document.documentElement;

      themeToggle.addEventListener("click", () => {
        html.classList.toggle("dark");
        localStorage.setItem(
          "theme",
          html.classList.contains("dark") ? "dark" : "light"
        );
      });

      // Check local storage
      if (
        localStorage.getItem("theme") === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        html.classList.add("dark");
      }

      // --- 2. Sim 1: Three.js Atom (Hero) ---
      function initThreeJS() {
        const container = document.getElementById("sim-3d-atom");
        const scene = new THREE.Scene();

        // Camera
        const camera = new THREE.PerspectiveCamera(
          75,
          container.clientWidth / container.clientHeight,
          0.1,
          1000
        );
        camera.position.z = 5;

        // Renderer
        const renderer = new THREE.WebGLRenderer({
          alpha: true,
          antialias: true,
        });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        // Objects
        // Nucleus
        const nucleusGeo = new THREE.SphereGeometry(0.8, 32, 32);
        const nucleusMat = new THREE.MeshPhongMaterial({
          color: 0xff4444,
          emissive: 0x550000,
        });
        const nucleus = new THREE.Mesh(nucleusGeo, nucleusMat);
        scene.add(nucleus);

        // Electrons Groups
        const electronGeo = new THREE.SphereGeometry(0.15, 16, 16);
        const electronMat = new THREE.MeshPhongMaterial({
          color: 0x44aaff,
          emissive: 0x002255,
        });

        const orbits = [];
        const electrons = [];

        for (let i = 0; i < 3; i++) {
          const orbitGroup = new THREE.Group();
          const electron = new THREE.Mesh(electronGeo, electronMat);
          electron.position.x = 2 + i * 0.5;
          orbitGroup.add(electron);

          // Random rotation for orbit
          orbitGroup.rotation.x = Math.random() * Math.PI;
          orbitGroup.rotation.y = Math.random() * Math.PI;

          scene.add(orbitGroup);
          orbits.push({
            group: orbitGroup,
            speed: 0.02 + Math.random() * 0.02,
          });
        }

        // Lights
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(5, 5, 5);
        scene.add(pointLight);
        scene.add(new THREE.AmbientLight(0x404040));

        // Animation
        function animate() {
          requestAnimationFrame(animate);

          nucleus.rotation.y += 0.01;

          orbits.forEach((o) => {
            o.group.rotation.z += o.speed;
            o.group.rotation.y += 0.005;
          });

          renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener("resize", () => {
          camera.aspect = container.clientWidth / container.clientHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(container.clientWidth, container.clientHeight);
        });
      }

      // --- 3. Sim 2: Quiz Logic ---
      const quizData = [
        {
          compound: 'K<span class="text-red-500">Mn</span>O<sub>4</sub>',
          ans: 7,
        },
        {
          compound:
            'H<sub>2</sub><span class="text-red-500">S</span>O<sub>4</sub>',
          ans: 6,
        },
        {
          compound: '<span class="text-red-500">N</span>H<sub>3</sub>',
          ans: -3,
        },
        {
          compound: '<span class="text-red-500">Fe</span>Cl<sub>2</sub>',
          ans: 2,
        },
      ];
      let currentQuizIndex = 0;
      let score = 0;

      function updateQuizUI() {
        document.getElementById("quiz-compound").innerHTML =
          quizData[currentQuizIndex].compound;
        document.getElementById("oxh-input").value = 0;
        document.getElementById("oxh-feedback").innerText = "";
        document.getElementById("oxh-feedback").className =
          "mt-4 h-6 text-sm font-bold";
      }

      function checkOxh(delta) {
        const input = document.getElementById("oxh-input");
        input.value = parseInt(input.value) + delta;
      }

      function submitOxh() {
        const val = parseInt(document.getElementById("oxh-input").value);
        const correct = quizData[currentQuizIndex].ans;
        const fb = document.getElementById("oxh-feedback");

        if (val === correct) {
          fb.innerText = "Chính xác! (+10 điểm)";
          fb.classList.add("text-green-600");
          score += 10;
          document.getElementById("score-display").innerText = `Điểm: ${score}`;

          setTimeout(() => {
            currentQuizIndex = (currentQuizIndex + 1) % quizData.length;
            updateQuizUI();
          }, 1500);
        } else {
          fb.innerText = "Sai rồi, hãy thử lại!";
          fb.classList.add("text-red-500");
        }
      }

      // --- 4. Sim 3: Zn + HCl (Canvas) ---
      let sim3Running = false;
      let bubbles = [];
      let znSize = 60;

      function initSim3() {
        const canvas = document.getElementById("sim3Canvas");
        const ctx = canvas.getContext("2d");

        function draw() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);

          // Draw Beaker Liquid
          ctx.fillStyle = "rgba(100, 200, 255, 0.3)";
          ctx.fillRect(100, 100, 200, 200);

          // Draw Beaker Outline
          ctx.strokeStyle = "#aaa";
          ctx.lineWidth = 4;
          ctx.beginPath();
          ctx.moveTo(100, 80);
          ctx.lineTo(100, 300);
          ctx.lineTo(300, 300);
          ctx.lineTo(300, 80);
          ctx.stroke();

          // Draw Zn Strip
          if (znSize > 0) {
            ctx.fillStyle = "#9ca3af"; // zinc gray
            ctx.fillRect(180, 300 - znSize * 2, 40, znSize * 2);
            // Label
            ctx.fillStyle = "#000";
            ctx.font = "12px Arial";
            ctx.fillText("Zn", 190, 300 - znSize + 5);
          }

          // Draw Bubbles
          if (sim3Running) {
            ctx.fillStyle = "rgba(255,255,255,0.8)";
            for (let i = 0; i < bubbles.length; i++) {
              let b = bubbles[i];
              ctx.beginPath();
              ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
              ctx.fill();
              b.y -= b.speed;
              b.x += Math.sin(b.y * 0.05) * 0.5; // wiggle

              if (b.y < 90) {
                // Surface
                bubbles.splice(i, 1);
                i--;
              }
            }
            // Generate new bubbles
            if (znSize > 0 && Math.random() < 0.2) {
              bubbles.push({
                x: 180 + Math.random() * 40,
                y: 300 - Math.random() * znSize,
                r: 2 + Math.random() * 3,
                speed: 1 + Math.random() * 2,
              });
            }

            // Erode Zn
            if (znSize > 5) znSize -= 0.05;
          }

          requestAnimationFrame(draw);
        }
        draw();
      }

      function startSim3() {
        sim3Running = true;
      }
      function resetSim3() {
        sim3Running = false;
        znSize = 60;
        bubbles = [];
      }

      // --- 5. Sim 4: Balancing Logic ---
      function updateBalance() {
        const al = parseInt(document.getElementById("coef-al").value);
        const o2 = parseInt(document.getElementById("coef-o2").value);
        const prod = parseInt(document.getElementById("coef-al2o3").value);

        // Count atoms
        const leftAl = al * 1;
        const leftO = o2 * 2;
        const rightAl = prod * 2;
        const rightO = prod * 3;

        // Visuals
        const leftPan = document.getElementById("left-pan");
        const rightPan = document.getElementById("right-pan");

        // Clear & Rebuild Visuals (Simplified representation dots)
        leftPan.innerHTML = "";
        rightPan.innerHTML = "";

        // Add Al dots (Silver)
        for (let i = 0; i < leftAl; i++)
          leftPan.innerHTML += `<div class="w-4 h-4 rounded-full bg-gray-400 border border-gray-600"></div>`;
        // Add O dots (Red)
        for (let i = 0; i < leftO; i++)
          leftPan.innerHTML += `<div class="w-4 h-4 rounded-full bg-red-500 border border-red-700"></div>`;

        // Right Side
        for (let i = 0; i < rightAl; i++)
          rightPan.innerHTML += `<div class="w-4 h-4 rounded-full bg-gray-400 border border-gray-600"></div>`;
        for (let i = 0; i < rightO; i++)
          rightPan.innerHTML += `<div class="w-4 h-4 rounded-full bg-red-500 border border-red-700"></div>`;

        // Calculate Mass for scale tilt (Arbitrary weights: Al=2, O=1)
        const massLeft = leftAl * 2 + leftO * 1;
        const massRight = rightAl * 2 + rightO * 1;

        const diff = massLeft - massRight;
        // Tilt animation
        const maxTilt = 20; // px
        let tilt = Math.max(Math.min(diff * 2, maxTilt), -maxTilt);

        leftPan.style.transform = `translateY(${tilt}px)`;
        rightPan.style.transform = `translateY(${-tilt}px)`;

        // Check correctness
        const msg = document.getElementById("balance-msg");
        if (leftAl === rightAl && leftO === rightO) {
          msg.innerText = "Chính xác! Phương trình đã cân bằng.";
          msg.className = "text-center font-bold text-green-600";
        } else {
          msg.innerText = `Chưa cân bằng! (Al: ${leftAl} vs ${rightAl}, O: ${leftO} vs ${rightO})`;
          msg.className = "text-center font-bold text-red-500";
        }
      }

      // --- 6. Sim 5: Galvanic Cell ---
      let cellActive = false;
      let electronInterval;

      function toggleCell() {
        cellActive = !cellActive;
        const btn = document.getElementById("btn-toggle-cell");
        const electrons = document.querySelectorAll(".electron");
        const bulbGlow = document.getElementById("bulb-glow");
        const voltmeter = document.getElementById("voltmeter");
        const bulb = document.getElementById("bulb");

        if (cellActive) {
          btn.innerHTML = `<i class="fas fa-pause mr-2"></i> Tắt Pin`;
          btn.classList.replace("bg-green-600", "bg-red-600");
          btn.classList.replace("hover:bg-green-700", "hover:bg-red-700");

          voltmeter.innerText = "1.10 V";
          bulbGlow.classList.replace("opacity-0", "opacity-100");
          bulb.setAttribute("fill", "#FFFF00");

          // Animate electrons
          let pos = 90;
          electronInterval = setInterval(() => {
            // Logic to move a dot along the path points roughly
            // Simplified: Just toggle visibility/position of a CSS/SVG element is harder without SMIL or heavy JS
            // We'll just show the electron circle blink or move for effect
            const e = document.querySelector(".electron");
            e.classList.remove("hidden");
            // Simple animation loop for the demo
            e.setAttribute("cx", pos);
            pos += 5;
            if (pos > 290) pos = 90;
          }, 50);
        } else {
          btn.innerHTML = `<i class="fas fa-power-off mr-2"></i> Bật Pin`;
          btn.classList.replace("bg-red-600", "bg-green-600");
          btn.classList.replace("hover:bg-red-700", "hover:bg-green-700");

          voltmeter.innerText = "0.00 V";
          bulbGlow.classList.replace("opacity-100", "opacity-0");
          bulb.setAttribute("fill", "#333");

          clearInterval(electronInterval);
          document.querySelector(".electron").classList.add("hidden");
        }
      }

      // Initialize things on load
      window.onload = function () {
        initThreeJS();
        updateQuizUI();
        initSim3();
        updateBalance();
      };

      function scrollToSim() {
        document
          .getElementById("sim-3d-atom")
          .scrollIntoView({ behavior: "smooth" });
      }
    </script>
  </body>
</html>
