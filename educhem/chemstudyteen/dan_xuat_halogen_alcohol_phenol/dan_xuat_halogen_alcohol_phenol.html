<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      ChemStudy Teen - Chương 5: Dẫn xuất Halogen - Alcohol - Phenol
    </title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />

    <!-- Thư viện -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: { sans: ["Nunito", "sans-serif"] },
            colors: {
              primary: "#3b82f6", // Blue
              halogen: "#8b5cf6", // Purple
              alcohol: "#0ea5e9", // Sky
              phenol: "#ef4444", // Red
              darkBg: "#0f172a",
              darkCard: "#1e293b",
            },
            animation: {
              float: "float 6s ease-in-out infinite",
              bubble: "bubble 2s infinite ease-in",
            },
            keyframes: {
              float: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-10px)" },
              },
              bubble: {
                "0%": { bottom: "0", opacity: "0", transform: "scale(0.5)" },
                "50%": { opacity: "1" },
                "100%": {
                  bottom: "100%",
                  opacity: "0",
                  transform: "scale(1.2)",
                },
              },
            },
          },
        },
      };
    </script>

    <style>
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
      .dark ::-webkit-scrollbar-thumb {
        background: #475569;
      }

      /* Utility classes for Chemistry */
      .canvas-3d {
        width: 100%;
        height: 300px;
        border-radius: 1rem;
        cursor: move;
      }

      .test-tube {
        width: 40px;
        height: 120px;
        border: 2px solid #94a3b8;
        border-top: none;
        border-radius: 0 0 20px 20px;
        position: relative;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.1);
        margin: 0 auto;
      }
      .liquid {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        transition: all 1s ease;
      }
      .precipitate {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 0;
        transition: all 1s ease;
        opacity: 0.9;
      }
      .gas-bubble {
        position: absolute;
        background: white;
        border-radius: 50%;
        opacity: 0.7;
        animation: bubble 1.5s infinite;
      }
    </style>
  </head>
  <body
    class="bg-gray-50 text-gray-800 dark:bg-darkBg dark:text-gray-100 transition-colors duration-300 min-h-screen flex flex-col"
  >
    <!-- Header & Navigation -->
    <header
      class="sticky top-0 z-50 bg-white/90 dark:bg-darkCard/90 backdrop-blur-md shadow-sm border-b border-gray-200 dark:border-gray-700"
    >
      <div class="max-w-7xl mx-auto px-4">
        <div class="flex items-center justify-between h-16">
          <!-- Left: Back & Logo -->
          <div class="flex items-center gap-4">
            <a
              href="../chemstudyteen.html"
              class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition group"
              title="Quay về"
            >
              <i
                class="fa-solid fa-arrow-left text-xl text-gray-600 dark:text-gray-300 group-hover:text-primary"
              ></i>
            </a>
            <div class="flex items-center gap-2 select-none">
              <i
                class="fa-solid fa-flask-vial text-2xl text-primary animate-pulse"
              ></i>
              <span
                class="font-extrabold text-xl tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-purple-600"
              >
                ChemStudy Teen
              </span>
            </div>
          </div>

          <!-- Center: Tabs -->
          <nav
            class="hidden md:flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-xl"
          >
            <button
              onclick="switchTab('halogen')"
              class="tab-btn active px-4 py-1.5 rounded-lg text-sm font-bold transition-all bg-white dark:bg-gray-700 shadow text-halogen"
            >
              Dẫn xuất Halogen
            </button>
            <button
              onclick="switchTab('alcohol')"
              class="tab-btn px-4 py-1.5 rounded-lg text-sm font-bold transition-all text-gray-500 hover:text-alcohol"
            >
              Alcohol
            </button>
            <button
              onclick="switchTab('phenol')"
              class="tab-btn px-4 py-1.5 rounded-lg text-sm font-bold transition-all text-gray-500 hover:text-phenol"
            >
              Phenol
            </button>
          </nav>

          <!-- Right: Theme Toggle -->
          <button
            id="theme-toggle"
            class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-yellow-500 hover:bg-gray-200 dark:hover:bg-gray-600 transition shadow-sm"
          >
            <i class="fa-solid fa-sun text-lg dark:hidden"></i>
            <i class="fa-solid fa-moon text-lg hidden dark:block"></i>
          </button>
        </div>
        <!-- Mobile Tabs -->
        <div class="md:hidden flex space-x-2 py-2 overflow-x-auto no-scrollbar">
          <button
            onclick="switchTab('halogen')"
            class="tab-btn-m flex-shrink-0 px-3 py-1 bg-halogen text-white rounded-full text-xs font-bold"
          >
            Halogen
          </button>
          <button
            onclick="switchTab('alcohol')"
            class="tab-btn-m flex-shrink-0 px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full text-xs font-bold"
          >
            Alcohol
          </button>
          <button
            onclick="switchTab('phenol')"
            class="tab-btn-m flex-shrink-0 px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full text-xs font-bold"
          >
            Phenol
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-6 max-w-7xl">
      <!-- TAB 1: DẪN XUẤT HALOGEN -->
      <section id="tab-halogen" class="tab-content block animate-float">
        <div class="grid lg:grid-cols-12 gap-6">
          <!-- Theory -->
          <div class="lg:col-span-7 space-y-6">
            <div
              class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6 border-l-4 border-halogen"
            >
              <h2 class="text-2xl font-bold text-halogen mb-3">
                <i class="fa-solid fa-atom mr-2"></i>I. DẪN XUẤT HALOGEN
              </h2>
              <div class="space-y-4 text-sm">
                <div>
                  <h3 class="font-bold text-gray-800 dark:text-white">
                    1. Khái niệm
                  </h3>
                  <p class="text-gray-600 dark:text-gray-300">
                    Hợp chất hữu cơ có nguyên tử Halogen (F, Cl, Br, I) liên kết
                    với mạch carbon. CTTQ: R–X.
                  </p>
                </div>
                <div>
                  <h3 class="font-bold text-gray-800 dark:text-white">
                    2. Đồng phân & Danh pháp
                  </h3>
                  <ul
                    class="list-disc list-inside text-gray-600 dark:text-gray-300 ml-2"
                  >
                    <li>Đồng phân: Mạch carbon, vị trí halogen.</li>
                    <li>
                      Tên IUPAC: Vị trí + tên halogen + tên mạch ankyl (VD:
                      2-chloropropane).
                    </li>
                  </ul>
                </div>
                <!-- Sim 1: Naming -->
                <div
                  class="mt-2 bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-dashed border-halogen"
                >
                  <div class="flex justify-between items-center mb-2">
                    <span class="text-xs font-bold text-halogen"
                      >Mô phỏng 1: Gọi tên</span
                    >
                  </div>
                  <div class="text-center font-mono font-bold text-lg mb-2">
                    CH<sub>3</sub>-CH(Br)-CH<sub>3</sub>
                  </div>
                  <div class="grid grid-cols-2 gap-2">
                    <button
                      onclick="checkName(this, true)"
                      class="text-xs p-2 bg-white dark:bg-gray-700 rounded shadow hover:bg-green-100"
                    >
                      2-bromopropane
                    </button>
                    <button
                      onclick="checkName(this, false)"
                      class="text-xs p-2 bg-white dark:bg-gray-700 rounded shadow hover:bg-red-100"
                    >
                      1-bromopropane
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6">
              <h3 class="font-bold text-gray-800 dark:text-white mb-2">
                3. Tính chất vật lí
              </h3>
              <p class="text-sm text-gray-600 mb-2">
                Không tan trong nước, tan trong dung môi hữu cơ. Nhiệt độ sôi
                tăng theo chiều tăng khối lượng halogen.
              </p>
              <!-- Sim 2: Boiling Point Chart -->
              <div
                class="h-40 bg-gray-50 dark:bg-gray-800 rounded-xl p-2 relative"
              >
                <span
                  class="absolute top-2 left-2 text-[10px] font-bold bg-white dark:bg-gray-700 px-2 rounded shadow"
                  >Mô phỏng 2: Nhiệt độ sôi</span
                >
                <canvas id="bpChart"></canvas>
              </div>
            </div>

            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6">
              <h3 class="font-bold text-gray-800 dark:text-white mb-2">
                4. Tính chất hoá học
              </h3>

              <!-- Sim 3: Hydrolysis -->
              <div
                class="mb-4 bg-purple-50 dark:bg-purple-900/20 p-4 rounded-xl"
              >
                <h4
                  class="font-bold text-sm text-purple-700 dark:text-purple-300 mb-2"
                >
                  a. Phản ứng thế (Thủy phân) - Mô phỏng 3
                </h4>
                <p class="text-xs mb-2">R–X + NaOH → R–OH + NaX</p>
                <div class="flex items-center gap-4">
                  <div class="test-tube bg-white/20">
                    <div
                      id="hydrolysis-liquid"
                      class="liquid h-1/2 bg-transparent border-t border-gray-400"
                    ></div>
                  </div>
                  <button
                    onclick="runHydrolysis()"
                    class="text-xs bg-purple-600 text-white px-3 py-1 rounded shadow hover:bg-purple-700"
                  >
                    Thêm NaOH & Đun nóng
                  </button>
                </div>
                <div
                  id="hydrolysis-res"
                  class="text-xs mt-1 text-green-600 font-bold opacity-0"
                >
                  Dung dịch phân lớp biến mất (đồng nhất)
                </div>
              </div>

              <!-- Sim 4: Elimination -->
              <div class="bg-orange-50 dark:bg-orange-900/20 p-4 rounded-xl">
                <h4
                  class="font-bold text-sm text-orange-700 dark:text-orange-300 mb-2"
                >
                  c. Phản ứng tách (Quy tắc Zaitsev) - Mô phỏng 4
                </h4>
                <div class="text-xs mb-2 font-mono">
                  CH<sub>3</sub>-CH(Br)-CH<sub>2</sub>-CH<sub>3</sub> + KOH
                  (ethanol)
                </div>
                <div class="grid grid-cols-2 gap-2">
                  <button
                    onclick="checkZaitsev(this, true)"
                    class="p-2 border rounded bg-white dark:bg-gray-700 text-xs hover:bg-green-100"
                  >
                    SP Chính: CH<sub>3</sub>-CH=CH-CH<sub>3</sub>
                  </button>
                  <button
                    onclick="checkZaitsev(this, false)"
                    class="p-2 border rounded bg-white dark:bg-gray-700 text-xs hover:bg-red-100"
                  >
                    SP Phụ: CH<sub>2</sub>=CH-CH<sub>2</sub>-CH<sub>3</sub>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Visuals -->
          <div class="lg:col-span-5 space-y-6">
            <!-- Sim 5: 3D Molecule -->
            <div class="bg-gray-800 rounded-2xl shadow-xl p-1 relative">
              <span
                class="absolute top-2 left-2 px-2 py-1 bg-black/60 text-white text-[10px] font-bold rounded z-10"
                >Mô phỏng 5: Chloroethane 3D</span
              >
              <div id="canvas-halogen" class="canvas-3d"></div>
            </div>

            <!-- Sim 6: CFC -->
            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-4">
              <h4 class="font-bold text-sm text-gray-800 dark:text-white mb-2">
                Mô phỏng 6: CFC phá hủy Ozone
              </h4>
              <div
                class="h-32 bg-blue-100 dark:bg-blue-900/30 rounded-lg relative overflow-hidden"
                id="ozone-sim"
              >
                <div class="absolute top-2 right-2 text-[10px] text-gray-500">
                  Tầng Ozone
                </div>
                <div
                  class="ozone-layer w-full h-8 bg-blue-300 absolute top-4 opacity-50"
                ></div>
                <div
                  id="cfc-particle"
                  class="w-4 h-4 bg-red-500 rounded-full absolute bottom-2 left-1/2 transition-all duration-1000"
                ></div>
              </div>
              <button
                onclick="runCFC()"
                class="w-full mt-2 py-1 bg-red-500 text-white text-xs rounded font-bold"
              >
                Phóng thích gốc Cl•
              </button>
            </div>

            <!-- Sim 7: Polymerization PVC -->
            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-4">
              <h4 class="font-bold text-sm text-gray-800 dark:text-white mb-2">
                Mô phỏng 7: Tổng hợp PVC
              </h4>
              <div
                class="flex items-center justify-center gap-1 h-16 bg-gray-100 dark:bg-gray-700 rounded overflow-hidden"
                id="pvc-chain"
              >
                <div class="text-xs text-gray-400">Vinyl Chloride (n)</div>
              </div>
              <button
                onclick="makePVC()"
                class="w-full mt-2 py-1 bg-green-500 text-white text-xs rounded font-bold"
              >
                Trùng hợp (t°, p, xt)
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB 2: ALCOHOL -->
      <section id="tab-alcohol" class="tab-content hidden animate-float">
        <div class="grid lg:grid-cols-12 gap-6">
          <div class="lg:col-span-7 space-y-6">
            <div
              class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6 border-l-4 border-alcohol"
            >
              <h2 class="text-2xl font-bold text-alcohol mb-3">
                <i class="fa-solid fa-wine-bottle mr-2"></i>II. ALCOHOL
              </h2>
              <div class="space-y-4 text-sm">
                <div>
                  <h3 class="font-bold text-gray-800 dark:text-white">
                    1. Khái niệm & Cấu trúc
                  </h3>
                  <p class="text-gray-600 dark:text-gray-300">
                    Nhóm –OH gắn vào C no (sp³). CTTQ: R–OH. Phân loại theo bậc
                    carbon (1°, 2°, 3°).
                  </p>
                </div>
                <!-- Sim 8: Classify -->
                <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl">
                  <span class="text-xs font-bold text-alcohol"
                    >Mô phỏng 8: Phân loại bậc</span
                  >
                  <div class="flex gap-2 mt-2">
                    <button
                      onclick="showAlcClass(1)"
                      class="flex-1 py-1 bg-white dark:bg-gray-700 rounded text-xs shadow hover:text-alcohol"
                    >
                      Bậc 1
                    </button>
                    <button
                      onclick="showAlcClass(2)"
                      class="flex-1 py-1 bg-white dark:bg-gray-700 rounded text-xs shadow hover:text-alcohol"
                    >
                      Bậc 2
                    </button>
                    <button
                      onclick="showAlcClass(3)"
                      class="flex-1 py-1 bg-white dark:bg-gray-700 rounded text-xs shadow hover:text-alcohol"
                    >
                      Bậc 3
                    </button>
                  </div>
                  <div
                    id="alc-class-display"
                    class="mt-2 text-center font-mono font-bold text-sm h-6"
                  >
                    Chọn bậc để xem
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6">
              <h3 class="font-bold text-gray-800 dark:text-white mb-2">
                3. Tính chất vật lí
              </h3>
              <!-- Sim 9: Solubility -->
              <div class="grid grid-cols-2 gap-4">
                <div
                  class="bg-gray-100 dark:bg-gray-700 p-3 rounded-xl text-center cursor-pointer"
                  onclick="shakeSolubility()"
                >
                  <div
                    class="text-[10px] font-bold mb-1 uppercase text-gray-500"
                  >
                    Mô phỏng 9: Độ tan
                  </div>
                  <div
                    class="h-20 bg-white/50 rounded relative overflow-hidden mx-auto w-12 border border-gray-300"
                  >
                    <div
                      class="absolute bottom-0 w-full h-1/2 bg-blue-300"
                    ></div>
                    <div
                      id="alc-layer"
                      class="absolute top-0 w-full h-1/2 bg-yellow-200 opacity-50 transition-all duration-1000"
                    ></div>
                  </div>
                  <span class="text-[10px]">Nhấn để lắc (Tan vô hạn)</span>
                </div>
                <!-- Sim 10: H-Bond -->
                <div
                  class="bg-gray-100 dark:bg-gray-700 p-3 rounded-xl text-center"
                >
                  <div
                    class="text-[10px] font-bold mb-1 uppercase text-gray-500"
                  >
                    Mô phỏng 10: Liên kết H
                  </div>
                  <div
                    class="h-20 flex items-center justify-center gap-1 text-lg font-bold"
                  >
                    <span class="text-red-500">O</span
                    ><span class="text-xs">H</span>
                    <span class="text-blue-500 text-xs animate-pulse">...</span>
                    <span class="text-red-500">O</span
                    ><span class="text-xs">H</span>
                  </div>
                  <span class="text-[10px]">Giải thích t° sôi cao</span>
                </div>
              </div>
            </div>

            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6">
              <h3 class="font-bold text-gray-800 dark:text-white mb-2">
                4. Tính chất hoá học
              </h3>

              <!-- Sim 11: Reaction Na -->
              <div
                class="mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200"
              >
                <h4 class="font-bold text-sm text-blue-600 mb-1">
                  a. Tác dụng với Na - Mô phỏng 11
                </h4>
                <div class="flex items-center gap-4">
                  <div class="test-tube bg-white/30 relative">
                    <div
                      class="liquid h-1/3 bg-blue-100 w-full bottom-0 absolute"
                    ></div>
                    <div
                      id="na-bubbles"
                      class="hidden w-full h-full absolute bottom-0"
                    >
                      <!-- Bubbles injected by JS -->
                    </div>
                  </div>
                  <button
                    onclick="runNaReaction()"
                    class="text-xs bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-700"
                  >
                    Thả mẩu Na
                  </button>
                </div>
              </div>

              <!-- Sim 12: Reaction CuO -->
              <div
                class="mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200"
              >
                <h4 class="font-bold text-sm text-orange-600 mb-1">
                  b. Oxi hóa bởi CuO (t°) - Mô phỏng 12
                </h4>
                <div class="flex items-center gap-4">
                  <div
                    class="w-20 h-2 bg-black rounded relative transition-colors duration-1000"
                    id="cuo-wire"
                  >
                    <span class="absolute -top-4 left-0 text-[10px]"
                      >Dây đồng</span
                    >
                  </div>
                  <button
                    onclick="runCuOReaction()"
                    class="text-xs bg-orange-500 text-white px-3 py-1 rounded hover:bg-orange-600"
                  >
                    Đun nóng
                  </button>
                </div>
                <p
                  id="cuo-res"
                  class="text-xs mt-1 italic text-red-500 opacity-0"
                >
                  Dây đồng đen (CuO) chuyển sang đỏ (Cu)
                </p>
              </div>

              <!-- Sim 13: Dehydration -->
              <div
                class="bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200"
              >
                <h4 class="font-bold text-sm text-red-600 mb-1">
                  c. Phản ứng tách nước - Mô phỏng 13
                </h4>
                <div class="flex items-center gap-2 mb-2">
                  <span class="text-xs">Nhiệt độ:</span>
                  <input
                    type="range"
                    min="100"
                    max="200"
                    value="100"
                    class="w-32"
                    oninput="updateDehydration(this.value)"
                    id="temp-slider"
                  />
                  <span class="text-xs font-bold" id="temp-val">100°C</span>
                </div>
                <div
                  id="dehydration-res"
                  class="text-xs font-bold text-center h-4 text-primary"
                >
                  Chưa phản ứng
                </div>
              </div>
            </div>
          </div>

          <!-- Visuals -->
          <div class="lg:col-span-5 space-y-6">
            <!-- Sim 14: 3D Ethanol -->
            <div class="bg-gray-800 rounded-2xl shadow-xl p-1 relative">
              <span
                class="absolute top-2 left-2 px-2 py-1 bg-black/60 text-white text-[10px] font-bold rounded z-10"
                >Mô phỏng 14: Ethanol 3D</span
              >
              <div id="canvas-alcohol" class="canvas-3d"></div>
            </div>

            <!-- Sim 15: Breathalyzer -->
            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-4">
              <h4 class="font-bold text-sm text-gray-800 dark:text-white mb-2">
                Mô phỏng 15: Máy đo nồng độ cồn
              </h4>
              <p class="text-[10px] text-gray-500 mb-2">
                CrO<sub>3</sub> (đỏ cam) → Cr<sub>2</sub>O<sub>3</sub> (xanh
                lục) khi gặp hơi cồn.
              </p>
              <div
                class="h-10 w-full bg-orange-500 rounded-full relative overflow-hidden transition-colors duration-2000"
                id="breath-sensor"
              >
                <div
                  class="absolute inset-0 flex items-center justify-center text-white text-xs font-bold"
                >
                  Cảm biến
                </div>
              </div>
              <button
                onclick="blowBreath()"
                class="w-full mt-2 py-1 bg-blue-500 text-white text-xs rounded font-bold"
              >
                Thổi hơi cồn
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB 3: PHENOL -->
      <section id="tab-phenol" class="tab-content hidden animate-float">
        <div class="grid lg:grid-cols-12 gap-6">
          <div class="lg:col-span-7 space-y-6">
            <div
              class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6 border-l-4 border-phenol"
            >
              <h2 class="text-2xl font-bold text-phenol mb-3">
                <i class="fa-solid fa-virus mr-2"></i>III. PHENOL
              </h2>
              <div class="space-y-4 text-sm">
                <div>
                  <h3 class="font-bold text-gray-800 dark:text-white">
                    1. Khái niệm
                  </h3>
                  <p class="text-gray-600 dark:text-gray-300">
                    Nhóm –OH gắn trực tiếp vào vòng benzen. CTTQ: C₆H₅–OH. Tính
                    axit mạnh hơn alcohol.
                  </p>
                </div>
                <!-- Sim 16: Acidity -->
                <div class="bg-red-50 dark:bg-red-900/20 p-3 rounded-xl">
                  <span class="text-xs font-bold text-phenol"
                    >Mô phỏng 16: So sánh tính axit</span
                  >
                  <div class="mt-2 space-y-2">
                    <div class="flex items-center gap-2">
                      <span class="text-xs w-16">Alcohol</span>
                      <div class="w-10 h-2 bg-blue-300 rounded"></div>
                      <span class="text-[10px]">Trung tính</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <span class="text-xs w-16 font-bold text-phenol"
                        >Phenol</span
                      >
                      <div class="w-20 h-2 bg-red-400 rounded"></div>
                      <span class="text-[10px]"
                        >Axit rất yếu (không đổi màu quỳ)</span
                      >
                    </div>
                    <div class="flex items-center gap-2">
                      <span class="text-xs w-16">H₂CO₃</span>
                      <div class="w-32 h-2 bg-red-600 rounded"></div>
                      <span class="text-[10px]">Mạnh hơn Phenol</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-6">
              <h3 class="font-bold text-gray-800 dark:text-white mb-2">
                3. Tính chất hoá học
              </h3>

              <!-- Sim 17: Reaction NaOH -->
              <div
                class="mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200"
              >
                <h4 class="font-bold text-sm text-blue-600 mb-1">
                  a. Tính axit (Tác dụng NaOH) - Mô phỏng 17
                </h4>
                <p class="text-xs mb-2">
                  C₆H₅OH (vẩn đục) + NaOH → C₆H₅ONa (trong suốt) + H₂O
                </p>
                <div class="flex items-center gap-4">
                  <div class="test-tube bg-white/20">
                    <div
                      id="phenol-naoh-liq"
                      class="liquid h-1/2 bg-white/80 w-full bottom-0 absolute transition-all duration-1000"
                    ></div>
                  </div>
                  <button
                    onclick="runPhenolNaOH()"
                    class="text-xs bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700"
                  >
                    Thêm NaOH
                  </button>
                </div>
              </div>

              <!-- Sim 18: Reaction Br2 -->
              <div
                class="bg-gray-50 dark:bg-gray-800 p-3 rounded-xl border border-gray-200"
              >
                <h4 class="font-bold text-sm text-orange-600 mb-1">
                  b. Phản ứng thế (Tác dụng Br₂) - Mô phỏng 18
                </h4>
                <p class="text-xs mb-2">
                  Tạo kết tủa trắng (2,4,6-tribromophenol)
                </p>
                <div class="flex items-center gap-4">
                  <div class="test-tube bg-white/20 relative">
                    <div
                      class="liquid h-1/3 bg-transparent w-full bottom-0 absolute"
                    ></div>
                    <div
                      id="br2-ppt"
                      class="precipitate bg-white w-full bottom-0 absolute"
                    ></div>
                  </div>
                  <button
                    onclick="runPhenolBr2()"
                    class="text-xs bg-orange-600 text-white px-3 py-1 rounded hover:bg-orange-700"
                  >
                    Nhỏ nước Br₂
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Visuals -->
          <div class="lg:col-span-5 space-y-6">
            <!-- Sim 19: 3D Phenol -->
            <div class="bg-gray-800 rounded-2xl shadow-xl p-1 relative">
              <span
                class="absolute top-2 left-2 px-2 py-1 bg-black/60 text-white text-[10px] font-bold rounded z-10"
                >Mô phỏng 19: Phenol 3D</span
              >
              <div id="canvas-phenol" class="canvas-3d"></div>
            </div>

            <!-- Sim 20: Picric Acid -->
            <div class="bg-white dark:bg-darkCard rounded-2xl shadow-lg p-4">
              <h4 class="font-bold text-sm text-gray-800 dark:text-white mb-2">
                Mô phỏng 20: Phản ứng HNO₃ (Thuốc nổ)
              </h4>
              <div
                class="flex items-center justify-center h-24 bg-gray-100 dark:bg-gray-700 rounded relative overflow-hidden"
              >
                <div
                  id="picric-flask"
                  class="w-12 h-16 bg-white border border-gray-400 rounded-b-lg relative"
                >
                  <div
                    class="absolute bottom-0 w-full h-1/2 bg-yellow-100 transition-colors duration-1000"
                    id="picric-liq"
                  ></div>
                </div>
                <div class="absolute top-2 right-2 text-[10px] text-gray-500">
                  Axit Picric (Vàng)
                </div>
              </div>
              <button
                onclick="runNitration()"
                class="w-full mt-2 py-1 bg-yellow-500 text-white text-xs rounded font-bold"
              >
                Thêm HNO₃ đặc / H₂SO₄
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      // --- 1. Navigation & Theme ---
      function switchTab(tabId) {
        // Hide all tabs
        document
          .querySelectorAll(".tab-content")
          .forEach((el) => el.classList.add("hidden"));
        // Show selected
        document.getElementById(`tab-${tabId}`).classList.remove("hidden");

        // Update buttons
        document.querySelectorAll(".tab-btn").forEach((btn) => {
          btn.classList.remove(
            "bg-white",
            "dark:bg-gray-700",
            "shadow",
            "text-halogen",
            "text-alcohol",
            "text-phenol"
          );
          btn.classList.add("text-gray-500");
        });
        // Highlight active button (Logic simplified for this demo)
        event.target.classList.add("bg-white", "dark:bg-gray-700", "shadow");
        if (tabId === "halogen") event.target.classList.add("text-halogen");
        if (tabId === "alcohol") event.target.classList.add("text-alcohol");
        if (tabId === "phenol") event.target.classList.add("text-phenol");
        event.target.classList.remove("text-gray-500");

        // Resize 3D canvases
        window.dispatchEvent(new Event("resize"));
      }

      const themeBtn = document.getElementById("theme-toggle");
      themeBtn.addEventListener("click", () => {
        document.documentElement.classList.toggle("dark");
        updateChartTheme();
      });

      // --- 2. Simulations Logic ---

      // Sim 1: Naming
      function checkName(btn, isCorrect) {
        if (isCorrect) {
          btn.classList.add("bg-green-500", "text-white");
          btn.innerText = "Chính xác!";
        } else {
          btn.classList.add("bg-red-500", "text-white");
          btn.innerText = "Sai rồi (Ưu tiên số nhỏ)";
        }
        setTimeout(() => {
          btn.className =
            "text-xs p-2 bg-white dark:bg-gray-700 rounded shadow hover:bg-gray-100 dark:hover:bg-gray-600";
          btn.innerText = isCorrect ? "2-bromopropane" : "1-bromopropane";
        }, 2000);
      }

      // Sim 2: Chart
      let bpChart;
      function initChart() {
        const ctx = document.getElementById("bpChart").getContext("2d");
        bpChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: ["CH3Cl", "CH3Br", "CH3I"],
            datasets: [
              {
                label: "Nhiệt độ sôi (°C)",
                data: [-24, 3.6, 42.4],
                backgroundColor: ["#a78bfa", "#8b5cf6", "#7c3aed"],
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: false } },
          },
        });
      }
      function updateChartTheme() {
        // Re-render chart logic if needed for colors
      }

      // Sim 3: Hydrolysis
      function runHydrolysis() {
        const liq = document.getElementById("hydrolysis-liquid");
        const res = document.getElementById("hydrolysis-res");
        liq.classList.remove("border-t", "border-gray-400"); // Remove separation line
        liq.style.height = "70%";
        liq.style.backgroundColor = "rgba(200, 255, 200, 0.3)";
        res.style.opacity = "1";
      }

      // Sim 4: Zaitsev
      function checkZaitsev(btn, isMajor) {
        if (isMajor) {
          btn.classList.add("bg-green-100", "border-green-500");
          alert("Đúng! Tách cùng C bậc cao hơn (ít H hơn)");
        } else {
          btn.classList.add("bg-red-100", "border-red-500");
          alert("Sai! Đây là sản phẩm phụ.");
        }
      }

      // Sim 6: CFC
      function runCFC() {
        const p = document.getElementById("cfc-particle");
        const ozone = document.querySelector(".ozone-layer");
        p.style.bottom = "80%";
        setTimeout(() => {
          ozone.style.width = "40%"; // Hole appears
          p.style.display = "none";
        }, 1000);
      }

      // Sim 7: PVC
      function makePVC() {
        const chain = document.getElementById("pvc-chain");
        chain.innerHTML = "";
        for (let i = 0; i < 6; i++) {
          chain.innerHTML += `<div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white text-[8px] font-bold border-2 border-white -ml-2">Cl</div>`;
        }
      }

      // Sim 8: Class
      function showAlcClass(deg) {
        const d = document.getElementById("alc-class-display");
        if (deg === 1) d.innerText = "R-CH2-OH (Oxi hóa -> Andehit)";
        if (deg === 2) d.innerText = "R-CH(OH)-R (Oxi hóa -> Xeton)";
        if (deg === 3) d.innerText = "R-C(OH)-R2 (Khó oxi hóa)";
      }

      // Sim 9: Solubility
      function shakeSolubility() {
        const l = document.getElementById("alc-layer");
        l.style.top = "50%"; // Shake down
        setTimeout(() => {
          l.style.opacity = "0"; // Disappear (Mix)
          l.style.top = "0";
        }, 500);
        setTimeout(() => {
          l.style.opacity = "0.5";
        }, 3000); // Reset
      }

      // Sim 11: Na Reaction
      function runNaReaction() {
        const c = document.getElementById("na-bubbles");
        c.classList.remove("hidden");
        c.innerHTML = "";
        for (let i = 0; i < 5; i++) {
          c.innerHTML += `<div class="gas-bubble w-2 h-2" style="left:${
            Math.random() * 80
          }%; animation-delay:${Math.random()}s"></div>`;
        }
        setTimeout(() => c.classList.add("hidden"), 3000);
      }

      // Sim 12: CuO
      function runCuOReaction() {
        const w = document.getElementById("cuo-wire");
        w.classList.remove("bg-black");
        w.classList.add("bg-red-600");
        document.getElementById("cuo-res").style.opacity = "1";
      }

      // Sim 13: Dehydration
      function updateDehydration(val) {
        const t = document.getElementById("temp-val");
        const r = document.getElementById("dehydration-res");
        t.innerText = val + "°C";
        if (val < 130) r.innerText = "Chưa phản ứng";
        else if (val < 160) r.innerText = "Tạo Ete (140°C)";
        else r.innerText = "Tạo Anken (170°C)";
      }

      // Sim 15: Breathalyzer
      function blowBreath() {
        const s = document.getElementById("breath-sensor");
        s.classList.remove("bg-orange-500");
        s.classList.add("bg-green-600"); // Turn Green (Cr3+)
      }

      // Sim 17: Phenol + NaOH
      function runPhenolNaOH() {
        const l = document.getElementById("phenol-naoh-liq");
        l.classList.remove("bg-white/80");
        l.classList.add("bg-transparent"); // Clear
      }

      // Sim 18: Phenol + Br2
      function runPhenolBr2() {
        const p = document.getElementById("br2-ppt");
        p.style.height = "20px"; // White ppt forms
      }

      // Sim 20: Picric
      function runNitration() {
        const l = document.getElementById("picric-liq");
        l.classList.remove("bg-yellow-100");
        l.classList.add("bg-yellow-500"); // Deep yellow
      }

      // --- 3. Three.js Setup (Simplified for Multi-canvas) ---
      function init3D(id, type) {
        const container = document.getElementById(id);
        if (!container) return;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x1f2937);

        const camera = new THREE.PerspectiveCamera(
          50,
          container.clientWidth / container.clientHeight,
          0.1,
          100
        );
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({
          antialias: true,
          alpha: true,
        });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.autoRotate = true;

        const light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(10, 10, 10);
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));

        // Helper to create atoms
        function createAtom(color, size, x, y, z) {
          const geo = new THREE.SphereGeometry(size, 32, 32);
          const mat = new THREE.MeshPhongMaterial({ color: color });
          const mesh = new THREE.Mesh(geo, mat);
          mesh.position.set(x, y, z);
          scene.add(mesh);
        }
        // Helper Bond
        function createBond(x1, y1, z1, x2, y2, z2) {
          const start = new THREE.Vector3(x1, y1, z1);
          const end = new THREE.Vector3(x2, y2, z2);
          const dist = start.distanceTo(end);
          const geo = new THREE.CylinderGeometry(0.1, 0.1, dist, 8);
          const mat = new THREE.MeshPhongMaterial({ color: 0x999999 });
          const mesh = new THREE.Mesh(geo, mat);
          const mid = new THREE.Vector3()
            .addVectors(start, end)
            .multiplyScalar(0.5);
          mesh.position.copy(mid);
          mesh.lookAt(end);
          mesh.rotateX(Math.PI / 2);
          scene.add(mesh);
        }

        // Models
        if (type === "halogen") {
          // Chloroethane
          createAtom(0x333333, 0.5, -0.8, 0, 0); // C
          createAtom(0x333333, 0.5, 0.8, 0, 0); // C
          createAtom(0x00ff00, 0.6, 1.8, 0.5, 0); // Cl
          createBond(-0.8, 0, 0, 0.8, 0, 0);
          createBond(0.8, 0, 0, 1.8, 0.5, 0);
        } else if (type === "alcohol") {
          // Ethanol
          createAtom(0x333333, 0.5, -0.8, 0, 0);
          createAtom(0x333333, 0.5, 0.8, 0, 0);
          createAtom(0xff0000, 0.5, 1.8, 0.5, 0); // O
          createAtom(0xffffff, 0.3, 2.3, 0, 0); // H
          createBond(-0.8, 0, 0, 0.8, 0, 0);
          createBond(0.8, 0, 0, 1.8, 0.5, 0);
          createBond(1.8, 0.5, 0, 2.3, 0, 0);
        } else if (type === "phenol") {
          // Phenol Ring
          for (let i = 0; i < 6; i++) {
            const angle = (i / 6) * Math.PI * 2;
            createAtom(
              0x333333,
              0.4,
              Math.cos(angle) * 1.5,
              Math.sin(angle) * 1.5,
              0
            );
            // Bonds logic simplified for demo
          }
          createAtom(0xff0000, 0.5, 1.5, 1.8, 0); // O
          createBond(0.7, 1.3, 0, 1.5, 1.8, 0);
        }

        function animate() {
          requestAnimationFrame(animate);
          controls.update();
          renderer.render(scene, camera);
        }
        animate();

        // Resize handle
        window.addEventListener("resize", () => {
          camera.aspect = container.clientWidth / container.clientHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(container.clientWidth, container.clientHeight);
        });
      }

      // Init Everything
      window.onload = function () {
        initChart();
        init3D("canvas-halogen", "halogen");
        init3D("canvas-alcohol", "alcohol");
        init3D("canvas-phenol", "phenol");
      };
    </script>
  </body>
</html>
