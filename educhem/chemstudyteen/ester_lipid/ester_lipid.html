<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H√≥a H·ªçc 12 - Ch∆∞∆°ng 1: Ester & Lipid</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Nunito', 'sans-serif'],
                    },
                    colors: {
                        esterOrange: '#F59E0B',
                        lipidYellow: '#FCD34D',
                        soapBlue: '#3B82F6',
                        cleanCyan: '#06B6D4',
                    },
                    animation: {
                        'float': 'float 3s ease-in-out infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #fffbeb 0%, #ecfeff 100%);
            min-height: 100vh;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .tab-btn.active {
            background-color: white;
            color: #F59E0B; /* Orange for this chapter */
            border-left: 4px solid #F59E0B;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Soap Molecule CSS */
        .soap-molecule {
            position: absolute;
            display: flex;
            align-items: center;
            transition: all 1s ease-in-out;
            opacity: 0;
        }
        .soap-head {
            width: 12px;
            height: 12px;
            background-color: #3B82F6; /* Hydrophilic Head */
            border-radius: 50%;
            z-index: 10;
        }
        .soap-tail {
            width: 25px;
            height: 3px;
            background-color: #94a3b8; /* Hydrophobic Tail */
        }
        
        .micelle-container {
            perspective: 1000px;
        }

        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-700 overflow-hidden h-screen flex flex-col md:flex-row">

    <!-- Mobile Header -->
    <div class="md:hidden bg-white p-4 shadow-md flex justify-between items-center z-50 relative">
        <h1 class="text-xl font-bold text-esterOrange">H√≥a H·ªçc 12 - Ch∆∞∆°ng 1</h1>
        <button onclick="toggleMenu()" class="text-slate-600 focus:outline-none">
            <i class="fas fa-bars text-2xl"></i>
        </button>
    </div>

    <!-- Sidebar -->
    <nav id="sidebar" class="transform -translate-x-full md:translate-x-0 transition-transform duration-300 fixed md:relative z-40 w-64 h-full bg-orange-50 border-r border-orange-100 flex flex-col shadow-lg md:shadow-none">
        <div class="p-6 border-b border-orange-200 hidden md:block">
            <h1 class="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-yellow-400">
                CHEMISTRY 12
            </h1>
            <p class="text-xs text-orange-400 mt-1">Ester - Lipid - X√† ph√≤ng</p>
        </div>

        <div class="flex-1 overflow-y-auto py-4">
            <ul class="space-y-1">
                <li>
                    <button onclick="showSection('intro')" class="tab-btn active w-full text-left px-6 py-3 font-semibold text-slate-600 hover:bg-white hover:text-esterOrange transition-colors flex items-center gap-3">
                        <i class="fas fa-atom w-6"></i> T·ªïng Quan
                    </button>
                </li>
                <li>
                    <button onclick="showSection('ester')" class="tab-btn w-full text-left px-6 py-3 font-semibold text-slate-600 hover:bg-white hover:text-esterOrange transition-colors flex items-center gap-3">
                        <i class="fas fa-flask w-6"></i> I. Ester
                    </button>
                </li>
                <li>
                    <button onclick="showSection('lipid')" class="tab-btn w-full text-left px-6 py-3 font-semibold text-slate-600 hover:bg-white hover:text-lipidYellow transition-colors flex items-center gap-3">
                        <i class="fas fa-bacon w-6"></i> II. Lipid (Ch·∫•t b√©o)
                    </button>
                </li>
                <li>
                    <button onclick="showSection('soap')" class="tab-btn w-full text-left px-6 py-3 font-semibold text-slate-600 hover:bg-white hover:text-soapBlue transition-colors flex items-center gap-3">
                        <i class="fas fa-soap w-6"></i> III. X√† ph√≤ng & CGR
                    </button>
                </li>
                <li>
                    <button onclick="showSection('quiz')" class="tab-btn w-full text-left px-6 py-3 font-semibold text-slate-600 hover:bg-white hover:text-emerald-500 transition-colors flex items-center gap-3">
                        <i class="fas fa-clipboard-question w-6"></i> Luy·ªán T·∫≠p
                    </button>
                </li>
            </ul>
        </div>
        
        <div class="p-4 border-t border-orange-200 text-center text-xs text-slate-400">
            Interactive Learning ¬© 2025
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 h-full overflow-y-auto bg-slate-50 p-4 md:p-8 relative" onclick="closeMenu()">
        
        <!-- INTRO SECTION -->
        <section id="intro" class="section-content max-w-5xl mx-auto fade-in block">
            <div class="bg-gradient-to-r from-orange-400 to-yellow-300 rounded-3xl p-8 shadow-xl mb-6 text-white relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full mix-blend-overlay filter blur-3xl animate-float"></div>
                <h2 class="text-4xl font-bold mb-4 relative z-10">H∆∞∆°ng th∆°m & S·∫°ch s·∫Ω ‚ú®</h2>
                <p class="text-lg relative z-10 opacity-90">Kh√°m ph√° th·∫ø gi·ªõi c·ªßa Ester (m√πi th∆°m tr√°i c√¢y), Ch·∫•t b√©o (dinh d∆∞·ª°ng) v√† c√°ch X√† ph√≤ng ƒë√°nh bay v·∫øt b·∫©n.</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Ester Card -->
                <div class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition cursor-pointer group" onclick="showSection('ester')">
                    <div class="w-14 h-14 bg-orange-100 rounded-full flex items-center justify-center text-orange-500 text-2xl mb-4 group-hover:scale-110 transition">
                        <i class="fas fa-apple-alt"></i>
                    </div>
                    <h3 class="font-bold text-xl mb-2 text-slate-800">Ester</h3>
                    <p class="text-sm text-slate-500">R-COO-R'. M√πi th∆°m tr√°i c√¢y, nguy√™n li·ªáu m·ªπ ph·∫©m.</p>
                </div>
                <!-- Lipid Card -->
                <div class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition cursor-pointer group" onclick="showSection('lipid')">
                    <div class="w-14 h-14 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 text-2xl mb-4 group-hover:scale-110 transition">
                        <i class="fas fa-oil-can"></i>
                    </div>
                    <h3 class="font-bold text-xl mb-2 text-slate-800">Lipid (Ch·∫•t b√©o)</h3>
                    <p class="text-sm text-slate-500">Triester c·ªßa Glycerol. Ngu·ªìn nƒÉng l∆∞·ª£ng d·ª± tr·ªØ.</p>
                </div>
                <!-- Soap Card -->
                <div class="bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition cursor-pointer group" onclick="showSection('soap')">
                    <div class="w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center text-blue-500 text-2xl mb-4 group-hover:scale-110 transition">
                        <i class="fas fa-pump-soap"></i>
                    </div>
                    <h3 class="font-bold text-xl mb-2 text-slate-800">X√† ph√≤ng</h3>
                    <p class="text-sm text-slate-500">C∆° ch·∫ø gi·∫∑t r·ª≠a Micelle. ƒê·∫ßu ∆∞a n∆∞·ªõc, ƒëu√¥i k·ªã n∆∞·ªõc.</p>
                </div>
            </div>
        </section>

        <!-- ESTER SECTION -->
        <section id="ester" class="section-content max-w-5xl mx-auto hidden fade-in">
            <h2 class="text-3xl font-bold text-esterOrange mb-6 flex items-center gap-3">
                <i class="fas fa-flask"></i> I. Ester
            </h2>

            <!-- Concepts Grid -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-2xl shadow-sm border-l-4 border-orange-400">
                    <h3 class="font-bold text-lg mb-3">1. Kh√°i ni·ªám & Danh ph√°p</h3>
                    <ul class="text-sm text-slate-600 space-y-2">
                        <li><span class="font-bold text-orange-600">CTCT:</span> R‚ÄìCOO‚ÄìR‚Äô (R: H ho·∫∑c g·ªëc HC; R': g·ªëc HC).</li>
                        <li><span class="font-bold text-orange-600">T√™n g·ªçi:</span> T√™n g·ªëc R' + T√™n g·ªëc acid (ƒëu√¥i -at).</li>
                        <li class="bg-orange-50 p-2 rounded border border-orange-100 mt-2">
                            <i class="fas fa-long-arrow-alt-right text-orange-400"></i> V√≠ d·ª•: <span class="font-mono font-bold">CH‚ÇÉCOOC‚ÇÇH‚ÇÖ</span> = Ethyl acetat.
                        </li>
                    </ul>
                </div>

                <!-- Fragrance Gallery -->
                <div class="bg-white p-6 rounded-2xl shadow-sm">
                    <h3 class="font-bold text-lg mb-3">2. M√πi th∆°m ƒë·∫∑c tr∆∞ng</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="flex items-center gap-3 p-2 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition">
                            <i class="fas fa-carrot text-yellow-500 text-xl"></i>
                            <div class="text-xs">
                                <strong>Isoamyl acetat</strong><br>M√πi chu·ªëi ch√≠n
                            </div>
                        </div>
                        <div class="flex items-center gap-3 p-2 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition">
                            <i class="fas fa-spa text-green-500 text-xl"></i>
                            <div class="text-xs">
                                <strong>Benzyl acetat</strong><br>M√πi hoa nh√†i
                            </div>
                        </div>
                        <div class="flex items-center gap-3 p-2 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition">
                            <i class="fas fa-apple-alt text-red-400 text-xl"></i>
                            <div class="text-xs">
                                <strong>Ethyl isovalerat</strong><br>M√πi t√°o
                            </div>
                        </div>
                        <div class="flex items-center gap-3 p-2 bg-yellow-50 rounded-lg hover:bg-yellow-100 transition">
                            <i class="fas fa-lemon text-yellow-400 text-xl"></i>
                            <div class="text-xs">
                                <strong>Ethyl butyrat</strong><br>M√πi d·ª©a
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIMULATION: Hydrolysis -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <div class="flex justify-between items-center mb-6 border-b pb-4">
                    <h3 class="text-xl font-bold text-slate-800">üß™ Ph√≤ng th√≠ nghi·ªám: Th·ªßy ph√¢n Ester</h3>
                    <div class="flex gap-2">
                        <button onclick="setHydrolysis('acid')" id="btn-acid" class="px-4 py-2 rounded-lg bg-red-100 text-red-600 font-bold text-sm hover:bg-red-200 transition">M√¥i tr∆∞·ªùng Axit (H+)</button>
                        <button onclick="setHydrolysis('base')" id="btn-base" class="px-4 py-2 rounded-lg bg-blue-50 text-blue-600 font-bold text-sm hover:bg-blue-100 transition">M√¥i tr∆∞·ªùng Ki·ªÅm (NaOH)</button>
                    </div>
                </div>

                <div class="bg-slate-50 rounded-xl p-8 text-center relative min-h-[200px] flex flex-col justify-center items-center">
                    <!-- Equation Display -->
                    <div id="equation-container" class="text-xl md:text-2xl font-mono mb-6 transition-all duration-500">
                        Ch·ªçn m√¥i tr∆∞·ªùng ƒë·ªÉ b·∫Øt ƒë·∫ßu ph·∫£n ·ª©ng
                    </div>
                    
                    <!-- Animation Area -->
                    <div id="hydrolysis-visual" class="flex items-center justify-center gap-4 opacity-50">
                        <div class="w-16 h-20 bg-orange-200 border-b-4 border-orange-400 rounded-b-xl flex items-end justify-center pb-2 text-xs font-bold text-orange-800">Ester</div>
                        <i class="fas fa-plus text-slate-400"></i>
                        <div class="w-16 h-20 bg-blue-100 border-b-4 border-blue-400 rounded-b-xl flex items-end justify-center pb-2 text-xs font-bold text-blue-800">H‚ÇÇO</div>
                    </div>

                    <div id="reaction-note" class="mt-6 text-sm font-semibold text-slate-500 italic"></div>
                </div>
            </div>
        </section>

        <!-- LIPID SECTION -->
        <section id="lipid" class="section-content max-w-5xl mx-auto hidden fade-in">
            <h2 class="text-3xl font-bold text-lipidYellow mb-6 flex items-center gap-3">
                <i class="fas fa-bacon"></i> II. Lipid (Ch·∫•t B√©o)
            </h2>

            <!-- Structure Info -->
            <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-2xl border border-yellow-200 mb-8">
                <h3 class="font-bold text-lg mb-2 text-yellow-800">C·∫•u tr√∫c Triglyceride</h3>
                <p class="mb-4 text-sm text-slate-700">L√† triester c·ªßa Glycerol v√† c√°c Acid b√©o.</p>
                <div class="flex justify-center font-mono text-sm md:text-base bg-white p-4 rounded-xl shadow-sm overflow-x-auto">
                    <div class="text-center">
                        <div class="mb-1">CH‚ÇÇ-OOC-R‚ÇÅ</div>
                        <div class="mb-1">|</div>
                        <div class="mb-1">CH -OOC-R‚ÇÇ</div>
                        <div class="mb-1">|</div>
                        <div>CH‚ÇÇ-OOC-R‚ÇÉ</div>
                    </div>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                    <div class="bg-white p-3 rounded-lg text-center">
                        <strong class="block text-blue-600">D·∫¶U (L·ªèng)</strong>
                        <span class="text-xs text-slate-500">Ch·ª©a g·ªëc acid KH√îNG NO</span>
                    </div>
                    <div class="bg-white p-3 rounded-lg text-center">
                        <strong class="block text-orange-600">M·ª† (R·∫Øn)</strong>
                        <span class="text-xs text-slate-500">Ch·ª©a g·ªëc acid NO</span>
                    </div>
                </div>
            </div>

            <!-- SIMULATION: Hydrogenation -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
                <h3 class="font-bold text-xl mb-4">üè≠ M√¥ ph·ªèng: Ph·∫£n ·ª©ng Hydro h√≥a (Bi·∫øn d·∫ßu th√†nh m·ª°)</h3>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="text-sm text-slate-600 mb-4">Qu√° tr√¨nh c·ªông H‚ÇÇ v√†o c√°c li√™n k·∫øt ƒë√¥i C=C trong g·ªëc acid b√©o kh√¥ng no (l·ªèng) ƒë·ªÉ t·∫°o th√†nh g·ªëc no (r·∫Øn).</p>
                        <div class="bg-slate-100 p-3 rounded font-mono text-sm mb-4">
                            (C‚ÇÅ‚ÇáH‚ÇÉ‚ÇÉCOO)‚ÇÉC‚ÇÉH‚ÇÖ + 3H‚ÇÇ <i class="fas fa-arrow-right text-xs"></i> (C‚ÇÅ‚ÇáH‚ÇÉ‚ÇÖCOO)‚ÇÉC‚ÇÉH‚ÇÖ
                            <div class="text-xs text-slate-400 mt-1">(Triolein - L·ªèng) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ni, t¬∞ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Tristearin - R·∫Øn)</div>
                        </div>
                        <button onclick="runHydrogenation()" id="btn-h2" class="w-full bg-slate-700 hover:bg-slate-800 text-white font-bold py-3 px-4 rounded-xl transition shadow flex items-center justify-center gap-2">
                            <i class="fas fa-gas-pump"></i> B∆°m kh√≠ Hydro (Ni, t¬∞)
                        </button>
                    </div>

                    <!-- Visual Container -->
                    <div class="h-64 bg-slate-100 rounded-xl border border-slate-200 relative flex items-center justify-center overflow-hidden">
                        <!-- Liquid State (Oil Drops) -->
                        <div id="oil-container" class="absolute inset-0 flex items-center justify-center transition-all duration-1000">
                            <div class="w-16 h-20 bg-yellow-400 rounded-b-3xl rounded-tr-3xl opacity-80 animate-float blur-sm"></div>
                            <div class="w-12 h-16 bg-yellow-300 rounded-b-full rounded-tl-full opacity-90 animate-float ml-[-10px] mt-10" style="animation-delay: 1s;"></div>
                            <div class="absolute bottom-4 font-bold text-yellow-600 bg-white/80 px-3 py-1 rounded-full">D·∫ßu l·ªèng (Kh√¥ng no)</div>
                        </div>

                        <!-- Solid State (Fat Block) -->
                        <div id="fat-container" class="absolute inset-0 flex items-center justify-center transition-all duration-1000 opacity-0 translate-y-10">
                            <div class="w-32 h-24 bg-yellow-100 border-4 border-yellow-200 rounded-lg shadow-xl flex items-center justify-center">
                                <span class="text-yellow-800 font-bold opacity-50 text-2xl">B∆†</span>
                            </div>
                            <div class="absolute bottom-4 font-bold text-orange-600 bg-white/80 px-3 py-1 rounded-full">B∆° th·ª±c v·∫≠t (No)</div>
                        </div>
                        
                        <!-- Gas Particles -->
                        <div id="gas-particles" class="absolute inset-0 pointer-events-none"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SOAP SECTION -->
        <section id="soap" class="section-content max-w-5xl mx-auto hidden fade-in">
            <h2 class="text-3xl font-bold text-soapBlue mb-6 flex items-center gap-3">
                <i class="fas fa-soap"></i> III. X√† ph√≤ng & Ch·∫•t gi·∫∑t r·ª≠a
            </h2>

            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- Theory -->
                <div class="bg-white p-6 rounded-2xl shadow-sm">
                    <h3 class="font-bold text-lg mb-3 text-slate-800">C·∫•u t·∫°o ph√¢n t·ª≠</h3>
                    <div class="flex items-center gap-4 mb-4">
                        <div class="flex-1 h-2 bg-slate-300 rounded relative">
                            <div class="absolute right-0 top-1/2 transform -translate-y-1/2 w-4 h-4 bg-blue-500 rounded-full"></div>
                        </div>
                        <div class="text-xs">
                            <div class="flex items-center gap-2 mb-1"><div class="w-3 h-3 bg-blue-500 rounded-full"></div> <strong>ƒê·∫ßu ∆∞a n∆∞·ªõc:</strong> -COONa, -SO‚ÇÉNa</div>
                            <div class="flex items-center gap-2"><div class="w-8 h-1 bg-slate-300"></div> <strong>ƒêu√¥i k·ªã n∆∞·ªõc:</strong> G·ªëc Hydrocarbon d√†i</div>
                        </div>
                    </div>
                    <ul class="text-sm space-y-2 text-slate-600">
                        <li><strong>X√† ph√≤ng:</strong> Mu·ªëi Na/K c·ªßa acid b√©o (R-COONa). <span class="text-red-500 text-xs">(Kh√¥ng d√πng trong n∆∞·ªõc c·ª©ng)</span></li>
                        <li><strong>Ch·∫•t gi·∫∑t r·ª≠a t·ªïng h·ª£p:</strong> G·ªëc sunfat/sunfonat. <span class="text-green-500 text-xs">(D√πng ƒë∆∞·ª£c trong n∆∞·ªõc c·ª©ng)</span></li>
                    </ul>
                </div>
            </div>

            <!-- SIMULATION: Micelle -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 border-t-4 border-cleanCyan">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-xl text-cleanCyan">üßº C∆° ch·∫ø gi·∫∑t r·ª≠a (Micelle)</h3>
                    <button onclick="runCleaning()" class="bg-cleanCyan text-white px-6 py-2 rounded-full font-bold shadow hover:bg-cyan-600 transition animate-pulse">
                        B·∫Øt ƒë·∫ßu gi·∫∑t
                    </button>
                </div>
                
                <div class="relative w-full h-80 bg-slate-100 rounded-xl overflow-hidden border border-slate-200" id="washing-container">
                    <!-- Water Background -->
                    <div class="absolute inset-0 bg-blue-50 opacity-50"></div>
                    
                    <!-- Fabric Surface -->
                    <div class="absolute bottom-0 w-full h-12 bg-indigo-100 border-t border-indigo-200 flex items-center justify-center text-xs text-indigo-400 font-mono">B·ªÄ M·∫∂T V·∫¢I</div>

                    <!-- Dirt/Grease -->
                    <div id="dirt" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 w-16 h-10 bg-amber-800 rounded-full opacity-90 transition-all duration-1000 z-10 flex items-center justify-center text-[10px] text-white font-bold">V·∫øt b·∫©n</div>

                    <!-- Soap Molecules Container -->
                    <div id="soap-group" class="absolute w-full h-full pointer-events-none">
                        <!-- Molecules will be injected here by JS -->
                    </div>

                    <!-- Result Text -->
                    <div id="clean-result" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-2xl font-bold text-cleanCyan opacity-0 transition-opacity z-20 bg-white/80 p-4 rounded-xl backdrop-blur-sm">
                        S·∫°ch bong! ‚ú®
                    </div>
                </div>
                
                <div class="mt-4 text-sm text-slate-600 bg-cyan-50 p-4 rounded-lg">
                    <strong>Gi·∫£i th√≠ch:</strong> C√°c ph√¢n t·ª≠ x√† ph√≤ng ƒë·ªãnh h∆∞·ªõng: 
                    <span class="bg-slate-200 px-1 rounded text-slate-700">ƒêu√¥i k·ªã n∆∞·ªõc</span> c·∫Øm v√†o v·∫øt d·∫ßu, 
                    <span class="bg-blue-200 px-1 rounded text-blue-700">ƒê·∫ßu ∆∞a n∆∞·ªõc</span> quay ra ngo√†i ti·∫øp x√∫c v·ªõi n∆∞·ªõc. 
                    L·ª±c h√∫t k√©o v·∫øt b·∫©n ra kh·ªèi b·ªÅ m·∫∑t v·∫£i l∆° l·ª≠ng trong n∆∞·ªõc (h·ªá nh≈© t∆∞∆°ng).
                </div>
            </div>
        </section>

        <!-- QUIZ SECTION -->
        <section id="quiz" class="section-content max-w-5xl mx-auto hidden fade-in">
            <h2 class="text-3xl font-bold text-emerald-600 mb-6 flex items-center gap-3">
                <i class="fas fa-check-circle"></i> Luy·ªán T·∫≠p
            </h2>

            <div class="bg-white rounded-2xl shadow-lg p-8">
                <div id="quiz-container">
                    <!-- Questions generated by JS -->
                </div>
                
                <div id="quiz-result" class="hidden text-center py-8">
                    <div class="text-6xl mb-4">üèÜ</div>
                    <h3 class="text-2xl font-bold text-slate-800 mb-2">K·∫øt qu·∫£</h3>
                    <p class="text-lg mb-6">B·∫°n l√†m ƒë√∫ng <span id="score" class="font-bold text-emerald-600 text-2xl">0</span>/<span id="total-q">0</span> c√¢u.</p>
                    <button onclick="initQuiz()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold shadow transition">L√†m l·∫°i</button>
                </div>
            </div>
        </section>

    </main>

    <!-- Script Logic -->
    <script>
        // --- Navigation Logic ---
        function showSection(id) {
            document.querySelectorAll('.section-content').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('block');
            });
            const target = document.getElementById(id);
            target.classList.remove('hidden');
            target.classList.add('block');
            target.classList.add('fade-in');

            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            // Assign active class based on approximation
            const btns = document.querySelectorAll('.tab-btn');
            if(id === 'intro') btns[0].classList.add('active');
            if(id === 'ester') btns[1].classList.add('active');
            if(id === 'lipid') btns[2].classList.add('active');
            if(id === 'soap') btns[3].classList.add('active');
            if(id === 'quiz') btns[4].classList.add('active');

            if(window.innerWidth < 768) {
                document.getElementById('sidebar').classList.add('-translate-x-full');
            }
        }

        function toggleMenu() {
            document.getElementById('sidebar').classList.toggle('-translate-x-full');
        }

        function closeMenu() {
            if(window.innerWidth < 768) {
                const sidebar = document.getElementById('sidebar');
                if (!sidebar.classList.contains('-translate-x-full')) {
                    sidebar.classList.add('-translate-x-full');
                }
            }
        }

        // --- Ester Hydrolysis Simulation ---
        function setHydrolysis(type) {
            const eqDiv = document.getElementById('equation-container');
            const noteDiv = document.getElementById('reaction-note');
            const visual = document.getElementById('hydrolysis-visual');
            const btnAcid = document.getElementById('btn-acid');
            const btnBase = document.getElementById('btn-base');

            visual.style.opacity = '1';

            if (type === 'acid') {
                btnAcid.classList.add('bg-red-200'); btnBase.classList.remove('bg-blue-100'); // Active state styling fix needed but functional
                eqDiv.innerHTML = `R-COO-R' + H‚ÇÇO <span class="text-red-500 font-bold mx-2">‚áå</span> R-COOH + R'-OH`;
                noteDiv.innerHTML = `<i class="fas fa-info-circle"></i> Ph·∫£n ·ª©ng thu·∫≠n ngh·ªãch, c·∫ßn x√∫c t√°c Axit (H‚ÇÇSO‚ÇÑ ƒë·∫∑c), ƒëun n√≥ng.`;
                noteDiv.className = "mt-6 text-sm font-semibold text-red-500 italic";
            } else {
                eqDiv.innerHTML = `R-COO-R' + NaOH <span class="text-blue-500 font-bold mx-2">‚Üí</span> R-COONa + R'-OH`;
                noteDiv.innerHTML = `<i class="fas fa-info-circle"></i> Ph·∫£n ·ª©ng m·ªôt chi·ªÅu (X√† ph√≤ng h√≥a), x·∫£y ra ho√†n to√†n.`;
                noteDiv.className = "mt-6 text-sm font-semibold text-blue-500 italic";
            }
        }

        // --- Hydrogenation Simulation ---
        function runHydrogenation() {
            const oil = document.getElementById('oil-container');
            const fat = document.getElementById('fat-container');
            const particles = document.getElementById('gas-particles');

            // 1. Create bubbles (H2)
            particles.innerHTML = '';
            for(let i=0; i<20; i++) {
                const p = document.createElement('div');
                p.className = 'absolute bg-white rounded-full opacity-60';
                p.style.width = Math.random() * 10 + 5 + 'px';
                p.style.height = p.style.width;
                p.style.left = Math.random() * 100 + '%';
                p.style.bottom = '-10px';
                p.style.transition = `all ${Math.random() + 1}s ease-out`;
                particles.appendChild(p);

                setTimeout(() => {
                    p.style.bottom = '100%';
                    p.style.opacity = '0';
                }, 50);
            }

            // 2. Transform
            setTimeout(() => {
                oil.style.opacity = '0';
                oil.style.transform = 'scale(0.8)';
                
                fat.style.opacity = '1';
                fat.style.transform = 'translateY(0)';
            }, 1000);

            // Reset mechanism
            setTimeout(() => {
                const btn = document.getElementById('btn-h2');
                btn.innerHTML = `<i class="fas fa-undo"></i> L√†m l·∫°i`;
                btn.onclick = resetHydrogenation;
            }, 2500);
        }

        function resetHydrogenation() {
            const oil = document.getElementById('oil-container');
            const fat = document.getElementById('fat-container');
            
            oil.style.opacity = '1';
            oil.style.transform = 'scale(1)';
            fat.style.opacity = '0';
            fat.style.transform = 'translateY(10px)';
            
            const btn = document.getElementById('btn-h2');
            btn.innerHTML = `<i class="fas fa-gas-pump"></i> B∆°m kh√≠ Hydro (Ni, t¬∞)`;
            btn.onclick = runHydrogenation;
        }

        // --- Micelle Simulation ---
        function runCleaning() {
            const group = document.getElementById('soap-group');
            const dirt = document.getElementById('dirt');
            const result = document.getElementById('clean-result');
            
            group.innerHTML = '';
            result.style.opacity = '0';
            dirt.style.transform = 'translate(-50%, 0)'; // Reset dirt pos
            dirt.style.opacity = '1';

            // 1. Generate Soap Molecules randomly around
            const moleculeCount = 12;
            for(let i=0; i<moleculeCount; i++) {
                const soap = document.createElement('div');
                soap.className = 'soap-molecule';
                // Inner structure
                soap.innerHTML = `<div class="soap-head"></div><div class="soap-tail"></div>`;
                
                // Random start positions
                const startX = Math.random() * 100; 
                const startY = Math.random() * 50;
                soap.style.left = startX + '%';
                soap.style.top = startY + '%';
                
                group.appendChild(soap);
            }

            // 2. Animate to Dirt
            setTimeout(() => {
                const soaps = document.querySelectorAll('.soap-molecule');
                const dirtRect = dirt.getBoundingClientRect();
                const containerRect = document.getElementById('washing-container').getBoundingClientRect();
                
                // Center of dirt relative to container
                const targetX = containerRect.width / 2;
                const targetY = containerRect.height - 40; // Approx dirt center

                soaps.forEach((soap, index) => {
                    soap.style.opacity = '1';
                    
                    // Calculate angle for circle formation
                    const angle = (index / moleculeCount) * 2 * Math.PI;
                    const radius = 35; // Distance from dirt center
                    
                    // Position around dirt
                    const finalX = targetX + Math.cos(angle) * radius;
                    const finalY = targetY + Math.sin(angle) * radius;

                    soap.style.left = (finalX) + 'px';
                    soap.style.top = (finalY) + 'px';

                    // Rotate so tail (right side of div) points to center
                    // Current div: Head(left)-Tail(right). 
                    // We need Tail inside. 
                    const degrees = (angle * 180 / Math.PI) + 180; 
                    soap.style.transform = `translate(-50%, -50%) rotate(${degrees}deg)`;
                });
            }, 100);

            // 3. Lift Dirt
            setTimeout(() => {
                const soaps = document.querySelectorAll('.soap-molecule');
                
                dirt.style.transform = 'translate(-50%, -150px) rotate(360deg)';
                dirt.style.opacity = '0.5';

                soaps.forEach(soap => {
                    const currentTop = parseFloat(soap.style.top);
                    soap.style.top = (currentTop - 150) + 'px';
                    soap.style.opacity = '0.5';
                });
                
                setTimeout(() => {
                    result.style.opacity = '1';
                }, 800);

            }, 2000);
        }

        // --- Quiz Data ---
        const quizData = [
            {
                q: "Ph·∫£n ·ª©ng th·ªßy ph√¢n Ester trong m√¥i tr∆∞·ªùng ki·ªÅm g·ªçi l√† g√¨?",
                a: ["Ester h√≥a", "X√† ph√≤ng h√≥a", "Tr√πng ng∆∞ng", "Hydrat h√≥a"],
                correct: 1
            },
            {
                q: "Isoamyl acetat c√≥ m√πi g√¨?",
                a: ["Hoa nh√†i", "D·ª©a", "Chu·ªëi ch√≠n", "T√°o"],
                correct: 2
            },
            {
                q: "Ch·∫•t b√©o l·ªèng (D·∫ßu) ch·ª©a ch·ªß y·∫øu g·ªëc acid b√©o n√†o?",
                a: ["No", "Kh√¥ng no", "Th∆°m", "V√≤ng no"],
                correct: 1
            },
            {
                q: "ƒê·ªÉ chuy·ªÉn h√≥a d·∫ßu th√†nh m·ª° r·∫Øn (b∆° nh√¢n t·∫°o), ng∆∞·ªùi ta d√πng ph·∫£n ·ª©ng n√†o?",
                a: ["C·ªông H‚ÇÇ (Ni, t¬∞)", "X√† ph√≤ng h√≥a", "Oxi h√≥a", "C·ªông Br‚ÇÇ"],
                correct: 0
            },
            {
                q: "∆Øu ƒëi·ªÉm c·ªßa ch·∫•t gi·∫∑t r·ª≠a t·ªïng h·ª£p so v·ªõi x√† ph√≤ng?",
                a: ["L√†m t·ª´ thi√™n nhi√™n", "D√πng ƒë∆∞·ª£c trong n∆∞·ªõc c·ª©ng", "D·ªÖ ph√¢n h·ªßy sinh h·ªçc h∆°n", "C√≥ m√πi th∆°m h∆°n"],
                correct: 1
            },
            {
                q: "C√¥ng th·ª©c t·ªïng qu√°t c·ªßa Ester ƒë∆°n ch·ª©c, no, m·∫°ch h·ªü?",
                a: ["CnH2nO2 (n‚â•2)", "CnH2n+2O", "CnH2n-2O2", "CnH2nO"],
                correct: 0
            }
        ];

        function initQuiz() {
            const container = document.getElementById('quiz-container');
            const resultBox = document.getElementById('quiz-result');
            
            container.innerHTML = '';
            resultBox.classList.add('hidden');
            container.classList.remove('hidden');

            quizData.forEach((item, index) => {
                const qDiv = document.createElement('div');
                qDiv.className = 'mb-6 pb-6 border-b border-slate-100 last:border-0';
                
                let answersHtml = '';
                item.a.forEach((ans, i) => {
                    answersHtml += `
                        <label class="flex items-center gap-3 cursor-pointer p-3 rounded-lg hover:bg-slate-50 transition">
                            <input type="radio" name="q${index}" value="${i}" class="w-5 h-5 text-emerald-500 focus:ring-emerald-500">
                            <span class="text-slate-700">${ans}</span>
                        </label>
                    `;
                });

                qDiv.innerHTML = `
                    <p class="font-bold text-lg mb-3 text-slate-800">C√¢u ${index + 1}: ${item.q}</p>
                    <div class="space-y-1">
                        ${answersHtml}
                    </div>
                `;
                container.appendChild(qDiv);
            });

            const btn = document.createElement('button');
            btn.innerText = "N·ªôp B√†i";
            btn.className = "mt-4 bg-esterOrange hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition w-full md:w-auto";
            btn.onclick = checkQuiz;
            container.appendChild(btn);
        }

        function checkQuiz() {
            let score = 0;
            quizData.forEach((item, index) => {
                const selected = document.querySelector(`input[name="q${index}"]:checked`);
                if(selected && parseInt(selected.value) === item.correct) {
                    score++;
                }
            });

            const container = document.getElementById('quiz-container');
            const resultBox = document.getElementById('quiz-result');
            const scoreSpan = document.getElementById('score');
            const totalSpan = document.getElementById('total-q');

            scoreSpan.innerText = score;
            totalSpan.innerText = quizData.length;

            container.classList.add('hidden');
            resultBox.classList.remove('hidden');
            resultBox.classList.add('fade-in');
        }

        // Init
        window.onload = function() {
            initQuiz();
            showSection('intro');
        }
    </script>
</body>
</html>