<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChemStudy Teen - H·ª£p Ch·∫•t Carbonyl & Carboxylic Acid</title>
    <link rel="icon" href="../../../favicon/educhem.svg" type="image/svg+xml" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Three.js cho 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["Be Vietnam Pro", "sans-serif"],
            },
            colors: {
              chem: {
                primary: "#0ea5e9", // Sky 500
                secondary: "#8b5cf6", // Violet 500
                accent: "#f43f5e", // Rose 500
                dark: "#0f172a", // Slate 900
                light: "#f8fafc", // Slate 50
              },
            },
            animation: {
              bubble: "bubble 2s infinite",
              fizz: "fizz 0.5s infinite",
            },
            keyframes: {
              bubble: {
                "0%": { transform: "translateY(100%) scale(0)", opacity: "0" },
                "50%": { opacity: "1" },
                "100%": {
                  transform: "translateY(-20px) scale(1.5)",
                  opacity: "0",
                },
              },
              fizz: {
                "0%, 100%": { transform: "translate(0,0)" },
                "25%": { transform: "translate(1px,1px)" },
                "50%": { transform: "translate(-1px,-1px)" },
                "75%": { transform: "translate(-1px,1px)" },
              },
            },
          },
        },
      };
    </script>

    <style>
      body {
        font-family: "Be Vietnam Pro", sans-serif;
      }
      .glass {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      .dark .glass {
        background: rgba(15, 23, 42, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .molecule-canvas {
        width: 100%;
        height: 300px;
        border-radius: 1rem;
        cursor: move;
      }

      /* Custom Range Slider */
      input[type="range"] {
        -webkit-appearance: none;
        background: transparent;
      }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: #0ea5e9;
        cursor: pointer;
        margin-top: -8px;
      }
      input[type="range"]::-webkit-slider-runnable-track {
        width: 100%;
        height: 4px;
        cursor: pointer;
        background: #cbd5e1;
        border-radius: 2px;
      }

      /* Chemical liquid animations */
      .liquid-layer {
        transition: height 1s ease-in-out, background-color 0.5s;
      }
      .precipitate {
        transition: opacity 1s ease;
      }

      /* Hide Scrollbar but keep functionality */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
  </head>
  <body
    class="bg-chem-light text-slate-800 dark:bg-chem-dark dark:text-slate-100 transition-colors duration-300"
  >
    <!-- NAVIGATION -->
    <nav
      class="fixed top-0 w-full z-50 glass shadow-sm transition-all duration-300"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <!-- Left: Back & Logo -->
          <div class="flex items-center gap-4">
            <button
              onclick="window.location.href='../chemstudyteen.html'"
              class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition"
              title="Quay v·ªÅ trang ch·ªß"
            >
              <i data-lucide="arrow-left" class="w-6 h-6 text-chem-primary"></i>
            </button>
            <div class="flex items-center gap-2">
              <i
                data-lucide="flask-conical"
                class="w-8 h-8 text-chem-secondary"
              ></i>
              <span
                class="font-bold text-xl tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-chem-primary to-chem-secondary"
              >
                ChemStudy Teen
              </span>
            </div>
          </div>

          <!-- Center: Desktop Menu -->
          <div class="hidden md:flex space-x-1">
            <a
              href="#phan1"
              class="px-3 py-2 rounded-md text-sm font-medium hover:text-chem-primary transition"
              >I. Carbonyl</a
            >
            <a
              href="#phan2"
              class="px-3 py-2 rounded-md text-sm font-medium hover:text-chem-primary transition"
              >II. Carboxylic Acid</a
            >
            <a
              href="#luyentap"
              class="px-3 py-2 rounded-md text-sm font-medium hover:text-chem-primary transition"
              >Luy·ªán T·∫≠p</a
            >
          </div>

          <!-- Right: Tools & Theme -->
          <div class="flex items-center gap-3">
            <button
              id="theme-toggle"
              class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition"
            >
              <i
                data-lucide="sun"
                class="w-5 h-5 hidden dark:block text-yellow-400"
              ></i>
              <i
                data-lucide="moon"
                class="w-5 h-5 block dark:hidden text-slate-600"
              ></i>
            </button>
          </div>
        </div>
      </div>
      <!-- Progress Bar -->
      <div class="h-1 bg-slate-200 dark:bg-slate-800 w-full">
        <div
          id="scroll-progress"
          class="h-full bg-gradient-to-r from-chem-primary to-chem-secondary w-0 transition-all duration-100"
        ></div>
      </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="pt-20 pb-10 max-w-6xl mx-auto px-4 space-y-16">
      <!-- HEADER BANNER -->
      <header
        class="relative rounded-3xl overflow-hidden shadow-2xl h-80 flex items-center justify-center bg-gradient-to-br from-indigo-900 to-purple-800"
      >
        <div class="absolute inset-0 opacity-30">
          <!-- Decorative background patterns -->
          <div
            class="absolute top-10 left-10 w-20 h-20 rounded-full bg-white blur-2xl"
          ></div>
          <div
            class="absolute bottom-10 right-10 w-32 h-32 rounded-full bg-blue-400 blur-3xl"
          ></div>
        </div>
        <div class="relative z-10 text-center text-white px-4">
          <h1 class="text-3xl md:text-5xl font-extrabold mb-4">
            CH∆Ø∆†NG 6: H·ª¢P CH·∫§T CARBONYL & CARBOXYLIC ACID
          </h1>
          <p class="text-lg md:text-xl font-light opacity-90">
            Kh√°m ph√° th·∫ø gi·ªõi c·ªßa nh√≥m ch·ª©c C=O v√† -COOH qua t∆∞∆°ng t√°c tr·ª±c
            quan.
          </p>
          <div class="mt-6 flex justify-center gap-4">
            <span
              class="px-4 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm border border-white/30"
              >Aldehyde</span
            >
            <span
              class="px-4 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm border border-white/30"
              >Ketone</span
            >
            <span
              class="px-4 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm border border-white/30"
              >Acid</span
            >
          </div>
        </div>
      </header>

      <!-- PH·∫¶N I: H·ª¢P CH·∫§T CARBONYL -->
      <section id="phan1" class="space-y-8">
        <div
          class="flex items-center gap-4 border-b-2 border-chem-primary pb-2"
        >
          <div class="p-3 bg-chem-primary/10 rounded-xl text-chem-primary">
            <i data-lucide="atom" class="w-8 h-8"></i>
          </div>
          <h2 class="text-3xl font-bold text-slate-800 dark:text-white">
            I. H·ª£p Ch·∫•t Carbonyl (Aldehyde - Ketone)
          </h2>
        </div>

        <!-- 1. KH√ÅI NI·ªÜM -->
        <div class="grid md:grid-cols-2 gap-8">
          <div
            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700"
          >
            <h3 class="text-xl font-bold text-chem-secondary mb-4">
              1. Kh√°i ni·ªám & ƒê·∫∑c ƒëi·ªÉm li√™n k·∫øt
            </h3>
            <ul
              class="space-y-3 text-slate-600 dark:text-slate-300 list-disc list-inside"
            >
              <li>
                H·ª£p ch·∫•t carbonyl g·ªìm: <strong>Aldehyde (‚ÄìCHO)</strong> v√†
                <strong>Ketone (>C=O)</strong>.
              </li>
              <li>Nh√≥m ch·ª©c quan tr·ªçng: <strong>C=O</strong>.</li>
              <li>
                <span class="text-chem-accent font-semibold">ƒê·∫∑c ƒëi·ªÉm:</span>
                Li√™n k·∫øt C=O ph√¢n c·ª±c m·∫°nh v√¨ O h√∫t electron ‚Üí C mang ƒëi·ªán d∆∞∆°ng
                ‚Üí D·ªÖ b·ªã t·∫•n c√¥ng b·ªüi t√°c nh√¢n <strong>nucleophile</strong>.
              </li>
            </ul>

            <!-- SIMULATION 1: Polarity -->
            <div class="mt-6 p-4 bg-slate-100 dark:bg-slate-900 rounded-xl">
              <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-bold"
                  >M√¥ ph·ªèng 1: S·ª± ph√¢n c·ª±c li√™n k·∫øt C=O</span
                >
                <button
                  onclick="togglePolarity()"
                  class="text-xs bg-chem-primary text-white px-2 py-1 rounded"
                >
                  B·∫≠t/T·∫Øt ƒëi·ªán t√≠ch
                </button>
              </div>
              <div
                class="relative h-40 flex items-center justify-center bg-white dark:bg-slate-800 rounded border border-slate-200 dark:border-slate-700 overflow-hidden"
              >
                <div class="text-4xl font-bold flex items-center gap-1">
                  <span class="relative"
                    >C<sup
                      id="c-charge"
                      class="opacity-0 text-blue-500 text-sm absolute -top-2 -right-2"
                      >Œ¥+</sup
                    ></span
                  >
                  <div class="relative w-20 h-2 bg-slate-300 mx-1">
                    <div
                      class="absolute w-full h-full bg-gradient-to-r from-transparent to-red-400 opacity-50 animate-pulse"
                    ></div>
                    <div
                      class="absolute -top-3 left-1/2 transform -translate-x-1/2 text-xs"
                    >
                      œÉ + œÄ
                    </div>
                  </div>
                  <span class="relative"
                    >O<sup
                      id="o-charge"
                      class="opacity-0 text-red-500 text-sm absolute -top-2 -right-2"
                      >Œ¥-</sup
                    ></span
                  >
                </div>
                <div
                  id="electron-cloud"
                  class="absolute inset-0 bg-gradient-to-r from-transparent via-red-500/10 to-red-500/30 opacity-0 transition-opacity duration-500 pointer-events-none"
                ></div>
              </div>
            </div>
          </div>

          <!-- SIMULATION 2 & 3: 3D Molecules -->
          <div class="space-y-4">
            <div class="bg-slate-900 rounded-2xl p-4 shadow-lg relative group">
              <div
                class="absolute top-4 left-4 z-10 bg-black/50 text-white text-xs px-2 py-1 rounded"
              >
                M√¥ ph·ªèng 2: Formaldehyde (HCHO)
              </div>
              <div id="sim-formaldehyde" class="molecule-canvas h-64"></div>
              <div
                class="absolute bottom-2 left-0 right-0 text-center text-slate-400 text-xs"
              >
                Xoay ƒë·ªÉ xem c·∫•u tr√∫c kh√¥ng gian
              </div>
            </div>
            <div class="bg-slate-900 rounded-2xl p-4 shadow-lg relative group">
              <div
                class="absolute top-4 left-4 z-10 bg-black/50 text-white text-xs px-2 py-1 rounded"
              >
                M√¥ ph·ªèng 3: Acetone (CH<sub>3</sub>COCH<sub>3</sub>)
              </div>
              <div id="sim-acetone" class="molecule-canvas h-64"></div>
            </div>
          </div>
        </div>

        <!-- 2. DANH PH√ÅP -->
        <div
          class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700"
        >
          <h3 class="text-xl font-bold text-chem-secondary mb-4">
            2. Danh ph√°p
          </h3>

          <!-- SIMULATION 4: Interactive Table -->
          <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
              <thead>
                <tr
                  class="bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-200"
                >
                  <th class="p-3 rounded-tl-lg">Lo·∫°i</th>
                  <th class="p-3">Quy t·∫Øc</th>
                  <th class="p-3">V√≠ d·ª•</th>
                  <th class="p-3 rounded-tr-lg">T√™n g·ªçi</th>
                </tr>
              </thead>
              <tbody class="text-sm">
                <tr
                  class="border-b border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition"
                >
                  <td class="p-3 font-bold text-chem-primary">Aldehyde</td>
                  <td class="p-3">
                    T√™n m·∫°ch ch√≠nh +
                    <span class="text-red-500 font-bold">al</span>
                  </td>
                  <td class="p-3 font-mono">CH<sub>3</sub>‚ÄìCHO</td>
                  <td class="p-3">Ethanal (Acetaldehyde)</td>
                </tr>
                <tr
                  class="border-b border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition"
                >
                  <td class="p-3"></td>
                  <td class="p-3"></td>
                  <td class="p-3 font-mono">
                    CH<sub>3</sub>‚ÄìCH<sub>2</sub>‚ÄìCHO
                  </td>
                  <td class="p-3">Propanal</td>
                </tr>
                <tr
                  class="border-b border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition"
                >
                  <td class="p-3 font-bold text-chem-secondary">Ketone</td>
                  <td class="p-3">
                    T√™n m·∫°ch ch√≠nh + s·ªë v·ªã tr√≠ +
                    <span class="text-red-500 font-bold">one</span>
                  </td>
                  <td class="p-3 font-mono">
                    CH<sub>3</sub>‚ÄìCO‚ÄìCH<sub>3</sub>
                  </td>
                  <td class="p-3">Propanone (Acetone)</td>
                </tr>
                <tr
                  class="hover:bg-slate-50 dark:hover:bg-slate-700 transition"
                >
                  <td class="p-3"></td>
                  <td class="p-3"></td>
                  <td class="p-3 font-mono">
                    CH<sub>3</sub>‚ÄìCO‚ÄìC<sub>2</sub>H<sub>5</sub>
                  </td>
                  <td class="p-3">Butan-2-one</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- SIMULATION 5: Naming Game -->
          <div
            class="mt-6 p-4 bg-chem-primary/5 rounded-xl border border-chem-primary/20"
          >
            <h4 class="font-bold text-sm mb-3">
              M√¥ ph·ªèng 4: Th·ª≠ t√†i g·ªçi t√™n (Click ƒë·ªÉ ch·ªçn ƒë√°p √°n)
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="bg-white dark:bg-slate-900 p-4 rounded text-center">
                <p class="font-mono text-lg mb-2">HCHO</p>
                <div class="flex gap-2 justify-center">
                  <button
                    onclick="checkName(this, false)"
                    class="px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded hover:bg-slate-300 text-sm"
                  >
                    Ethanal
                  </button>
                  <button
                    onclick="checkName(this, true)"
                    class="px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded hover:bg-slate-300 text-sm"
                  >
                    Methanal
                  </button>
                </div>
              </div>
              <div class="bg-white dark:bg-slate-900 p-4 rounded text-center">
                <p class="font-mono text-lg mb-2">
                  CH<sub>3</sub>COCH<sub>3</sub>
                </p>
                <div class="flex gap-2 justify-center">
                  <button
                    onclick="checkName(this, true)"
                    class="px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded hover:bg-slate-300 text-sm"
                  >
                    Propanone
                  </button>
                  <button
                    onclick="checkName(this, false)"
                    class="px-3 py-1 bg-slate-200 dark:bg-slate-700 rounded hover:bg-slate-300 text-sm"
                  >
                    Propanal
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 3. T√çNH CH·∫§T V·∫¨T L√ù -->
        <div class="grid md:grid-cols-2 gap-8">
          <div class="prose dark:prose-invert">
            <h3 class="text-xl font-bold text-chem-secondary">
              3. T√≠nh ch·∫•t v·∫≠t l√Ω
            </h3>
            <ul>
              <li>
                <strong>Tr·∫°ng th√°i:</strong> Th∆∞·ªùng l√† l·ªèng ho·∫∑c r·∫Øn, d·ªÖ bay h∆°i
                (ƒë·∫∑c bi·ªát aldehyde).
              </li>
              <li>
                <strong>M√πi:</strong> ƒê·∫∑c tr∆∞ng (Formaldehyde hƒÉng, Acetaldehyde
                hƒÉng chua, Acetone th∆°m nh·∫π).
              </li>
              <li>
                <strong>ƒê·ªô tan:</strong> Tan t·ªët trong n∆∞·ªõc ·ªü m·∫°ch ng·∫Øn (do t·∫°o
                li√™n k·∫øt H v·ªõi n∆∞·ªõc).
              </li>
              <li>
                <strong>Nhi·ªát ƒë·ªô s√¥i:</strong> Th·∫•p h∆°n Alcohol t∆∞∆°ng ·ª©ng (kh√¥ng
                c√≥ li√™n k·∫øt H li√™n ph√¢n t·ª≠), cao h∆°n Hydrocarbon.
              </li>
            </ul>
          </div>
          <!-- SIMULATION 6: Boiling Point Chart -->
          <div
            class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow border border-slate-200 dark:border-slate-700"
          >
            <h4 class="text-sm font-bold mb-4">
              M√¥ ph·ªèng 5: So s√°nh nhi·ªát ƒë·ªô s√¥i (M ‚âà 44-46)
            </h4>
            <div class="space-y-4">
              <div>
                <div class="flex justify-between text-xs mb-1">
                  <span>Propane (Alkane)</span><span>-42¬∞C</span>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-4">
                  <div
                    class="bg-gray-400 h-4 rounded-full"
                    style="width: 10%"
                  ></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-xs mb-1">
                  <span>Acetaldehyde (Aldehyde)</span><span>20¬∞C</span>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-4">
                  <div
                    class="bg-chem-primary h-4 rounded-full"
                    style="width: 40%"
                  ></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-xs mb-1">
                  <span>Ethanol (Alcohol)</span><span>78¬∞C</span>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-4">
                  <div
                    class="bg-chem-accent h-4 rounded-full"
                    style="width: 80%"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 4. T√çNH CH·∫§T H√ìA H·ªåC -->
        <div class="space-y-6">
          <h3
            class="text-2xl font-bold text-slate-800 dark:text-white border-l-4 border-chem-accent pl-4"
          >
            4. T√≠nh ch·∫•t h√≥a h·ªçc
          </h3>

          <!-- a. OXI H√ìA -->
          <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg">
            <h4 class="text-lg font-bold text-chem-accent mb-2">
              a. Ph·∫£n ·ª©ng Oxi h√≥a (Ph·∫£n ·ª©ng tr√°ng g∆∞∆°ng)
            </h4>
            <p class="mb-4 text-sm text-slate-600 dark:text-slate-300">
              Aldehyde d·ªÖ b·ªã oxi h√≥a b·ªüi AgNO<sub>3</sub>/NH<sub>3</sub> t·∫°o k·∫øt
              t·ªßa B·∫°c (Ag). Ketone kh√¥ng ph·∫£n ·ª©ng.
            </p>
            <div
              class="bg-slate-900 text-green-400 p-3 rounded font-mono text-sm mb-4"
            >
              R‚ÄìCHO + 2[Ag(NH<sub>3</sub>)<sub>2</sub>]OH ‚Üí R‚ÄìCOONH<sub>4</sub>
              + 2Ag‚Üì + 3NH<sub>3</sub> + H<sub>2</sub>O
            </div>

            <!-- SIMULATION 7: Tollens Test Lab -->
            <div
              class="bg-slate-100 dark:bg-slate-900 border border-slate-300 dark:border-slate-700 rounded-xl p-4 relative overflow-hidden"
            >
              <div
                class="absolute top-2 right-2 px-2 py-1 bg-yellow-500 text-white text-xs font-bold rounded"
              >
                M√¥ ph·ªèng 6: Th√≠ nghi·ªám Tr√°ng B·∫°c
              </div>
              <div class="flex flex-col items-center mt-6">
                <!-- Test Tube -->
                <div
                  class="w-16 h-48 border-l-2 border-r-2 border-b-2 border-slate-400/50 bg-white/10 backdrop-blur rounded-b-3xl relative mb-4 overflow-hidden shadow-inner"
                >
                  <div
                    id="tollens-liquid"
                    class="absolute bottom-0 w-full h-1/3 bg-transparent transition-all duration-1000 flex items-end justify-center"
                  >
                    <div class="w-full h-full bg-blue-100/30"></div>
                  </div>
                  <div
                    id="silver-coating"
                    class="absolute inset-0 bg-gradient-to-br from-gray-200 via-gray-400 to-gray-600 opacity-0 transition-opacity duration-2000 z-10 mix-blend-overlay"
                  ></div>
                  <div
                    id="silver-mirror"
                    class="absolute inset-0 bg-gradient-to-b from-transparent to-gray-300 opacity-0 transition-opacity duration-2000 z-0"
                  ></div>
                </div>
                <!-- Controls -->
                <div class="flex flex-wrap gap-2 justify-center z-20">
                  <button
                    onclick="addTollensReagent('ag')"
                    class="px-3 py-1 bg-slate-200 text-slate-800 rounded hover:bg-slate-300 text-xs font-bold"
                  >
                    + AgNO<sub>3</sub>/NH<sub>3</sub>
                  </button>
                  <button
                    onclick="addTollensReagent('ald')"
                    class="px-3 py-1 bg-slate-200 text-slate-800 rounded hover:bg-slate-300 text-xs font-bold"
                  >
                    + Aldehyde
                  </button>
                  <button
                    onclick="addTollensReagent('heat')"
                    class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-xs font-bold shadow-lg shadow-red-500/30"
                  >
                    üî• ƒêun n√≥ng
                  </button>
                  <button
                    onclick="resetTollens()"
                    class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 text-xs font-bold"
                  >
                    R·ª≠a ·ªëng
                  </button>
                </div>
                <div
                  id="tollens-status"
                  class="mt-2 text-sm font-semibold text-slate-500 min-h-[20px]"
                >
                  Tr·∫°ng th√°i: ·ªêng nghi·ªám s·∫°ch
                </div>
              </div>
            </div>
          </div>

          <!-- b. PH·∫¢N ·ª®NG KH·ª¨ -->
          <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg">
              <h4 class="text-lg font-bold text-blue-600 mb-2">
                b. Ph·∫£n ·ª©ng Kh·ª≠ (+H<sub>2</sub>)
              </h4>
              <ul class="list-disc list-inside text-sm mb-4">
                <li>Aldehyde + H<sub>2</sub> (Ni, t¬∞) ‚Üí Alcohol b·∫≠c 1</li>
                <li>Ketone + H<sub>2</sub> (Ni, t¬∞) ‚Üí Alcohol b·∫≠c 2</li>
              </ul>
              <!-- SIMULATION 8: Hydrogenation Animation -->
              <div
                class="bg-slate-50 dark:bg-slate-900 p-4 rounded border border-dashed border-slate-300 text-center"
              >
                <h5 class="text-xs font-bold mb-2">
                  M√¥ ph·ªèng 7: C∆° ch·∫ø c·ªông H-H
                </h5>
                <div
                  class="relative h-20 flex items-center justify-center gap-4"
                >
                  <div class="font-bold text-xl">C=O</div>
                  <div
                    id="h2-anim"
                    class="flex gap-1 transition-all duration-1000"
                  >
                    <span
                      class="w-4 h-4 bg-white border border-black rounded-full block"
                    ></span>
                    <span
                      class="w-4 h-4 bg-white border border-black rounded-full block"
                    ></span>
                  </div>
                  <button
                    onclick="animateH2()"
                    class="absolute bottom-0 right-0 text-xs bg-blue-500 text-white px-2 py-1 rounded"
                  >
                    Ch·∫°y
                  </button>
                </div>
                <div
                  id="h2-product"
                  class="text-chem-primary font-bold opacity-0 transition-opacity mt-1"
                >
                  CH-OH
                </div>
              </div>
            </div>

            <!-- c. C·ªòNG HCN -->
            <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg">
              <h4 class="text-lg font-bold text-purple-600 mb-2">
                c. C·ªông HCN (Nucleophile)
              </h4>
              <p class="text-sm mb-2">T·∫°o s·∫£n ph·∫©m Cyanohydrin.</p>
              <div
                class="bg-slate-900 text-white p-2 rounded text-xs font-mono mb-4"
              >
                R-CO-R' + HCN ‚Üí R-C(OH)(CN)-R'
              </div>

              <!-- SIMULATION 9: Mechanism Slider -->
              <div class="bg-slate-100 dark:bg-slate-900 p-3 rounded-xl">
                <h5 class="text-xs font-bold mb-2">
                  M√¥ ph·ªèng 8: Ti·∫øn tr√¨nh ph·∫£n ·ª©ng
                </h5>
                <input
                  type="range"
                  min="0"
                  max="100"
                  value="0"
                  class="w-full mb-2"
                  oninput="updateMechanism(this.value)"
                />
                <div
                  class="h-24 relative flex items-center justify-center bg-white dark:bg-slate-800 rounded border border-slate-200"
                >
                  <!-- Static C=O -->
                  <div class="font-bold text-2xl mr-8">C=O</div>
                  <!-- Moving CN- -->
                  <div
                    id="mech-cn"
                    class="font-bold text-red-500 absolute transition-all"
                    style="left: 10%; top: 60%"
                  >
                    CN‚Åª
                  </div>
                  <!-- Moving H+ -->
                  <div
                    id="mech-h"
                    class="font-bold text-blue-500 absolute transition-all"
                    style="left: 10%; top: 20%"
                  >
                    H‚Å∫
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 5. ·ª®NG D·ª§NG -->
        <div
          class="bg-gradient-to-r from-teal-500 to-emerald-600 p-6 rounded-2xl text-white shadow-lg"
        >
          <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="package" class="w-6 h-6"></i> 5. ·ª®ng d·ª•ng & ƒêi·ªÅu ch·∫ø
          </h3>
          <!-- SIMULATION 10: Interactive Cards -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div
              class="bg-white/10 backdrop-blur p-4 rounded-xl hover:bg-white/20 transition cursor-pointer transform hover:-translate-y-1"
            >
              <div class="font-bold text-yellow-300 mb-1">Formaldehyde</div>
              <p class="text-sm text-white/90">
                S·∫£n xu·∫•t nh·ª±a, ch·∫•t b·∫£o qu·∫£n m·∫´u v·∫≠t (Formalin), s√°t khu·∫©n.
              </p>
            </div>
            <div
              class="bg-white/10 backdrop-blur p-4 rounded-xl hover:bg-white/20 transition cursor-pointer transform hover:-translate-y-1"
            >
              <div class="font-bold text-yellow-300 mb-1">Acetaldehyde</div>
              <p class="text-sm text-white/90">
                Nguy√™n li·ªáu t·ªïng h·ª£p d∆∞·ª£c ph·∫©m, acid acetic, g∆∞∆°ng.
              </p>
            </div>
            <div
              class="bg-white/10 backdrop-blur p-4 rounded-xl hover:bg-white/20 transition cursor-pointer transform hover:-translate-y-1"
            >
              <div class="font-bold text-yellow-300 mb-1">Acetone</div>
              <p class="text-sm text-white/90">
                Dung m√¥i t·∫©y s∆°n m√≥ng tay, h√≤a tan nh·ª±a, cao su.
              </p>
            </div>
          </div>
          <div class="mt-4 pt-4 border-t border-white/30 text-sm">
            <strong>ƒêi·ªÅu ch·∫ø:</strong> Oxi h√≥a alcohol b·∫≠c 1 (‚Üí Aldehyde), b·∫≠c 2
            (‚Üí Ketone).
          </div>
        </div>
      </section>

      <!-- PH·∫¶N II: CARBOXYLIC ACID -->
      <section id="phan2" class="space-y-8 pt-10">
        <div class="flex items-center gap-4 border-b-2 border-chem-accent pb-2">
          <div class="p-3 bg-chem-accent/10 rounded-xl text-chem-accent">
            <i data-lucide="droplet" class="w-8 h-8"></i>
          </div>
          <h2 class="text-3xl font-bold text-slate-800 dark:text-white">
            II. Carboxylic Acid (Axit Cacboxylic)
          </h2>
        </div>

        <div class="grid md:grid-cols-2 gap-8">
          <!-- Concept & Nomenclature -->
          <div class="space-y-6">
            <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg">
              <h3 class="text-xl font-bold text-chem-accent mb-2">
                1. C·∫•u tr√∫c & Danh ph√°p
              </h3>
              <p class="text-slate-600 dark:text-slate-300 mb-2">
                Ch·ª©a nh√≥m <strong>‚ÄìCOOH</strong>. T√™n: M·∫°ch ch√≠nh +
                <strong>oic acid</strong>.
              </p>
              <ul class="text-sm space-y-2 mb-4">
                <li>
                  <strong>HCOOH:</strong> Methanoic acid (Formic - ki·∫øn ƒë·ªè).
                </li>
                <li>
                  <strong>CH<sub>3</sub>COOH:</strong> Ethanoic acid (Acetic -
                  gi·∫•m).
                </li>
                <li>
                  <strong>C<sub>6</sub>H<sub>5</sub>COOH:</strong> Benzoic acid.
                </li>
              </ul>
              <!-- SIMULATION 11: 3D Acid -->
              <div class="bg-slate-900 rounded-xl p-2 relative">
                <div
                  class="absolute top-2 left-2 text-white text-xs bg-black/50 px-2 rounded z-10"
                >
                  M√¥ ph·ªèng 9: Acid Acetic (CH‚ÇÉCOOH)
                </div>
                <div id="sim-acetic" class="molecule-canvas h-48"></div>
              </div>
            </div>

            <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg">
              <h3 class="text-xl font-bold text-chem-accent mb-2">
                2. T√≠nh ch·∫•t v·∫≠t l√Ω
              </h3>
              <p class="text-sm mb-3">
                Nhi·ªát ƒë·ªô s√¥i cao (do t·∫°o li√™n k·∫øt Hydrogen li√™n ph√¢n t·ª≠ d·∫°ng
                dimer).
              </p>
              <!-- SIMULATION 12: Dimer Animation -->
              <div
                class="bg-slate-50 dark:bg-slate-900 p-4 rounded border border-slate-200"
              >
                <h5 class="text-xs font-bold mb-2">
                  M√¥ ph·ªèng 10: Li√™n k·∫øt Hydrogen (Dimer)
                </h5>
                <div
                  class="flex justify-center items-center gap-1 animate-pulse"
                >
                  <div class="bg-red-200 p-2 rounded text-xs">
                    R-C=O...H-O-C-R
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Chemical Properties -->
          <div
            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg h-full"
          >
            <h3 class="text-xl font-bold text-chem-accent mb-4">
              3. T√≠nh ch·∫•t h√≥a h·ªçc
            </h3>

            <!-- SIMULATION 13: pH Test -->
            <div class="mb-6">
              <h4
                class="font-bold text-sm mb-2 text-slate-700 dark:text-slate-300"
              >
                a. T√≠nh Axit (M√¥ ph·ªèng 11: Qu·ª≥ t√≠m)
              </h4>
              <div class="flex gap-4 items-center">
                <div
                  class="w-12 h-16 bg-transparent border-2 border-slate-400 border-t-0 rounded-b-lg flex items-end justify-center overflow-hidden"
                >
                  <div class="w-full h-10 bg-white/50"></div>
                </div>
                <div class="flex flex-col gap-2">
                  <button
                    onclick="testLitmus('acid')"
                    class="px-3 py-1 bg-slate-200 text-xs font-bold rounded hover:bg-slate-300"
                  >
                    Nh√∫ng v√†o Acid
                  </button>
                  <button
                    onclick="testLitmus('water')"
                    class="px-3 py-1 bg-slate-200 text-xs font-bold rounded hover:bg-slate-300"
                  >
                    Nh√∫ng v√†o N∆∞·ªõc
                  </button>
                </div>
                <div
                  id="litmus-paper"
                  class="w-4 h-20 bg-purple-300 transition-colors duration-500 shadow-md"
                ></div>
              </div>
            </div>

            <!-- SIMULATION 14: Reaction with Metal -->
            <div class="mb-6">
              <h4
                class="font-bold text-sm mb-2 text-slate-700 dark:text-slate-300"
              >
                b. T√°c d·ª•ng v·ªõi Kim lo·∫°i (M√¥ ph·ªèng 12)
              </h4>
              <div
                class="bg-slate-100 dark:bg-slate-900 p-3 rounded-lg relative overflow-hidden h-32 flex justify-center items-end border border-slate-300"
              >
                <div
                  class="w-16 h-24 bg-blue-50/50 border border-slate-400 relative"
                >
                  <div
                    id="bubbles-na"
                    class="absolute bottom-0 w-full h-full pointer-events-none"
                  ></div>
                  <div
                    id="metal-na"
                    class="w-4 h-4 bg-gray-400 absolute bottom-1 left-1/2 transform -translate-x-1/2 transition-all"
                  ></div>
                </div>
                <button
                  onclick="reactMetal()"
                  class="absolute top-2 right-2 bg-yellow-500 text-white text-xs px-2 py-1 rounded shadow hover:bg-yellow-600"
                >
                  + Na
                </button>
              </div>
              <p class="text-xs mt-1 font-mono">2RCOOH + 2Na ‚Üí 2RCOONa + H‚ÇÇ‚Üë</p>
            </div>

            <!-- SIMULATION 15: Reaction with Carbonate -->
            <div class="mb-6">
              <h4
                class="font-bold text-sm mb-2 text-slate-700 dark:text-slate-300"
              >
                c. T√°c d·ª•ng v·ªõi Mu·ªëi Carbonate (M√¥ ph·ªèng 13)
              </h4>
              <button
                onclick="reactCarbonate()"
                class="w-full bg-slate-100 hover:bg-slate-200 dark:bg-slate-700 p-2 rounded text-sm transition"
              >
                Th√™m CaCO<sub>3</sub> v√†o Gi·∫•m (CH<sub>3</sub>COOH)
                <span
                  id="fizz-text"
                  class="block text-xs text-chem-accent h-4"
                ></span>
              </button>
            </div>

            <!-- SIMULATION 16: Esterification Lab -->
            <div
              class="bg-red-50 dark:bg-red-900/20 p-4 rounded-xl border border-red-200"
            >
              <h4 class="font-bold text-red-600 mb-2">
                d. Ph·∫£n ·ª©ng Este h√≥a (Quan tr·ªçng)
              </h4>
              <p class="text-xs mb-2">
                RCOOH + R'OH ‚áå RCOOR' + H<sub>2</sub>O (H<sub>2</sub>SO<sub
                  >4</sub
                >
                ƒë·∫∑c)
              </p>
              <div
                class="relative h-40 bg-white dark:bg-slate-900 rounded-lg shadow-inner flex justify-center items-end pb-2 overflow-hidden"
              >
                <div
                  class="absolute top-2 left-2 text-[10px] font-bold text-slate-400"
                >
                  M√¥ ph·ªèng 14: ƒêi·ªÅu ch·∫ø Este
                </div>
                <!-- Flask -->
                <div
                  class="w-24 h-24 rounded-full border-2 border-slate-400 bg-transparent relative overflow-hidden"
                >
                  <div
                    id="ester-mix"
                    class="absolute bottom-0 w-full h-1/2 bg-yellow-100 transition-colors duration-1000"
                  ></div>
                  <div
                    id="ester-layer"
                    class="absolute top-[50%] w-full h-0 bg-transparent transition-all duration-1000 opacity-80"
                  ></div>
                  <div
                    id="ester-vapors"
                    class="absolute w-full h-full pointer-events-none"
                  ></div>
                </div>
                <!-- Burner -->
                <div
                  id="burner-flame"
                  class="absolute bottom-0 w-8 h-8 bg-orange-500 rounded-full blur-md opacity-0 transition-opacity"
                ></div>
              </div>
              <button
                onclick="startEsterification()"
                class="w-full mt-2 bg-red-500 hover:bg-red-600 text-white text-sm font-bold py-2 rounded shadow transition"
              >
                üî• ƒêun n√≥ng h·ªón h·ª£p
              </button>
              <div
                id="ester-result"
                class="text-center text-xs mt-1 h-4 font-bold text-slate-600"
              ></div>
            </div>
          </div>
        </div>

        <!-- More Simulations Section -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8">
          <!-- Sim 17 -->
          <div
            class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow text-center cursor-pointer hover:scale-105 transition"
            onclick="simpleAlert('Gi·∫•m ƒÉn (4-5% Acetic acid) ƒë∆∞·ª£c l√†m t·ª´ l√™n men r∆∞·ª£u etylic.')"
          >
            <i
              data-lucide="wine"
              class="w-8 h-8 mx-auto text-purple-500 mb-2"
            ></i>
            <h5 class="text-xs font-bold">M√¥ ph·ªèng 15: L√™n men gi·∫•m</h5>
          </div>
          <!-- Sim 18 -->
          <div
            class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow text-center cursor-pointer hover:scale-105 transition"
            onclick="simpleAlert('Axit Benzoic d√πng l√†m ch·∫•t b·∫£o qu·∫£n th·ª±c ph·∫©m (ch·ªëng n·∫•m m·ªëc).')"
          >
            <i
              data-lucide="shield-check"
              class="w-8 h-8 mx-auto text-green-500 mb-2"
            ></i>
            <h5 class="text-xs font-bold">M√¥ ph·ªèng 16: B·∫£o qu·∫£n</h5>
          </div>
          <!-- Sim 19 -->
          <div
            class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow text-center cursor-pointer hover:scale-105 transition"
            onclick="toggleElement('quiz-modal')"
          >
            <i
              data-lucide="help-circle"
              class="w-8 h-8 mx-auto text-yellow-500 mb-2"
            ></i>
            <h5 class="text-xs font-bold">M√¥ ph·ªèng 17: Quiz nhanh</h5>
          </div>
          <!-- Sim 20 -->
          <div
            class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow text-center cursor-pointer hover:scale-105 transition"
            onclick="simpleAlert('Oxi h√≥a Ankan trong c√¥ng nghi·ªáp: 2C4H10 + 5O2 ‚Üí 4CH3COOH + 2H2O')"
          >
            <i
              data-lucide="factory"
              class="w-8 h-8 mx-auto text-slate-500 mb-2"
            ></i>
            <h5 class="text-xs font-bold">M√¥ ph·ªèng 18: C√¥ng nghi·ªáp</h5>
          </div>
        </div>
      </section>

      <!-- LUY·ªÜN T·∫¨P / QUIZ MODAL (Hidden by default) -->
      <div
        id="quiz-modal"
        class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4"
      >
        <div
          class="bg-white dark:bg-slate-800 p-8 rounded-2xl max-w-lg w-full relative"
        >
          <button
            onclick="toggleElement('quiz-modal')"
            class="absolute top-4 right-4 text-slate-500 hover:text-red-500"
          >
            <i data-lucide="x"></i>
          </button>
          <h3 class="text-2xl font-bold mb-6 text-chem-primary">
            Tr·∫Øc nghi·ªám nhanh
          </h3>

          <div class="space-y-4" id="quiz-content">
            <div class="quiz-q">
              <p class="font-bold mb-2">1. Ch·∫•t n√†o ph·∫£n ·ª©ng tr√°ng b·∫°c?</p>
              <div class="grid grid-cols-2 gap-2">
                <button
                  onclick="checkQuiz(this, false)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  Acetone
                </button>
                <button
                  onclick="checkQuiz(this, true)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  Acetaldehyde
                </button>
                <button
                  onclick="checkQuiz(this, false)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  Acid Acetic
                </button>
                <button
                  onclick="checkQuiz(this, false)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  Ethanol
                </button>
              </div>
            </div>
            <div class="quiz-q pt-4 border-t">
              <p class="font-bold mb-2">2. Gi·∫•m ƒÉn l√† dung d·ªãch c·ªßa?</p>
              <div class="grid grid-cols-2 gap-2">
                <button
                  onclick="checkQuiz(this, false)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  HCOOH
                </button>
                <button
                  onclick="checkQuiz(this, true)"
                  class="p-2 border rounded hover:bg-slate-100"
                >
                  CH3COOH
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- SIMULATION 19 & 20: Extra Visuals hidden in text interaction -->
    </main>

    <!-- SCRIPTS -->
    <script>
      // --- 1. THEME & UI LOGIC ---
      const themeToggle = document.getElementById("theme-toggle");
      const html = document.documentElement;

      // Check local storage or system preference
      if (
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        html.classList.add("dark");
      } else {
        html.classList.remove("dark");
      }

      themeToggle.addEventListener("click", () => {
        html.classList.toggle("dark");
        localStorage.theme = html.classList.contains("dark") ? "dark" : "light";
      });

      // Icons
      lucide.createIcons();

      // Scroll Progress
      window.onscroll = function () {
        let winScroll =
          document.body.scrollTop || document.documentElement.scrollTop;
        let height =
          document.documentElement.scrollHeight -
          document.documentElement.clientHeight;
        let scrolled = (winScroll / height) * 100;
        document.getElementById("scroll-progress").style.width = scrolled + "%";
      };

      function toggleElement(id) {
        const el = document.getElementById(id);
        el.classList.toggle("hidden");
      }

      function simpleAlert(msg) {
        alert(msg);
      }

      // --- 2. THREE.JS MOLECULE VIEWER ---
      function initMolecule(containerId, atomData) {
        const container = document.getElementById(containerId);
        if (!container) return;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x00000000); // Transparent

        const camera = new THREE.PerspectiveCamera(
          75,
          container.clientWidth / container.clientHeight,
          0.1,
          1000
        );
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({
          alpha: true,
          antialias: true,
        });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        // Lights
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);

        // Group to hold molecule
        const moleculeGroup = new THREE.Group();

        // Atoms (Spheres)
        const sphereGeo = new THREE.SphereGeometry(1, 32, 32);

        // Materials
        const matC = new THREE.MeshPhongMaterial({ color: 0x333333 }); // Carbon - Grey
        const matO = new THREE.MeshPhongMaterial({ color: 0xff0000 }); // Oxygen - Red
        const matH = new THREE.MeshPhongMaterial({ color: 0xffffff }); // Hydrogen - White

        atomData.atoms.forEach((atom) => {
          let mat = matC;
          let scale = 0.8;
          if (atom.elem === "O") {
            mat = matO;
            scale = 0.75;
          }
          if (atom.elem === "H") {
            mat = matH;
            scale = 0.4;
          }

          const mesh = new THREE.Mesh(sphereGeo, mat);
          mesh.position.set(atom.x, atom.y, atom.z);
          mesh.scale.set(scale, scale, scale);
          moleculeGroup.add(mesh);
        });

        // Bonds (Cylinders) - Simplified visual logic for demo
        const cylinderGeo = new THREE.CylinderGeometry(0.1, 0.1, 1, 32);
        const matBond = new THREE.MeshPhongMaterial({ color: 0xaaaaaa });

        atomData.bonds.forEach((bond) => {
          const start = new THREE.Vector3(
            atomData.atoms[bond.from].x,
            atomData.atoms[bond.from].y,
            atomData.atoms[bond.from].z
          );
          const end = new THREE.Vector3(
            atomData.atoms[bond.to].x,
            atomData.atoms[bond.to].y,
            atomData.atoms[bond.to].z
          );

          const distance = start.distanceTo(end);
          const cylinder = new THREE.Mesh(cylinderGeo, matBond);
          cylinder.position.copy(start);
          cylinder.position.lerp(end, 0.5);
          cylinder.scale.set(1, distance, 1);
          cylinder.lookAt(end);
          cylinder.rotateX(Math.PI / 2);
          moleculeGroup.add(cylinder);

          // Double bond visual (add a second stick if specified)
          if (bond.type === 2) {
            const offset = 0.15;
            const cylinder2 = cylinder.clone();
            cylinder2.position.x += offset; // Simplified offset logic
            moleculeGroup.add(cylinder2);
          }
        });

        scene.add(moleculeGroup);

        // Animation Loop
        function animate() {
          requestAnimationFrame(animate);
          moleculeGroup.rotation.y += 0.005;
          moleculeGroup.rotation.x += 0.002;
          renderer.render(scene, camera);
        }
        animate();

        // Simple resize handler
        window.addEventListener("resize", () => {
          renderer.setSize(container.clientWidth, container.clientHeight);
          camera.aspect = container.clientWidth / container.clientHeight;
          camera.updateProjectionMatrix();
        });
      }

      // --- MOLECULE DATA ---
      // 1. Formaldehyde (HCHO): Planar triangle
      const dataFormaldehyde = {
        atoms: [
          { elem: "C", x: 0, y: 0, z: 0 },
          { elem: "O", x: 0, y: 1.2, z: 0 },
          { elem: "H", x: -0.9, y: -0.6, z: 0 },
          { elem: "H", x: 0.9, y: -0.6, z: 0 },
        ],
        bonds: [
          { from: 0, to: 1, type: 2 }, // C=O
          { from: 0, to: 2, type: 1 }, // C-H
          { from: 0, to: 3, type: 1 }, // C-H
        ],
      };

      // 2. Acetone (CH3COCH3)
      const dataAcetone = {
        atoms: [
          { elem: "C", x: 0, y: 0, z: 0 }, // Carbonyl C
          { elem: "O", x: 0, y: 1.2, z: 0 },
          { elem: "C", x: -1.3, y: -0.7, z: 0.5 }, // Methyl C
          { elem: "C", x: 1.3, y: -0.7, z: -0.5 }, // Methyl C
          // Hydrogens simplified placement
          { elem: "H", x: -1.3, y: -0.7, z: 1.5 },
          { elem: "H", x: 1.3, y: -0.7, z: -1.5 },
        ],
        bonds: [
          { from: 0, to: 1, type: 2 },
          { from: 0, to: 2, type: 1 },
          { from: 0, to: 3, type: 1 },
          { from: 2, to: 4, type: 1 },
          { from: 3, to: 5, type: 1 },
        ],
      };

      // 3. Acetic Acid (CH3COOH)
      const dataAcetic = {
        atoms: [
          { elem: "C", x: -0.7, y: 0, z: 0 }, // Methyl C
          { elem: "C", x: 0.7, y: 0, z: 0 }, // Carboxyl C
          { elem: "O", x: 1.4, y: 1.0, z: 0 }, // C=O
          { elem: "O", x: 1.3, y: -1.1, z: 0 }, // C-OH
          { elem: "H", x: 2.2, y: -0.8, z: 0 }, // OH Hydrogen
          { elem: "H", x: -1.2, y: 0.9, z: 0 },
          { elem: "H", x: -1.2, y: -0.9, z: 0 },
          { elem: "H", x: -1.2, y: 0, z: 1.0 },
        ],
        bonds: [
          { from: 0, to: 1, type: 1 },
          { from: 1, to: 2, type: 2 },
          { from: 1, to: 3, type: 1 },
          { from: 3, to: 4, type: 1 },
          { from: 0, to: 5, type: 1 },
          { from: 0, to: 6, type: 1 },
          { from: 0, to: 7, type: 1 },
        ],
      };

      // Init molecules when page loads
      window.onload = function () {
        initMolecule("sim-formaldehyde", dataFormaldehyde);
        initMolecule("sim-acetone", dataAcetone);
        initMolecule("sim-acetic", dataAcetic);
      };

      // --- 3. 2D SIMULATION LOGIC ---

      // Sim 1: Polarity
      function togglePolarity() {
        const cloud = document.getElementById("electron-cloud");
        const cCharge = document.getElementById("c-charge");
        const oCharge = document.getElementById("o-charge");

        if (cloud.style.opacity == 1) {
          cloud.style.opacity = 0;
          cCharge.style.opacity = 0;
          oCharge.style.opacity = 0;
        } else {
          cloud.style.opacity = 1;
          cCharge.style.opacity = 1;
          oCharge.style.opacity = 1;
        }
      }

      // Sim 5: Naming Game
      function checkName(btn, isCorrect) {
        const parent = btn.parentElement;
        if (isCorrect) {
          btn.classList.remove("bg-slate-200", "dark:bg-slate-700");
          btn.classList.add("bg-green-500", "text-white");
          btn.innerText = "Ch√≠nh x√°c! üéâ";
        } else {
          btn.classList.remove("bg-slate-200", "dark:bg-slate-700");
          btn.classList.add("bg-red-500", "text-white");
          setTimeout(() => {
            btn.classList.add("bg-slate-200", "dark:bg-slate-700");
            btn.classList.remove("bg-red-500", "text-white");
          }, 1000);
        }
      }

      // Sim 7: Tollens Lab
      function addTollensReagent(type) {
        const status = document.getElementById("tollens-status");
        const liquid =
          document.getElementById("tollens-liquid").firstElementChild;
        const coating = document.getElementById("silver-coating");
        const mirror = document.getElementById("silver-mirror");

        if (type === "ag") {
          liquid.classList.remove("bg-blue-100/30");
          liquid.classList.add("bg-gray-100/50"); // Colorless solution
          status.innerText = "ƒê√£ th√™m ph·ª©c b·∫°c (AgNO3/NH3)";
        } else if (type === "ald") {
          status.innerText = "ƒê√£ th√™m Aldehyde. H√£y ƒëun n√≥ng!";
        } else if (type === "heat") {
          if (status.innerText.includes("Aldehyde")) {
            status.innerText = "ƒêang ph·∫£n ·ª©ng...";
            liquid.classList.add("bg-black/80"); // Darkening
            setTimeout(() => {
              coating.style.opacity = 0.5;
              mirror.style.opacity = 1;
              status.innerText =
                "Th√†nh c√¥ng! L·ªõp b·∫°c s√°ng nh∆∞ g∆∞∆°ng b√°m v√†o th√†nh ·ªëng.";
            }, 1500);
          } else {
            status.innerText = "Ch∆∞a ƒë·ªß h√≥a ch·∫•t!";
          }
        }
      }

      function resetTollens() {
        document.getElementById("silver-mirror").style.opacity = 0;
        document.getElementById("silver-coating").style.opacity = 0;
        const liquid =
          document.getElementById("tollens-liquid").firstElementChild;
        liquid.className = "w-full h-full bg-blue-100/30";
        document.getElementById("tollens-status").innerText = "·ªêng nghi·ªám s·∫°ch";
      }

      // Sim 8: H2 Animation
      function animateH2() {
        const anim = document.getElementById("h2-anim");
        const product = document.getElementById("h2-product");

        anim.style.transform = "translateX(-60px)";
        anim.style.opacity = 0;

        setTimeout(() => {
          product.style.opacity = 1;
        }, 500);

        setTimeout(() => {
          anim.style.transform = "translateX(0)";
          anim.style.opacity = 1;
          product.style.opacity = 0;
        }, 3000);
      }

      // Sim 9: Mechanism Slider
      function updateMechanism(val) {
        const cn = document.getElementById("mech-cn");
        const h = document.getElementById("mech-h");

        // Move CN towards C
        const startX_CN = 10;
        const endX_CN = 45;
        const currentX_CN = startX_CN + (val / 100) * (endX_CN - startX_CN);

        // Move H towards O (happens later)
        const startX_H = 10;
        const endX_H = 55;
        let currentX_H = 10;

        if (val > 50) {
          currentX_H = startX_H + ((val - 50) / 50) * (endX_H - startX_H);
        }

        cn.style.left = currentX_CN + "%";
        h.style.left = currentX_H + "%";

        if (val == 100) {
          cn.style.transform = "scale(0.8)";
          h.style.transform = "scale(0.8)";
        } else {
          cn.style.transform = "scale(1)";
          h.style.transform = "scale(1)";
        }
      }

      // Sim 13: Litmus Test
      function testLitmus(type) {
        const paper = document.getElementById("litmus-paper");
        // Reset position
        paper.style.transform = "translateY(0)";
        paper.style.backgroundColor = "#d8b4fe"; // Default purple

        setTimeout(() => {
          // Dip down
          paper.style.transform = "translateY(40px)";
          setTimeout(() => {
            if (type === "acid") {
              paper.style.backgroundColor = "#ef4444"; // Red
            } else {
              paper.style.backgroundColor = "#d8b4fe"; // No change
            }
            // Pull up
            setTimeout(() => {
              paper.style.transform = "translateY(0)";
            }, 500);
          }, 500);
        }, 100);
      }

      // Sim 14: Metal Reaction
      function reactMetal() {
        const metal = document.getElementById("metal-na");
        const container = document.getElementById("bubbles-na");

        // Drop metal
        metal.style.bottom = "5px";

        // Create bubbles
        const interval = setInterval(() => {
          const b = document.createElement("div");
          b.className =
            "absolute bg-white/80 rounded-full w-2 h-2 animate-bubble";
          b.style.left = Math.random() * 20 + 40 + "%"; // Center around metal
          b.style.bottom = "10px";
          container.appendChild(b);

          // Remove bubble after animation
          setTimeout(() => b.remove(), 2000);
        }, 200);

        // Metal dissolves
        setTimeout(() => {
          metal.style.transform = "translate(-50%) scale(0)";
        }, 1000);

        setTimeout(() => {
          clearInterval(interval);
          metal.style.transform = "translate(-50%) scale(1)"; // Reset visual but keep hidden logic conceptually
        }, 3000);
      }

      // Sim 15: Carbonate Reaction
      function reactCarbonate() {
        const text = document.getElementById("fizz-text");
        text.innerText = "S·ªßi b·ªçt kh√≠ CO‚ÇÇ m·∫°nh!";
        text.parentElement.classList.add("animate-fizz");
        setTimeout(() => {
          text.parentElement.classList.remove("animate-fizz");
          text.innerText = "";
        }, 2000);
      }

      // Sim 16: Esterification
      function startEsterification() {
        const flame = document.getElementById("burner-flame");
        const mix = document.getElementById("ester-mix");
        const layer = document.getElementById("ester-layer");
        const result = document.getElementById("ester-result");
        const vapor = document.getElementById("ester-vapors");

        flame.style.opacity = 1;
        result.innerText = "ƒêang ƒëun h·ªìi l∆∞u...";
        mix.classList.add("animate-pulse");

        // Simulate vapors
        vapor.innerHTML =
          '<div class="absolute w-full h-full bg-white/20 animate-pulse blur-xl"></div>';

        setTimeout(() => {
          flame.style.opacity = 0;
          mix.classList.remove("animate-pulse");
          vapor.innerHTML = "";

          // Layer separation
          layer.style.height = "20%";
          layer.style.backgroundColor = "#fce7f3"; // Pinkish ester
          layer.style.borderBottom = "1px solid rgba(0,0,0,0.1)";

          result.innerHTML =
            "Th√†nh c√¥ng! L·ªõp Este nh·∫π n·ªïi l√™n tr√™n.<br><span class='text-pink-500'>M√πi th∆°m ƒë·∫∑c tr∆∞ng bay l√™n ‚ú®</span>";
        }, 3000);
      }

      // Quiz Logic
      function checkQuiz(btn, isCorrect) {
        const parent = btn.parentElement;
        const buttons = parent.getElementsByTagName("button");
        for (let b of buttons) {
          b.disabled = true;
          if (b === btn) {
            if (isCorrect) {
              b.classList.add("bg-green-500", "text-white", "border-green-500");
            } else {
              b.classList.add("bg-red-500", "text-white", "border-red-500");
            }
          }
        }
      }
    </script>
  </body>
</html>
